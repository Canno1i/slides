<h1>Neural networks</h1>
<h2>Neural networks</h2>
<p>Machine learning strategy that vaguely resembles how neurons in brains interact</p>
<h2>Neural networks</h2>
<figure style="width: 50vw; margin: 0 auto;">
  <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xml:space="preserve" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd" viewBox="0 0 1024 640" version="1.1" id="svg53" sodipodi:docname="Neural_network.svg" inkscape:version="0.92.4 (5da689c313, 2019-01-14)">
  <metadata id="metadata57">
    <rdf:rdf>
      <cc:work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type>
      </cc:work>
    </rdf:rdf>
  </metadata>
  <sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1017" id="namedview55" showgrid="false" inkscape:zoom="0.7375" inkscape:cx="417.49505" inkscape:cy="95.972412" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="svg53"></sodipodi:namedview>
  <defs id="defs4">
    <style type="text/css" id="style2">
      
    .str3 {stroke:#000000;stroke-width:3}
    .str0 {stroke:#000000;stroke-width:5}
    .str2 {stroke:#000000;stroke-width:13}
    .str1 {stroke:#000000;stroke-width:16}
    .fil3 {fill:none}
    .fil0 {fill:#CCECFF}
    .fil2 {fill:#CCFFCC}
    .fil1 {fill:#FFFF99}
   
    </style>
  </defs>
  <circle style="fill:#ccecff;stroke:#000000;stroke-width:5" id="circle6" r="34" cy="37" cx="512" class="fil0 str0"></circle>
  <circle style="fill:#ccecff;stroke:#000000;stroke-width:5" id="circle8" r="34" cy="178.5" cx="512" class="fil0 str0"></circle>
  <circle style="fill:#ccecff;stroke:#000000;stroke-width:5" id="circle10" r="34" cy="320" cx="512" class="fil0 str0"></circle>
  <circle style="fill:#ccecff;stroke:#000000;stroke-width:5" id="circle12" r="34" cy="461.5" cx="512" class="fil0 str0"></circle>
  <circle style="fill:#ccecff;stroke:#000000;stroke-width:5" id="circle14" r="34" cy="603" cx="512" class="fil0 str0"></circle>
  <circle style="fill:#ffff99;stroke:#000000;stroke-width:5" id="circle16" r="34" cy="320" cx="840" class="fil1 str0"></circle>
  <path style="fill:none;stroke:#000000;stroke-width:16" inkscape:connector-curvature="0" id="path22" d="M 0,229 H 106" class="fil3 str1"></path>
  <path style="fill:none;stroke:#000000;stroke-width:13" inkscape:connector-curvature="0" id="path24" d="M 81,257 109,229 81,201" class="fil3 str2"></path>
  <path style="fill:none;stroke:#000000;stroke-width:16" inkscape:connector-curvature="0" id="path26" d="M 0,412 H 106" class="fil3 str1"></path>
  <path style="fill:none;stroke:#000000;stroke-width:13" inkscape:connector-curvature="0" id="path28" d="M 81,440 109,412 81,384" class="fil3 str2"></path>
  <path style="fill:none;stroke:#000000;stroke-width:16" inkscape:connector-curvature="0" id="path30" d="m 906,320 h 105" class="fil3 str1"></path>
  <path style="fill:none;stroke:#000000;stroke-width:13" inkscape:connector-curvature="0" id="path32" d="m 986,348 29,-28 -29,-28" class="fil3 str2"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path34" d="M 479,37 217,229 479,179" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path36" d="M 479,320 217,229 479,461" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path38" d="M 479,603 217,229" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path40" d="M 479,37 217,411 479,179" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path42" d="m 479,320 -262,91 262,50" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path44" d="M 479,603 217,411" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path46" d="M 546,37 807,320 546,179" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path48" d="M 546,320 H 807 L 546,461" class="fil3 str3"></path>
  <path style="fill:none;stroke:#000000;stroke-width:3" inkscape:connector-curvature="0" id="path50" d="M 546,603 807,320" class="fil3 str3"></path>
  <circle style="fill:#ccffcc;stroke:#000000;stroke-width:5" id="circle18" r="34" cy="229" cx="184" class="fil2 str0"></circle>
  <circle style="fill:#ccffcc;stroke:#000000;stroke-width:5" id="circle20" r="34" cy="411" cx="184" class="fil2 str0"></circle>
</svg>
  <figcaption>diagram of a neural network with two inputs, five intermediate neurons and one output <small>(source: <a href="https://commons.wikimedia.org/wiki/File:Neural_network.svg" title="via Wikimedia Commons">Dake, Mysid via Wikimedia Commons</a> / <a href="https://creativecommons.org/licenses/by/1.0">CC BY</a>)</small></figcaption>
</figure>
<h1>Example: iris classification</h1>
<p>load and prepare dataset:</p>
<pre><code class="hljs language-py"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> datasets
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer, StandardScaler

iris = datasets.load_iris()

X = StandardScaler().fit_transform(iris.data)
Y = LabelBinarizer().fit_transform(iris.target[:, np.newaxis])
</code></pre>
<p>build model:</p>
<pre><code class="hljs language-py"><span class="hljs-keyword">from</span> keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> keras.layers <span class="hljs-keyword">import</span> Dense

model = Sequential()
model.add(Dense(<span class="hljs-number">8</span>, activation=<span class="hljs-string">"relu"</span>))
model.add(Dense(<span class="hljs-number">8</span>, activation=<span class="hljs-string">"relu"</span>))
model.add(Dense(<span class="hljs-number">3</span>, activation=<span class="hljs-string">"softmax"</span>))

model.compile(
    optimizer=<span class="hljs-string">"adam"</span>,
    loss=<span class="hljs-string">"categorical_crossentropy"</span>,
    metrics=[<span class="hljs-string">"accuracy"</span>]
)

model.fit(X, Y, batch_size=<span class="hljs-number">5</span>, epochs=<span class="hljs-number">100</span>, verbose=<span class="hljs-number">0</span>)
</code></pre>
<p>verify model:</p>
<pre><code class="hljs language-py">model.evaluate(X, Y)

model.predict([[<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">0.2</span>]]) <span class="hljs-comment"># category should be 0</span>
</code></pre>