<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>JavaScript</title>
  <style>/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0;
}


/* Base color: saturation 0; */

.hljs,
.hljs-subst {
  color: #444;
}

.hljs-comment {
  color: #888888;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold;
}


/* User color: hue: 0 */

.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060;
}


/* Language color: hue: 90; */

.hljs-literal {
  color: #78A960;
}

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300;
}


/* Meta color: hue: 200 */

.hljs-meta {
  color: #1f7199;
}

.hljs-meta-string {
  color: #4d99bf;
}


/* Misc effects */

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style>
</head>

<body>
  <div id="canvas">
    <div id="canvas-content">

      <section class="section" id="section-1"><section class="slide" id="slide-1-1">
        <h1 id="title">JavaScript</h1>

      </section><section class="slide" id="slide-1-2">
        <h2 id="präsentation-und-code">Präsentation und Code</h2>
<p>Präsentationen verfügbar unter: <a href="https://karuga.eu/courses-presentations">https://karuga.eu/courses-presentations</a></p>
<p>Code verfügbar unter: <a href="https://github.com/marko-knoebl/courses-code">https://github.com/marko-knoebl/courses-code</a></p>

      </section><section class="slide" id="slide-1-3">
        <h2 id="ihr-trainer">Ihr Trainer</h2>
<p>Marko Knöbl</p>
<ul>
<li>Frontend Web-Entwicklung<ul>
<li>JavaScript</li>
<li>React, Angular</li>
</ul>
</li>
<li>Programmierung<ul>
<li>Python, JavaScript</li>
</ul>
</li>
</ul>

      </section><section class="slide" id="slide-1-4">
        <h2 id="vorstellung-der-teilnehmer">Vorstellung der Teilnehmer</h2>
<ul>
<li>Name</li>
<li>Firma</li>
<li>Aktuelle Projekte</li>
<li>Grund der Schulung</li>
<li>Vorkenntnisse</li>
<li>Erwartungen / Wünsche</li>
</ul>

      </section><section class="slide" id="slide-1-5">
        <h2 id="organisatorisches">Organisatorisches</h2>
<ul>
<li>Kursdauer</li>
<li>Pausen</li>
<li>Mittagessen</li>
<li>Unterlagen</li>
<li>Fragen, Feedback? - Jederzeit erwünscht</li>
</ul>

      </section></section><section class="section" id="section-2"><section class="slide" id="slide-2-1">
        <h1 id="javascript-im-browser">JavaScript im Browser</h1>

      </section><section class="slide" id="slide-2-2">
        <h2 id="beispiele-in-der-browser-konsole">Beispiele in der Browser-Konsole</h2>
<pre><code class="language-js">alert();
open(<span class="hljs-string">'https://google.com'</span>, <span class="hljs-string">'_self'</span>);
prompt(<span class="hljs-string">"What's your name?"</span>);
<span class="hljs-built_in">Math</span>.random();</code></pre>

      </section><section class="slide" id="slide-2-3">
        <h2 id="document-object-model">Document Object Model</h2>
<p><strong>DOM (Document Object Model)</strong> = JavaScript-API für Interaktion mit dem HTML-Inhalt</p>

      </section><section class="slide" id="slide-2-4">
        <h2 id="dom-grundlagen">DOM Grundlagen</h2>
<ul>
<li><code>document.getElementById()</code></li>
<li><code>document.querySelector()</code></li>
<li><code>element.innerHTML =</code></li>
</ul>

      </section><section class="slide" id="slide-2-5">
        <h2 id="dom-grundlagen---beispiele">DOM Grundlagen - Beispiele</h2>
<ul>
<li>Zufallszahl</li>
<li>Aktuelles Datum</li>
</ul>

      </section><section class="slide" id="slide-2-6">
        <h2 id="dom-stile-und-attribute-href-">DOM: Stile und Attribute (href, ...)</h2>
<ul>
<li><code>element.style</code></li>
<li><code>element.className</code></li>
<li><code>element.classList</code> (<code>.add</code>, <code>.remove</code>, <code>.toggle</code>, <code>.contains</code>)</li>
</ul>

      </section><section class="slide" id="slide-2-7">
        <h2 id="dom-createelement-appendchild">DOM: createElement, appendChild</h2>
<ul>
<li><code>document.createElement()</code></li>
<li><code>element1.appendChild(element2)</code></li>
<li><code>element1.removeChild(element2)</code></li>
<li><code>element2.remove() // not IE</code></li>
</ul>

      </section><section class="slide" id="slide-2-8">
        <h2 id="dom-createelement-appendchild---beispiele">DOM: createElement, appendChild - Beispiele</h2>
<ul>
<li>Schachbrett</li>
<li>Todo-Liste (nicht interaktiv)</li>
</ul>

      </section><section class="slide" id="slide-2-9">
        <h2 id="events">Events</h2>
<ul>
<li><code>setTimeout()</code></li>
<li><code>setInterval()</code></li>
<li><code>element.addEventListener(&#39;click&#39;, ...)</code></li>
</ul>

      </section><section class="slide" id="slide-2-10">
        <h2 id="events---beispiele">Events - Beispiele</h2>
<ul>
<li>Uhr</li>
<li>Countdown</li>
<li>Spiel: click the box</li>
</ul>

      </section><section class="slide" id="slide-2-11">
        <h2 id="formulare-und-formular-events">Formulare und Formular-Events</h2>
<p>Beispiel: Todo-Liste</p>

      </section></section><section class="section" id="section-3"><section class="slide" id="slide-3-1">
        <h1 id="debuggen-im-browser">Debuggen im Browser</h1>

      </section><section class="slide" id="slide-3-2">
        <h2 id="debuggen-im-browser">Debuggen im Browser</h2>
<p><code>debugger</code> Statement</p>

      </section><section class="slide" id="slide-3-3">
        <h2 id="debuggen-im-browser">Debuggen im Browser</h2>
<p>Breakpoints:</p>
<ul>
<li>setzen von Breakpoints</li>
<li>Aktivieren / Deaktivieren von Breakpoints</li>
</ul>

      </section><section class="slide" id="slide-3-4">
        <h2 id="debugger-im-browser">Debugger im Browser</h2>
<p>Manuell weiterspringen:</p>
<ul>
<li>play / pause</li>
<li><em>step over / Schritt darüber</em>: in die nächste Zeile</li>
<li><em>step into / Schritt hinein</em>: einem Funktionsaufruf folgen</li>
<li><em>step out / Schritt heraus</em>: aktuellen Funktionsaufruf verlassen</li>
</ul>

      </section><section class="slide" id="slide-3-5">
        <h2 id="debugger-im-browser">Debugger im Browser</h2>
<p>Beobachten von Variablen</p>

      </section></section><section class="section" id="section-4"><section class="slide" id="slide-4-1">
        <h1 id="http">HTTP</h1>

      </section><section class="slide" id="slide-4-2">
        <h2 id="http">HTTP</h2>
<p>Hypertext Transfer Protocol</p>
<p>= Protokoll, auf dessen Basis Resourcen über das Netzwerk angefragt und übertragen werden können</p>

      </section><section class="slide" id="slide-4-3">
        <h2 id="http">HTTP</h2>
<p>Paar: Anfrage - Antwort</p>
<p>Anfrage: meist aus dem Browser</p>
<p>Antwort: kommt vom Server</p>
<p>HTTP Anfragen und Antworten werden wiederum über ein &quot;niedrigeres&quot; Protokoll übertragen, üblicherweise <em>TCP</em>.</p>

      </section><section class="slide" id="slide-4-4">
        <h2 id="experimentieren-mit-http">Experimentieren mit HTTP</h2>
<p>Möglichkeiten:</p>
<ul>
<li>Browser-Tools unter &quot;Netzwerkanalyse&quot;</li>
<li>VS Code Plugin <em>HTTP Client</em></li>
</ul>

      </section><section class="slide" id="slide-4-5">
        <h2 id="http-beispiel-wikipedia">HTTP: Beispiel Wikipedia</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/wiki/Main_Page</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Date</span>: Wed, 24 Apr 2019 07:50:41 GMT
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">...</span></span></span></code></pre>

      </section><section class="slide" id="slide-4-6">
        <h2 id="http-beispiel-wikipedia-suche-1">HTTP: Beispiel Wikipedia Suche (1)</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/w/index.php?search=test&amp;title=Special:Search&amp;go=Go</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">302</span> Found
<span class="hljs-attribute">Location</span>: https://en.wikipedia.org/wiki/Test
<span class="hljs-attribute">Content-Length</span>: 0</code></pre>

      </section><section class="slide" id="slide-4-7">
        <h2 id="http-beispiel-wikipedia-suche-2">HTTP: Beispiel Wikipedia Suche (2)</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/wiki/Test</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">...</span></span></span></code></pre>

      </section><section class="slide" id="slide-4-8">
        <h2 id="http-beispiel-post-request">HTTP: Beispiel POST-Request</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/submit-posting</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: example.com
<span class="hljs-attribute">Connection</span>: keep-alive
<span class="hljs-attribute">Content-Type</span>: text/plain; encoding=UTF-8
<span class="hljs-attribute">Content-Length</span>: 33

<span class="ada">This <span class="hljs-keyword">is</span> the post content (<span class="hljs-keyword">body</span>)</span></code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="clean">...</span></code></pre>

      </section><section class="slide" id="slide-4-9">
        <h2 id="http-beispiel-api">HTTP: Beispiel API</h2>
<pre><code class="language-http">GET /todos/12
Host: jsonplaceholder.typicode.com
Connection: keep-alive</code></pre>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: application/json; charset=utf-8
<span class="hljs-attribute">Etag</span>: W/"5c-cn8o...

<span class="json">{
  <span class="hljs-attr">"userId"</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-number">12</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"ipsa repellendus fugit nisi"</span>,
  <span class="hljs-attr">"completed"</span>: <span class="hljs-literal">true</span>
}</span></code></pre>

      </section><section class="slide" id="slide-4-10">
        <h2 id="wichtige-anfrage-headerfelder">wichtige Anfrage-Headerfelder</h2>
<ul>
<li><em><code>Host</code></em></li>
<li><em><code>Connection</code></em></li>
<li><code>Origin</code></li>
<li><code>Accept</code></li>
<li><code>Accept-Encoding</code></li>
<li><code>Cookie</code></li>
<li><code>Cache-Control</code></li>
<li><code>Dnt</code></li>
</ul>

      </section><section class="slide" id="slide-4-11">
        <h2 id="wichtige-http-statuscodes">Wichtige HTTP-Statuscodes</h2>
<ul>
<li><code>200 OK</code></li>
</ul>
<!-- list separator -->

<ul>
<li><code>301 Moved Permanently</code></li>
<li><code>307 Temporary Redirect</code> (Weiterleitung auf eine andere Adresse)</li>
<li><code>303 See Other</code> (Weiterleitung auf eine andere Adresse, Methode ändert sich zu <code>GET</code>)</li>
<li><code>308 Permanent Redirect</code></li>
<li><code>304 Not Modified</code> (Resource hat sich seit letzter Anfrage nicht geändert)</li>
</ul>

      </section><section class="slide" id="slide-4-12">
        <h2 id="wichtige-http-statuscodes">Wichtige HTTP-Statuscodes</h2>
<ul>
<li><code>400 Bad Request</code></li>
<li><code>401 Unauthorized</code></li>
<li><code>403 Forbidden</code></li>
<li><code>404 Not Found</code></li>
</ul>
<!-- list separator -->

<ul>
<li><code>500 Internal Server Error</code></li>
</ul>
<p>siehe auch: <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">https://en.wikipedia.org/wiki/List_of_HTTP_status_codes</a></p>

      </section><section class="slide" id="slide-4-13">
        <h2 id="wichtige-antwort-headerfelder">wichtige Antwort-Headerfelder</h2>
<ul>
<li><code>Content-Length</code></li>
<li><code>Content-Type</code></li>
<li><code>Set-Cookie</code></li>
<li><code>Location</code></li>
<li><code>Cache-Control</code></li>
</ul>

      </section><section class="slide" id="slide-4-14">
        <h2 id="content-type-headerfeld">Content-Type-Headerfeld</h2>
<p>Mögliche Werte:</p>
<ul>
<li><code>text/plain; charset=utf-8</code></li>
<li><code>text/html; charset=utf-8</code></li>
<li><code>application/json</code></li>
<li><code>application/javascript</code></li>
<li><code>application/ecmascript</code></li>
<li><code>image/jpeg</code></li>
<li><code>image/png</code></li>
<li>...</li>
</ul>

      </section><section class="slide" id="slide-4-15">
        <h2 id="set-cookie-headerfeld">Set-Cookie-Headerfeld</h2>
<p>Beispiel:</p>
<pre><code class="language-http">GET /
Host: www.google.com

Set-Cookie: 1P_JAR=2019-04-24-08; expires=...; path=/; domain=.google.com
Set-Cookie: IDCC=AN0-TYtU7...fo; expires=...; path=/; domain=.google.com</code></pre>

      </section></section><section class="section" id="section-5"><section class="slide" id="slide-5-1">
        <h1 id="http-in-javascript">HTTP in JavaScript</h1>
<p>Möglichkeiten:</p>
<ul>
<li>XMLHttpRequest</li>
<li>fetch</li>
<li>jQuery</li>
<li>axios</li>
</ul>

      </section></section><section class="section" id="section-6"><section class="slide" id="slide-6-1">
        <h1 id="promises--fetch">Promises &amp; Fetch</h1>
<!-- siehe auch: webdev/fetch -->
<!-- https://developers.google.com/web/fundamentals/primers/promises -->


      </section><section class="slide" id="slide-6-2">
        <h2 id="promises--fetch">Promises &amp; Fetch</h2>
<p><em>Promises</em>: eine Möglichkeit, um asynchronen Code in JavaScript auszuführen</p>
<p><em>Fetch</em>: moderne Möglichkeit, Netzwerkanfragen mit JavaScript zu versenden, basiert auf Promises</p>

      </section><section class="slide" id="slide-6-3">
        <h2 id="promises---grundlagen">Promises - Grundlagen</h2>
<p>Werden verwendet, um einmalige Events zu behandeln</p>
<p>Erlauben dem Browser, auf ein Event zu <em>warten</em> - zb auf eine Antwort aus dem Netzwerk oder Daten aus der Datenbank</p>
<p>Das Warten ist <em>non-blocking</em>, damit kann anderer Code währenddessen ausgeführt werden</p>

      </section><section class="slide" id="slide-6-4">
        <h2 id="promises-vs-callbacks">Promises vs Callbacks</h2>
<p>Promises sind eine Alternative zu Callbacks; Sie lösen das gleiche Problem mit einem etwas anderen Ansatz.</p>
<p>Beispiel: Funktion <code>getTodos</code>, die Todo-Daten von einem Server lädt und sie an <code>logTodos</code> übergibt</p>
<pre><code class="language-js"><span class="hljs-comment">// callback</span>
getTodos(logTodos);</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// promise</span>
getTodos().then(logTodos);</code></pre>

      </section><section class="slide" id="slide-6-5">
        <h2 id="promises-vs-callbacks">Promises vs Callbacks</h2>
<p>Ein Vorteil von Promises gegenüber Callbacks ist, dass Promises leicht verkettet werden können:</p>
<pre><code class="language-js">getTodos()
  .then(parseJSON)
  .then(transformDataFormat)
  .then(logTodos);</code></pre>

      </section><section class="slide" id="slide-6-6">
        <h2 id="promises-beispiel-fetch-einer-website">Promises Beispiel: Fetch einer Website</h2>
<pre><code class="language-js"><span class="hljs-comment">// dieser Code kann zu jeder Website in der</span>
<span class="hljs-comment">// Browser-Konsole ausgeführt werden</span>
<span class="hljs-keyword">const</span> url = <span class="hljs-string">'/'</span>;

<span class="hljs-comment">// eine Anfrage auf die Homepage einer Website starten</span>
fetch(url)
  <span class="hljs-comment">// auf die Antwort warten, dann den Textinhalt der</span>
  <span class="hljs-comment">// Antwort auslesen</span>
  .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.text())
  <span class="hljs-comment">// auf den Textinhalt warten, dann loggen</span>
  .then(<span class="hljs-built_in">console</span>.log);</code></pre>

      </section><section class="slide" id="slide-6-7">
        <h2 id="fetch-einer-website-erklärung">Fetch einer Website: Erklärung</h2>
<p>Das Abfragen einer URL und das Auslesen des Antworttexts können länger dauern.</p>
<p>Mit <code>.then()</code> warten wir jeweils auf das Resultat.</p>
<p>Die Funktion <code>.then()</code> bekommt einen Handler (in Form einer anderen Funktion) übergeben.</p>
<p>Das Resultat des ersten Handlers (<code>response =&gt; response.text()</code>) ist wiederum ein neues Promise.</p>
<p>Der zweite Handler (<code>console.log</code>) loggt das Resultat einfach.</p>

      </section><section class="slide" id="slide-6-8">
        <h2 id="beispiel-landesflagge">Beispiel: Landesflagge</h2>
<pre><code class="language-js"><span class="hljs-comment">// ohne Promises</span>
getImageName(country, name =&gt;
  fetchFlag(name, flagResponse =&gt;
    processFlag(flagResponse, appendFlag)
  )
);</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// mit Promises</span>
getImageName(country)
  .then(fetchFlag)
  .then(processFlag)
  .then(appendFlag);</code></pre>

      </section><section class="slide" id="slide-6-9">
        <h2 id="fehlerbehandlung">Fehlerbehandlung</h2>
<p>Fehler können mit <code>.catch()</code> behandelt werden</p>
<pre><code class="language-js"><span class="hljs-keyword">return</span> getImageName(country)
  .catch(getFallbackName)
  .then(fetchFlag)
  .then(processFlag)
  .then(appendFlag)
  .catch(logError);</code></pre>

      </section><section class="slide" id="slide-6-10">
        <h2 id="todo-app-fetch---grundlegend">Todo App: fetch - grundlegend</h2>
<pre><code class="language-js">fetch(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos'</span>)
  .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.json())
  .then(updatePageWithNewTodos);
  .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'error when getting todos'</span>);
  })</code></pre>

      </section><section class="slide" id="slide-6-11">
        <h2 id="nutzung-mit-async--await-moderne-browser">Nutzung mit async / await (moderne Browser)</h2>
<pre><code class="language-js"><span class="hljs-keyword">const</span> url = <span class="hljs-string">'https://jsonplaceholder.typicode.com/todos'</span>;

<span class="hljs-keyword">const</span> fetchAsync = <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> fetch(url);
  <span class="hljs-keyword">let</span> todos = <span class="hljs-keyword">await</span> response.json();
  displayTodos(todos);
};

fetchAsync();</code></pre>

      </section><section class="slide" id="slide-6-12">
        <h2 id="todo-app-fetch---fortgeschritten">Todo App: fetch - fortgeschritten</h2>
<pre><code class="language-js">fetch(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos'</span>)
  .then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> response.statusText;
    } <span class="hljs-keyword">else</span> {
      jesponse.json().then(updatePageWithNewTodos);
    }
  })
  .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'unable to parse data'</span>))
  .then(updatePageWithNewTodos);</code></pre>

      </section><section class="slide" id="slide-6-13">
        <h2 id="übung">Übung</h2>
<p>Benutzer gibt user-id an, entsprechende todos werden geladen</p>

      </section><section class="slide" id="slide-6-14">
        <h2 id="konfigurieren-des-fetch-requests">Konfigurieren des fetch Requests</h2>
<pre><code class="language-js">fetch(url, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
  <span class="hljs-attr">cache</span>: <span class="hljs-string">'no-cache'</span>,
  <span class="hljs-attr">body</span>: <span class="hljs-string">'{"text": "learn fetch"}'</span>,
  <span class="hljs-attr">headers</span>: { <span class="hljs-string">'content-type'</span>: <span class="hljs-string">'application/json'</span> },
});</code></pre>

      </section><section class="slide" id="slide-6-15">
        <h2 id="eigene-promises">Eigene Promises</h2>
<p>Promise, die nach 1 Sekunde entweder mit hello antwortet oder nicht erfolgreich ist</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> getReply = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.5</span>) {
      resolve(<span class="hljs-string">'hello'</span>);
    } <span class="hljs-keyword">else</span> {
      reject(<span class="hljs-string">'no access'</span>);
    }
  }, <span class="hljs-number">1000</span>);
});</code></pre>

      </section><section class="slide" id="slide-6-16">
        <h2 id="promiseall">Promise.all</h2>
<pre><code class="language-js"><span class="hljs-keyword">const</span> promise1 = fetch(<span class="hljs-string">'/users.json'</span>);
<span class="hljs-keyword">const</span> promise2 = fetch(<span class="hljs-string">'/articles.json'</span>);
<span class="hljs-built_in">Promise</span>.all([promise1, promise2])
  .then(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'all data has loaded'</span>);
  })
  .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`one or more requests failed: <span class="hljs-subst">${error}</span>`</span>);
  });</code></pre>
<!--
# (Promise.race)

TODO: google code lab - code-beispiele durchsehen
-->


      </section><section class="slide" id="slide-6-17">
        <h2 id="beispiele">Beispiele</h2>
<ul>
<li>Todo-API (<a href="https://jsonplaceholder.typicode.com">https://jsonplaceholder.typicode.com</a>)</li>
<li>Wetter-API (<a href="https://openweathermap.org">https://openweathermap.org</a>)</li>
</ul>

      </section><section class="slide" id="slide-6-18">
        <h2 id="übungen">Übungen</h2>
<ul>
<li><p><a href="https://developers.google.com/web/ilt/pwa/lab-fetch-api">https://developers.google.com/web/ilt/pwa/lab-fetch-api</a></p>
</li>
<li><p><a href="https://developers.google.com/web/ilt/pwa/lab-promises">https://developers.google.com/web/ilt/pwa/lab-promises</a></p>
</li>
</ul>

      </section></section><section class="section" id="section-7"><section class="slide" id="slide-7-1">
        <h1 id="javascript-fortgeschritten">JavaScript Fortgeschritten</h1>

      </section><section class="slide" id="slide-7-2">
        <h2 id="module--imports">Module &amp; Imports</h2>
<ul>
<li>Möglichkeit, Funktionalität aus anderen js-Dateien zu importieren – kein globaler Namespace mehr</li>
<li>Benötigt einen Bundler, z.B. webpack</li>
</ul>
<pre><code class="language-js"><span class="hljs-comment">// user.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
  ...
}</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> { User } <span class="hljs-keyword">from</span> <span class="hljs-string">'user.js'</span>;</code></pre>

      </section><section class="slide" id="slide-7-3">
        <h2 id="module--imports">Module &amp; Imports</h2>
<pre><code class="language-js"><span class="hljs-comment">// user.js</span>
<span class="hljs-comment">// es kann 1 default export geben</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
   ...
}</code></pre>
<pre><code class="language-js"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> User <span class="hljs-keyword">from</span> <span class="hljs-string">'user.js'</span>;</code></pre>

      </section><section class="slide" id="slide-7-4">
        <h2 id="klassen-und-vererbung">Klassen und Vererbung</h2>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Person</span> </span>{
  <span class="hljs-keyword">constructor</span>(firstName, lastName, userName) {
    <span class="hljs-comment">// ruft Person.constructor auf</span>
    <span class="hljs-keyword">super</span>(firstName, lastName);
    <span class="hljs-keyword">this</span>.userName = userName;
  }
}</code></pre>

      </section><section class="slide" id="slide-7-5">
        <h2 id="spread-syntax-arrays-und-objekte">Spread Syntax (Arrays und Objekte)</h2>
<pre><code class="language-js"><span class="hljs-keyword">let</span> squares = [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">9</span>];
<span class="hljs-keyword">let</span> moreSquares = [...squares, <span class="hljs-number">16</span>, <span class="hljs-number">25</span>];
<span class="hljs-comment">// moreSquares: [1, 4, 9, 16, 25]</span></code></pre>
<pre><code class="language-js"><span class="hljs-keyword">let</span> pers = { <span class="hljs-attr">firstName</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">lastName</span>: <span class="hljs-string">'Doe'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">31</span> };
<span class="hljs-keyword">let</span> updatedPers = { ...person, <span class="hljs-attr">email</span>: <span class="hljs-string">'j@d.com'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">32</span> };
<span class="hljs-comment">// {firstName: 'John', lastName: 'Doe',</span>
<span class="hljs-comment">// email: 'j@d.com', age: 32}</span></code></pre>

      </section></section><section class="section" id="section-8"><section class="slide" id="slide-8-1">
        <h1 id="map-filter-reduce">map, filter, reduce</h1>
<h3 id="array-methoden-für-die-funktionale-programmierung">Array-Methoden für die funktionale Programmierung</h3>

      </section><section class="slide" id="slide-8-2">
        <h2 id="map">map</h2>
<ul>
<li>Ändert jeden Eintrag eines Arrays mit Hilfe einer Funktion ab</li>
<li>Rückgabewert: neues Array</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">let</span> myNumbers = [<span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">23</span>];

<span class="hljs-keyword">let</span> triple = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-number">3</span> * n;

<span class="hljs-keyword">let</span> newNumbers = myNumbers.map(triple);
<span class="hljs-comment">// [6, 30, 69]</span></code></pre>

      </section><section class="slide" id="slide-8-3">
        <h2 id="filter">filter</h2>
<ul>
<li>Behält nur gewisse Einträge in einem Array</li>
<li>Nutzt eine Funktion, um Einträge auf ein bestimmtes Kriterium zu testen</li>
<li>Rückgabewert: neues Array</li>
</ul>
<pre><code class="language-js"><span class="hljs-keyword">let</span> myNumbers = [<span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">23</span>];

<span class="hljs-keyword">let</span> isEven = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>;

<span class="hljs-keyword">let</span> newNumbers = myNumbers.filter(isEven);
<span class="hljs-comment">// [2, 10]</span></code></pre>

      </section><section class="slide" id="slide-8-4">
        <h2 id="reduce">reduce</h2>
<ul>
<li>Verarbeitet die Einträge in einem Array zu einem einzelnen Wert</li>
<li>Verwendet eine Funktion, die aus zwei bestehenden Werten einen resultierenden Wert erstellt - diese Funktion wird wiederholt aufgerufen</li>
</ul>

      </section><section class="slide" id="slide-8-5">
        <h2 id="reduce---beispiel">reduce - Beispiel</h2>
<pre><code class="language-js"><span class="hljs-keyword">let</span> transactions = [
  { <span class="hljs-attr">amount</span>: <span class="hljs-number">-56</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'groceries'</span> },
  { <span class="hljs-attr">amount</span>: +<span class="hljs-number">1020</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'salary'</span> },
  { <span class="hljs-attr">amount</span>: <span class="hljs-number">-13</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'dinner'</span> },
  { <span class="hljs-attr">amount</span>: <span class="hljs-number">-96</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'electricity'</span> },
];
<span class="hljs-keyword">let</span> initialBalance = <span class="hljs-number">317</span>;

<span class="hljs-keyword">let</span> currentBalance = transactions.reduce(
  <span class="hljs-function">(<span class="hljs-params">aggregator, transaction</span>) =&gt;</span>
    aggregator + transaction.amount,
  initialBalance
);

<span class="hljs-comment">// 317 -&gt; 261 -&gt; 1281 -&gt; 1268 -&gt; 1172</span></code></pre>

      </section></section><section class="section" id="section-9"><section class="slide" id="slide-9-1">
        <h1 id="this---quirks">this - quirks</h1>

      </section><section class="slide" id="slide-9-2">
        <h2 id="this---quirks">this - quirks</h2>
<ul>
<li><em>this</em> bezieht sich in Objektmethoden üblicherweise auf das aktuelle Objekt</li>
<li><strong>allerdings</strong>:<ul>
<li>jeder Funktionsaufruf setzt <em>this</em> neu (nicht nur Methodenaufrufe)</li>
<li><em>this</em> wird nur richtig gesetzt, wenn die Methode mit der Syntax <code>object.method()</code> aufgerufen wird</li>
</ul>
</li>
</ul>

      </section><section class="slide" id="slide-9-3">
        <h2 id="problem-this-in-anonymen-funktionen">Problem: <em>this</em> in anonymen Funktionen</h2>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">myComponent</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// this ist hier richtig gesetzt</span>
    <span class="hljs-keyword">this</span>.foo = <span class="hljs-literal">true</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-comment">//this wird hier überschrieben (auf window)</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.foo);
    }, <span class="hljs-number">1000</span>);
  }
}</code></pre>

      </section><section class="slide" id="slide-9-4">
        <h2 id="lösung-pfeilfunktionen">Lösung: <em>Pfeilfunktionen</em></h2>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">myComponent</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// this ist hier richtig gesetzt</span>
    <span class="hljs-keyword">this</span>.foo = <span class="hljs-literal">true</span>;
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-comment">// this wird hier *nicht* überschrieben</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.foo);
    }, <span class="hljs-number">1000</span>);
  }
}</code></pre>

      </section><section class="slide" id="slide-9-5">
        <h2 id="problem-methodenaufrufe-ohne-methodensyntax">Problem: Methodenaufrufe ohne Methodensyntax</h2>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.message = <span class="hljs-string">'hello'</span>;
  }
  greet() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.message);
  }
}
<span class="hljs-keyword">let</span> foo = <span class="hljs-keyword">new</span> Foo();
foo.greet(); <span class="hljs-comment">// klappt</span>
<span class="hljs-keyword">let</span> fg = foo.greet;
fg(); <span class="hljs-comment">// klappt nicht (this ist undefined)</span></code></pre>

      </section><section class="slide" id="slide-9-6">
        <h2 id="lösung-pfeil-methoden">Lösung: Pfeil-Methoden</h2>
<p>Seit ES2018 einsetzbar:</p>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.message = <span class="hljs-string">'hello'</span>;
  }
  greet = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.message);
  };
}</code></pre>

      </section><section class="slide" id="slide-9-7">
        <h2 id="lösung-binden-von-methoden">Lösung: Binden von Methoden</h2>
<pre><code class="language-js"><span class="hljs-keyword">let</span> f = <span class="hljs-keyword">new</span> Foo();
f.greet(); <span class="hljs-comment">// klappt</span>
<span class="hljs-keyword">let</span> fg = f.greet.bind(f);
fg(); <span class="hljs-comment">// klappt jetzt auch</span></code></pre>
<p>Üblicherweise Zuweisung im constructor:</p>
<pre><code class="language-js">  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.greet = <span class="hljs-keyword">this</span>.greet.bind(<span class="hljs-keyword">this</span>);
  }</code></pre>

      </section></section><section class="section" id="section-10"><section class="slide" id="slide-10-1">
        <h1 id="objektorientierte-programmierung-alt">Objektorientierte Programmierung (alt)</h1>

      </section><section class="slide" id="slide-10-2">
        <h2 id="prototypen-und-konstruktorfunktionen">Prototypen und Konstruktorfunktionen</h2>
<p>OOP in JavaScript basiert nicht auf Klassen, sondern auf sogenannten <em>Prototypen</em></p>
<p>Vergleich aus dem echten Leben: Auto-Objekte</p>
<p>Eine Auto-Klasse wäre ein Bauplan für ein Auto</p>
<p>Ein Auto-Prototyp wäre ein bestehendes Auto auf dessen Vorlage weitere Autos gebaut werden können</p>

      </section><section class="slide" id="slide-10-3">
        <h2 id="prototypen-und-konstruktorfunktionen">Prototypen und Konstruktorfunktionen</h2>
<p>Bei OOP in JavaScript beginnen wir damit, die Konstruktorfunktion zu schreiben, die ein Objekt initialisiert:</p>
<pre><code class="language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Car</span>(<span class="hljs-params">brand, model</span>) </span>{
  <span class="hljs-keyword">this</span>.brand = brand;
  <span class="hljs-keyword">this</span>.model = model;
}</code></pre>

      </section><section class="slide" id="slide-10-4">
        <h2 id="prototypen-und-methodendefinition">Prototypen und Methodendefinition</h2>
<pre><code class="language-js">Car.prototype.accelerate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'wrooom!'</span>);
};

Car.prototype.getDescription = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.make + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.model;
};</code></pre>

      </section><section class="slide" id="slide-10-5">
        <h2 id="verwendung-von-objekten">Verwendung von Objekten</h2>
<pre><code class="language-js"><span class="hljs-keyword">var</span> myCar = <span class="hljs-keyword">new</span> Car(<span class="hljs-string">'VW'</span>, <span class="hljs-string">'Golf'</span>);

<span class="hljs-built_in">console</span>.log(myCar);
<span class="hljs-built_in">console</span>.log(myCar.getDescription());
myCar.accelerate();</code></pre>

      </section></section><section class="section" id="section-11"><section class="slide" id="slide-11-1">
        <h1 id="objektorientierte-programmierung-ab-es2015">Objektorientierte Programmierung (ab ES2015)</h1>

      </section><section class="slide" id="slide-11-2">
        <h2 id="oop-neu">OOP (neu)</h2>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> </span>{
  <span class="hljs-keyword">constructor</span>(brand, model) {
    <span class="hljs-keyword">this</span>.brand = brand;
    <span class="hljs-keyword">this</span>.model = model;
  }

  accelerate() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'wroom!'</span>);
  }
}</code></pre>

      </section><section class="slide" id="slide-11-3">
        <h2 id="oop-neu">OOP (neu)</h2>
<p>Vererbung</p>
<pre><code class="language-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LuxuryCar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Car</span> </span>{
  openRoof() {}
}</code></pre>

      </section></section><section class="section" id="section-12"><section class="slide" id="slide-12-1">
        <h1 id="libraries">Libraries</h1>

      </section><section class="slide" id="slide-12-2">
        <h2 id="libraries">Libraries</h2>
<p>verbreitete Libraries:</p>
<ul>
<li><em>lodash</em> (Sammlung nützlicher Funktionen)</li>
<li><em>jQuery</em> (Erleichtert das Arbeiten mit dem DOM)</li>
<li><em>immutable.js</em> (Arbeiten mit unveränderlichen Objekten)</li>
<li><em>moment.js</em> (Arbeiten mit Zeitangaben)</li>
</ul>

      </section><section class="slide" id="slide-12-3">
        <h2 id="jquery">jQuery</h2>
<p>Ändern von Elementen</p>
<ul>
<li><code>$(&#39;#myelement&#39;)</code></li>
<li><code>el.html(&#39;content&#39;)</code></li>
<li><code>el.css(&#39;color&#39;, &#39;blue&#39;)</code></li>
<li><code>el.addClass(&#39;abc&#39;)</code></li>
<li><code>el.prop(&#39;style&#39;)</code></li>
</ul>

      </section><section class="slide" id="slide-12-4">
        <h2 id="jquery">jQuery</h2>
<p>Erstellen / hinzufügen / entfernen von Elementen</p>
<ul>
<li><code>$(&#39;&lt;div&gt;&#39;)</code></li>
<li><code>parent.append(child)</code></li>
<li><code>child.remove()</code></li>
</ul>

      </section><section class="slide" id="slide-12-5">
        <h2 id="jquery">jQuery</h2>
<p>Abfragen von Events</p>
<ul>
<li><code>$(element).on(&#39;click&#39;, ...)</code></li>
<li><code>$(element).click(...)</code></li>
</ul>

      </section></section><section class="section" id="section-13"><section class="slide" id="slide-13-1">
        <h1 id="übungen">Übungen</h1>
<ul>
<li>Lotto - Generator</li>
<li>uhr</li>
<li>Todo-Liste</li>
<li>chessboard</li>
<li>facebook</li>
<li>es6</li>
</ul>

      </section></section>

    </div>
    <div id="navigation-arrows">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="navigation-arrows-svg"
        xml:space="preserve" width="100%" height="100%" viewBox="-110 -110 220 220">
        <path class="arrow right" d="M70,-30L100,0L70,30" />
        <path class="arrow down" d="M-30,70L0,100L30,70" />
        <path class="arrow left" d="M-70,-30L-100,0L-70,30" />
        <path class="arrow up" d="M-30,-70L0,-100L30,-70" />
      </svg>
    </div>
  </div>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      width: 100vw;
      height: 100vh;
      margin: 0px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgb(150, 150, 150);
      font-family: -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
      line-height: 1.5rem;
    }

    p, ul, pre {
      margin-top: 0;
    }

    ul {
      padding-left: 1.5rem;
    }

    h1, h2, h3 {
      margin-top: 0px;
      font-weight: 600;
    }

    h1 {
      margin-top: 5vh;
      text-align: center;
      font-size: 2rem;
    }

    h2 {
      margin-bottom: 1.5em;
    }

    svg {
      width: 100%;
      height: auto;
    }

    .section {
      height: 100%;
      display: none;
    }

    .section.active {
      display: block;
    }

    .slide {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .slide.inactive {
      display: none;
    }

    #canvas {
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.3);
      background-color: #f8f8f8;
      position: relative;
      display: flex;
    }

    #canvas-content {
      width: 100%;
      height: 100%;
    }

    #canvas-content .note {
      display: none;
    }

    #canvas-content img {
      margin: 0px auto;
      display: block;
    }

    @media (min-aspect-ratio: 8/5) {

      html {
        font-size: 3.5vh;
      }

      /* wide screen */
      #canvas {
        width: calc(100vh / 5 * 8);
        height: 100vh;
        padding: 10vh;
        padding-top: 5vh;
      }
    }

    @media (max-aspect-ratio: 8/5) {

      html {
        font-size: calc(3.5vw * 5 / 8);
      }

      /* narrow screen */
      #canvas {
        width: 100vw;
        height: calc(100vw * 5 / 8);
        padding: calc(10vh * 5 / 8);
        padding-top: calc(5vh * 5 / 8);
      }
    }

    pre {
      background-color: rgb(224, 233, 240);
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.2);
      padding: 0.5em 1em;
      line-height: 1.2em;
      overflow: auto;
    }

    #navigation-arrows {
      position: absolute;
      right: 2rem;
      top: 2rem;
      height: 3rem;
      width: 3rem;
    }

    #navigation-arrows .arrow {
      stroke: lightblue;
      /*stroke-width: 0.8em; Chrome behaves differently with ems here */
      stroke-width: 16px;
      stroke-linecap: round;
      fill: none;
      cursor: pointer;
    }

    td,
    th {
      padding: 0.2em 0.8em;
    }

    th {
      text-align: start;
    }
  </style>
  <script>
    let presenterWindow;
    let activeSlide;
    let slideCount;

    const arrowUp = document.querySelector('.arrow.up');
    const arrowDown = document.querySelector('.arrow.down');
    const arrowRight = document.querySelector('.arrow.right');
    const arrowLeft = document.querySelector('.arrow.left');
    arrowUp.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] - 1);}
    );
    arrowDown.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] + 1);}
    );
    arrowLeft.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] - 1, 1);}
    );
    arrowRight.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] + 1, 1);}
    )
    const init = () => {
      slideCount = countSlides();
      activateSlideSafe(1, 1);
      addKeyControls();
      addSwipeControls();
    }

    // count slides
    const countSlides = () => {
      const counts = [];
      return [...document.querySelectorAll('.section')].map(section => section.childNodes.length);
    }

    const updateVisible = () => {
      for (let section of document.querySelectorAll('.section')) {
        if (section.id === `section-${activeSlide[0]}`) {
          section.className = 'section active';
        } else {
          section.className = 'section inactive';
        }
      }
      for (let slide of document.querySelectorAll('.slide')) {
        if (slide.id === `slide-${activeSlide[0]}-${activeSlide[1]}`) {
          slide.className = 'slide active';
        } else {
          slide.className = 'slide inactive';
        }
      }
    }

    const updatePageArrows = () => {
      if (slideCount.length === 1) {
        arrowLeft.style.opacity = "0";
        arrowRight.style.opacity = "0";
      } else {
        const progressSections = (activeSlide[0] - 1) / (slideCount.length - 1);
        arrowLeft.style.opacity = progressSections.toString();
        arrowRight.style.opacity = (1 - progressSections).toString();
      }
      const slidesInActiveSection = slideCount[activeSlide[0] - 1]
      if (slidesInActiveSection === 1) {
        arrowUp.style.opacity = "0";
        arrowDown.style.opacity = "0";
      } else {
        const progressSlides = (activeSlide[1] - 1) / (slidesInActiveSection - 1);
        arrowUp.style.opacity = progressSlides.toString();
        arrowDown.style.opacity = (1 - progressSlides).toString();
      }
    }

    /**
     * Activate a slide if it exists, else do nothing
    */
    const activateSlideSafe = (sectionIndex, slideIndex) => {
      if (1 <= sectionIndex && sectionIndex <= slideCount.length && 1 <= slideIndex && slideIndex <= slideCount[sectionIndex - 1]) {
        activeSlide = [sectionIndex, slideIndex];
        updateVisible();
        updatePageArrows();
        scrolltoActiveSlide();
      }
    }

    const activateSlideNextSafe = () => {
      if (activeSlide[1] === slideCount[activeSlide[0] - 1]) {
        activateSlideSafe(activeSlide[0] + 1, 1);
      } else {
        activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
      }
    }

    const activateSlideRightSafe = () => {
      activateSlideSafe(activeSlide[0] + 1, 1);
    }

    const activateSlideLeftSafe = () => {
      activateSlideSafe(activeSlide[0] - 1, 1);
    }

    const activateSlideDownSafe = () => {
      activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
    }

    const activateSlideUpSafe = () => {
      activateSlideSafe(activeSlide[0], activeSlide[1] - 1);
    }

    const scrolltoActiveSlide = () => {
      const slideId = `#slide-${activeSlide[0]}-${activeSlide[1]}`;
      if (presenterWindow) {
        const activeSlide = presenterWindow.document.querySelector(slideId);
        if (activeSlide) {
          activeSlide.scrollIntoView();
        }
      }
    }

    const addKeyControls = () => {
      document.querySelector('body').addEventListener('keydown', event => {
        if (event.key === 'p') {
          const canvasContent = document.querySelector('#canvas-content').innerHTML;
          presenterWindow = window.open(document.URL, '_blank');
          presenterWindow.onload = () => {
            presenterWindow.document.querySelector('body').innerHTML = canvasContent;
          }
        }
        if (event.key === 'ArrowRight') {
          activateSlideRightSafe();
        } else if (event.key === 'ArrowLeft') {
          activateSlideLeftSafe();
        } else if (event.key === 'ArrowDown') {
          activateSlideDownSafe();
        } else if (event.key === 'ArrowUp') {
          activateSlideUpSafe();
        } else if (event.key === 'Enter') {
          activateSlideNextSafe();
        }
      });
    }

    const addSwipeControls = () => {

      const distance = 100;

      let startPos;
      let handled;

      document.addEventListener('touchstart', event => {
        startPos = event.touches[0];
        handled = false;
      });

      document.addEventListener('touchmove', event => {
        if (!handled) {
          let currentPos = event.touches[0];
          const xDiff = currentPos.clientX - startPos.clientX;
          const yDiff = currentPos.clientY - startPos.clientY;
          if (Math.abs(xDiff) > 2*Math.abs(yDiff) ||
              Math.abs(yDiff) > 2*Math.abs(xDiff)) {
            if (xDiff > distance) {
              activateSlideLeftSafe();
              handled = true;
            } else if (xDiff < -distance) {
              activateSlideRightSafe();
              handled = true;
            } else if (yDiff > distance) {
              activateSlideUpSafe();
              handled = true;
            } else if (yDiff < -distance) {
              activateSlideDownSafe();
              handled = true;
            }
          }
        }
      });
    }

    init();

  </script>
</body>

</html>