<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Python in practice</title>
  <style>/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0;
}


/* Base color: saturation 0; */

.hljs,
.hljs-subst {
  color: #444;
}

.hljs-comment {
  color: #888888;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold;
}


/* User color: hue: 0 */

.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060;
}


/* Language color: hue: 90; */

.hljs-literal {
  color: #78A960;
}

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300;
}


/* Meta color: hue: 200 */

.hljs-meta {
  color: #1f7199;
}

.hljs-meta-string {
  color: #4d99bf;
}


/* Misc effects */

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style>
</head>

<body>
  <div id="canvas">
    <div id="canvas-content">

      <section class="section" id="section-1"><section class="slide" id="slide-1-1">
        <h1 id="title">Python in practice</h1>

      </section><section class="slide" id="slide-1-2">
        <h2 id="presentation-and-code">Presentation and code</h2>
<p>Presentations available at: <a href="https://karuga.eu/courses-presentations">https://karuga.eu/courses-presentations</a></p>
<p>Code available at: <a href="https://github.com/marko-knoebl/courses-code">https://github.com/marko-knoebl/courses-code</a></p>

      </section><section class="slide" id="slide-1-3">
        <h2 id="your-trainer">Your Trainer</h2>
<p>Marko Kn√∂bl</p>
<ul>
<li>Frontend Web-Development<ul>
<li>JavaScript</li>
<li>React, Angular</li>
</ul>
</li>
<li>Programming<ul>
<li>Python, JavaScript</li>
</ul>
</li>
</ul>

      </section><section class="slide" id="slide-1-4">
        <h2 id="introduction-of-participants">Introduction of Participants</h2>
<ul>
<li>Name</li>
<li>Company</li>
<li>Current Projects</li>
<li>Prior Knowledge</li>
<li>Expectations</li>
</ul>

      </section><section class="slide" id="slide-1-5">
        <h2 id="organizational">Organizational</h2>
<ul>
<li>Duration</li>
<li>Breaks</li>
<li>Materials</li>
<li>Questions, Feedback?</li>
</ul>

      </section></section><section class="section" id="section-2"><section class="slide" id="slide-2-1">
        <h1 id="topics">Topics</h1>
<ul>
<li>working with files and folders</li>
<li>regular expressions</li>
<li>time and date</li>
<li>sys</li>
<li>HTTP client</li>
<li>web development</li>
<li>databases</li>
<li>e-mail</li>
</ul>

      </section></section><section class="section" id="section-3"><section class="slide" id="slide-3-1">
        <h1 id="working-with-files">Working with files</h1>

      </section><section class="slide" id="slide-3-2">
        <h2 id="working-with-files">Working with files</h2>
<p>file = a sequence of bytes on a storage device</p>

      </section><section class="slide" id="slide-3-3">
        <h2 id="the-function-open">The function &quot;open()&quot;</h2>
<pre><code class="language-py">file_obj = open(<span class="hljs-string">"todos.txt"</span>)
content = file_obj.read()
file_obj.close()
print(content)</code></pre>
<p>Open creates an instance of a subclass of IOBase</p>

      </section><section class="slide" id="slide-3-4">
        <h2 id="file-modes">File modes</h2>
<pre><code class="language-py"><span class="hljs-comment"># mode: text, append</span>
open(<span class="hljs-string">"todos.txt"</span>, mode=<span class="hljs-string">"ta"</span>)</code></pre>

      </section><section class="slide" id="slide-3-5">
        <h2 id="file-modes">File modes</h2>
<ul>
<li><code>t</code>: text mode (default)</li>
<li><code>b</code>: binary</li>
</ul>
<!-- list-separator -->

<ul>
<li><code>r</code>: reading (default)</li>
<li><code>w</code>: (over)writing</li>
<li><code>a</code>: appending</li>
</ul>

      </section><section class="slide" id="slide-3-6">
        <h2 id="reading-and-writing">Reading and writing</h2>
<pre><code class="language-py">t = open(<span class="hljs-string">"loremipsum.txt"</span>)
print(t.read())
t.close()</code></pre>

      </section><section class="slide" id="slide-3-7">
        <h2 id="reading-and-writing">Reading and writing</h2>
<pre><code class="language-py">t = open(<span class="hljs-string">"todos.txt"</span>, mode=<span class="hljs-string">"a"</span>, encoding=<span class="hljs-string">"utf-8"</span>)
t.write(<span class="hljs-string">"Learn Python"</span>)
t.close()</code></pre>
<pre><code class="language-py">coins = open(<span class="hljs-string">"coins.b"</span>, mode=<span class="hljs-string">"ba"</span>)
coins.write(bytes([<span class="hljs-number">0b01001110</span>, <span class="hljs-number">0b11100100</span>]))
coins.close()</code></pre>

      </section><section class="slide" id="slide-3-8">
        <h2 id="open-and-the-with-statement">Open and the with statement</h2>
<pre><code class="language-py"><span class="hljs-keyword">with</span> open(<span class="hljs-string">"todos.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> file_obj:
    content = file_obj.read()</code></pre>
<p>In this example using the with statement relieves us from explicitly closing the file object. The file will be automatically closed when the program leaves the indented block.</p>

      </section><section class="slide" id="slide-3-9">
        <h2 id="character-encoding">character encoding</h2>
<p>Text files may be encoded in various ways:</p>
<ul>
<li>ASCII</li>
<li>CP-1252 / western european / latin1</li>
<li>UTF-8</li>
</ul>
<p>Recommendation: <em>always</em> use utf-8 as the encoding for text files (best support for special characters)</p>

      </section><section class="slide" id="slide-3-10">
        <h2 id="character-encoding">character encoding</h2>
<p>The default character encoding for text files depends on the operating system:</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> locale
locale.getpreferredencoding()</code></pre>

      </section><section class="slide" id="slide-3-11">
        <h2 id="character-encoding">character encoding</h2>
<p>Explicitly stating the character encoding:</p>
<pre><code class="language-py">open(<span class="hljs-string">"file.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>)</code></pre>

      </section><section class="slide" id="slide-3-12">
        <h2 id="file-like-objects">File-like objects</h2>
<p>Objects that support using <code>.read()</code> or <code>.write()</code> etc:</p>
<ul>
<li>files (e.g. via <code>open()</code>)</li>
<li><code>sys.stdout</code>, <code>sys.stdin</code><ul>
<li>example: <code>sys.stdin.readline()</code></li>
</ul>
</li>
<li>Network replies, e.g. via <code>urllib.request.urlopen(&#39;https://google.com&#39;)</code></li>
</ul>

      </section><section class="slide" id="slide-3-13">
        <h2 id="file-like-objects">File-like objects</h2>
<pre><code class="language-py"><span class="hljs-keyword">with</span> file <span class="hljs-keyword">as</span> open(<span class="hljs-string">'myfile.txt'</span>, encoding=<span class="hljs-string">"utf-8"</span>):
    <span class="hljs-comment"># read individual lines</span>
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:
        print(line)
    <span class="hljs-comment"># read entire file</span>
    print(file.read())</code></pre>

      </section><section class="slide" id="slide-3-14">
        <h2 id="file-like-objects">File-like objects</h2>
<p>Methods:</p>
<ul>
<li><code>.close()</code></li>
<li><code>.mode</code></li>
<li><code>.read()</code> (read the entire file)</li>
<li><code>.read(10)</code> (read the next 10 bytes)</li>
<li><code>.readline()</code> (read the next line)</li>
</ul>

      </section></section><section class="section" id="section-4"><section class="slide" id="slide-4-1">
        <h1 id="working-with-various-file-formats">Working with various file formats</h1>

      </section><section class="slide" id="slide-4-2">
        <h2 id="working-with-file-formats">Working with file formats</h2>
<p>possibilities:</p>
<ul>
<li>text files</li>
<li>JSON</li>
<li>CSV</li>
<li>XML</li>
<li>Python object files (via pickle and shelve)</li>
<li>binary files</li>
</ul>

      </section><section class="slide" id="slide-4-3">
        <h2 id="csv">CSV</h2>

      </section><section class="slide" id="slide-4-4">
        <h2 id="writing-csv">Writing CSV</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> csv

data = [
    [<span class="hljs-string">'code'</span>, <span class="hljs-string">'area'</span>, <span class="hljs-string">'population'</span>],
    [<span class="hljs-string">'CN'</span>, <span class="hljs-number">9.6</span>, <span class="hljs-number">1386</span>],
    [<span class="hljs-string">'RU'</span>, <span class="hljs-number">17</span>, <span class="hljs-number">144</span>],
    [<span class="hljs-string">'US'</span>, <span class="hljs-number">9.8</span>, <span class="hljs-number">327</span>]
]

<span class="hljs-keyword">with</span> open(<span class="hljs-string">'data.csv'</span>, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'utf-8'</span>, newline=<span class="hljs-string">''</span>) <span class="hljs-keyword">as</span> f:
    writer = csv.writer(f)
    writer.writerows(data)</code></pre>

      </section><section class="slide" id="slide-4-5">
        <h2 id="reading-csv">Reading CSV</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> csv

<span class="hljs-keyword">with</span> open(<span class="hljs-string">'countries.csv'</span>, encoding=<span class="hljs-string">'utf-8'</span>, newline=<span class="hljs-string">''</span>) <span class="hljs-keyword">as</span> csv_file:
    reader = csv.reader(csv_file)
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> reader:
        print(row)</code></pre>

      </section><section class="slide" id="slide-4-6">
        <h2 id="json">JSON</h2>

      </section><section class="slide" id="slide-4-7">
        <h2 id="saving-json">Saving JSON</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> json

data = [<span class="hljs-string">"one"</span>, <span class="hljs-string">"two"</span>, <span class="hljs-string">"three"</span>]
jsonstring = json.dumps(data)

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"numbers.json"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> jsonfile:
    jsonfile.write(jsonstring)</code></pre>

      </section><section class="slide" id="slide-4-8">
        <h2 id="reading-json">Reading JSON</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> json

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"numbers.json"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> jsonfile:
    jsonstring = jsonfile.read()
data = json.loads(jsonstring)</code></pre>

      </section><section class="slide" id="slide-4-9">
        <h2 id="xml">XML</h2>
<p>two packages in the standard library:</p>
<ul>
<li><code>xml.etree.ElementTree</code></li>
<li><code>xml.dom.minidom</code></li>
</ul>
<p>external library (extension of ElementTree):</p>
<ul>
<li><code>lxml</code></li>
</ul>

      </section><section class="slide" id="slide-4-10">
        <h2 id="xml-with-elementtree-creating-a-document">XML with ElementTree: creating a document</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> et

person = et.Element(<span class="hljs-string">'person'</span>)
name = et.SubElement(person, <span class="hljs-string">'name'</span>)
name.text = <span class="hljs-string">'Adam'</span>
age = et.SubElement(person, <span class="hljs-string">'age'</span>)
age.text = <span class="hljs-string">'40'</span>
age.set(<span class="hljs-string">"unit"</span>, <span class="hljs-string">"years"</span>)</code></pre>

      </section><section class="slide" id="slide-4-11">
        <h2 id="xml-with-elementtree-saving">XML with ElementTree: saving</h2>
<p>Always specify an encoding when saving XML!</p>
<pre><code class="language-py">xmlbytestring: bytes = et.tostring(person, encoding=<span class="hljs-string">'utf-8'</span>)
<span class="hljs-keyword">with</span> open(<span class="hljs-string">"myfile.xml"</span>, mode=<span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> file:
    file.write(xmlbytestring)

<span class="hljs-comment"># or</span>
xmlstring: str = et.tostring(person, encoding=<span class="hljs-string">'unicode'</span>)
<span class="hljs-keyword">with</span> open(<span class="hljs-string">"myfile.xml"</span>, encoding=<span class="hljs-string">"utf-8"</span>, mode=<span class="hljs-string">"w"</span>) <span class="hljs-keyword">as</span> file:
    file.write(xmlstring)

<span class="hljs-comment"># or</span>
tree = et.ElementTree(person)
tree.write(<span class="hljs-string">"myfile.xml"</span>, encoding=<span class="hljs-string">"utf-8"</span>)</code></pre>

      </section><section class="slide" id="slide-4-12">
        <h2 id="xml-with-elementtree-reading">XML with ElementTree: reading</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> et

person = et.fromstring(xmlstring)
<span class="hljs-keyword">for</span> childnode <span class="hljs-keyword">in</span> person:
    print(childnode.tag)
    print(childnode.text)
    print(childnode.attrib)</code></pre>

      </section><section class="slide" id="slide-4-13">
        <h2 id="pickle">Pickle</h2>
<p>File format that can be used to save various types of Python objects</p>
<p>Warning:</p>
<ul>
<li>Pickle files can only be read by Python Programs</li>
<li>Pickle files may contain malicious code</li>
</ul>

      </section><section class="slide" id="slide-4-14">
        <h2 id="pickle">Pickle</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pickle
<span class="hljs-keyword">import</span> datetime

now = datetime.datetime.now()

serialized = pickle.dumps()

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"datetime.pickle"</span>, mode=<span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> picklefile:
    picklefile.write(serialized)</code></pre>

      </section><section class="slide" id="slide-4-15">
        <h2 id="pickle">Pickle</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pickle

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"datetime.pickle"</span>, mode=<span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> picklefile:
    serialized = picklefile.read()
earlier = pickle.reads(serialized)</code></pre>

      </section><section class="slide" id="slide-4-16">
        <h2 id="exercise">Exercise</h2>
<p>saving / loading of a tic-tac-toe board in various formats</p>
<p>Python data structure:</p>
<pre><code class="language-py">field = [
  [<span class="hljs-string">'X'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-keyword">None</span>],
  [<span class="hljs-string">'X'</span>, <span class="hljs-string">'X'</span>, <span class="hljs-string">'O'</span>],
  [<span class="hljs-string">'O'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'X'</span>]
]</code></pre>

      </section></section><section class="section" id="section-5"><section class="slide" id="slide-5-1">
        <h1 id="working-with-files-and-folders">Working with files and folders</h1>

      </section><section class="slide" id="slide-5-2">
        <h2 id="working-with-files-and-folders">Working with files and folders</h2>
<p>two important packages:</p>
<ul>
<li><em>os</em></li>
<li><em>shutil</em></li>
</ul>

      </section><section class="slide" id="slide-5-3">
        <h2 id="os">os</h2>
<ul>
<li><code>os.getcwd()</code> (current directory)</li>
<li><code>os.chdir()</code></li>
<li><code>os.chmod()</code></li>
<li><code>os.listdir()</code></li>
<li><code>os.mkdir(&#39;foo&#39;)</code></li>
<li><code>os.rename(&#39;foo&#39;, &#39;bar&#39;)</code></li>
<li><code>os.mkdir(&#39;foo/bar/baz&#39;)</code></li>
<li><code>os.remove(&#39;foo/bar/baz/qux.txt&#39;)</code></li>
<li><code>os.rmdir(&#39;foo/bar/baz&#39;)</code></li>
<li><code>os.walk()</code></li>
</ul>

      </section><section class="slide" id="slide-5-4">
        <h2 id="shutil">shutil</h2>
<ul>
<li><code>shutil.copy(&#39;origin&#39;, &#39;destination&#39;)</code> (copy file)</li>
<li><code>shutil.copytree()</code> (copy folder)</li>
<li><code>shutil.rmtree()</code> (delete folder)</li>
<li><code>shutil.move()</code> (move file or folder)</li>
</ul>

      </section><section class="slide" id="slide-5-5">
        <h2 id="exercise">Exercise</h2>
<p>create a program that searches for occurrences of a term in all files from a folder and prints their number</p>

      </section></section><section class="section" id="section-6"><section class="slide" id="slide-6-1">
        <h1 id="regular-expressions">Regular expressions</h1>

      </section><section class="slide" id="slide-6-2">
        <h2 id="regular-expressions">Regular expressions</h2>
<p>Regular expressions are used to find a substring of a specific pattern inside a string</p>
<p>in Python regular expressions can be handled via the <code>re</code> Package, in particular:</p>
<ul>
<li><code>re.search</code></li>
<li><code>re.finditer</code></li>
</ul>

      </section><section class="slide" id="slide-6-3">
        <h2 id="regular-expressions">Regular expressions</h2>
<p>example:</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> re

match = re.search(<span class="hljs-string">r"[a-z][A-Z]"</span>, <span class="hljs-string">"abCdE"</span>)

<span class="hljs-keyword">if</span> match:
    print(<span class="hljs-string">"match"</span>)
    print(match[<span class="hljs-number">0</span>]) <span class="hljs-comment"># bC</span>
<span class="hljs-keyword">else</span>:
    print(<span class="hljs-string">"no match"</span>)</code></pre>

      </section><section class="slide" id="slide-6-4">
        <h2 id="finding-multiple-occurrences">Finding multiple occurrences</h2>
<p>example:</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> re

match_iter = re.finditer(<span class="hljs-string">r"https?://.+?\\.com"</span>, website_content)

<span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> match_iter:
    print(match[<span class="hljs-number">0</span>])</code></pre>

      </section><section class="slide" id="slide-6-5">
        <h2 id="finding-multiple-occurrences">Finding multiple occurrences</h2>
<p>Exercise: find all URLs in a HTML document on the drive</p>
<p>For an example, save the page <a href="https://news.ycombinator.com">https://news.ycombinator.com</a> to disk</p>

      </section><section class="slide" id="slide-6-6">
        <h2 id="finding-an-expression-and-sub-expressions">Finding an expression and sub expressions</h2>
<pre><code class="language-py">times = re.finditer(
    <span class="hljs-string">r'(\d?\d):(\d\d)'</span>,
    <span class="hljs-string">'The course times are 9:30 - 16:30'</span>
)

<span class="hljs-keyword">for</span> time <span class="hljs-keyword">in</span> times:
    print(<span class="hljs-string">f"hour: <span class="hljs-subst">{time[<span class="hljs-number">1</span>]}</span>"</span>)
    print(<span class="hljs-string">f"minute: <span class="hljs-subst">{time[<span class="hljs-number">2</span>]}</span>"</span>)</code></pre>

      </section><section class="slide" id="slide-6-7">
        <h2 id="exercises">Exercises</h2>
<ul>
<li>find and parse equations in text</li>
<li>find function definitions in a Python file</li>
</ul>

      </section><section class="slide" id="slide-6-8">
        <h2 id="solution-finding-equations">Solution: finding equations</h2>
<p><code>\A-?\d+x[\+-]\d+y[\+-]\d+z=\d+\Z</code></p>

      </section></section><section class="section" id="section-7"><section class="slide" id="slide-7-1">
        <h1 id="date-and-time">Date and time</h1>

      </section><section class="slide" id="slide-7-2">
        <h2 id="date-and-time">Date and time</h2>
<p>Python packages:</p>
<h3 id="datetime">datetime</h3>
<p>Working with times and dates</p>
<h3 id="time">time</h3>
<p>Working with Unix timestamps, sleep</p>

      </section><section class="slide" id="slide-7-3">
        <h2 id="datetime">datetime</h2>
<ul>
<li><code>datetime.date</code></li>
<li><code>datetime.time</code></li>
<li><code>datetime.datetime</code></li>
</ul>

      </section><section class="slide" id="slide-7-4">
        <h2 id="datetime">datetime</h2>
<pre><code class="language-py">a = datetime.time(hour, minute, second, microsecond)</code></pre>
<pre><code class="language-py">b = datetime.datetime(<span class="hljs-number">2018</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>)
c = datetime.datetime(<span class="hljs-number">2018</span>, <span class="hljs-number">3</span>, <span class="hljs-number">26</span>, <span class="hljs-number">12</span>, <span class="hljs-number">30</span>)

c - b</code></pre>

      </section><section class="slide" id="slide-7-5">
        <h2 id="timesleep">time.sleep</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> time
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):
    print(i)
    time.sleep(<span class="hljs-number">1</span>)</code></pre>

      </section><section class="slide" id="slide-7-6">
        <h2 id="timetime">time.time</h2>
<p>current Unix time (seconds since 1970-01-01 00:00:00 UTC)</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> time
time.time()</code></pre>

      </section></section><section class="section" id="section-8"><section class="slide" id="slide-8-1">
        <h1 id="sys">sys</h1>

      </section><section class="slide" id="slide-8-2">
        <h2 id="sys">sys</h2>
<p>Functions for the Python environment</p>
<p>examples:</p>
<ul>
<li><code>argv</code></li>
<li><code>stdout.write</code></li>
<li><code>getrefcount</code></li>
<li><code>path</code></li>
<li><code>version</code></li>
<li><code>version_info</code></li>
</ul>

      </section><section class="slide" id="slide-8-3">
        <h2 id="command-line-parameters">Command line parameters</h2>
<p>may be read via <code>sys.argv</code></p>

      </section><section class="slide" id="slide-8-4">
        <h2 id="overwriting-stdoutwrite">Overwriting stdout.write</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> sys

old_stdout = sys.stdout

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoudStdout</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span><span class="hljs-params">(self, text)</span>:</span>
        old_stdout.write(text.upper())

loudstdout = LoudStdout()

sys.stdout = loudstdout</code></pre>

      </section></section><section class="section" id="section-9"><section class="slide" id="slide-9-1">
        <h1 id="http-with-python">HTTP with Python</h1>

      </section><section class="slide" id="slide-9-2">
        <h2 id="http-with-python">HTTP with Python</h2>
<ul>
<li>http.client.HTTP(S)Connection</li>
<li>urllib</li>
<li>requests</li>
</ul>

      </section><section class="slide" id="slide-9-3">
        <h2 id="http-via-tcp">HTTP via TCP</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> socket

client = socket.socket()
client.connect((<span class="hljs-string">"google.com"</span>, <span class="hljs-number">80</span>))
client.send(<span class="hljs-string">b"GET / HTTP/1.1\r\nHost: www.google.com\r\n\r\n"</span>)

response = client.recv(<span class="hljs-number">4096</span>)
print(response)</code></pre>
<p>Exercise: script that reads and processes a file named <code>request.httpreq</code> and creates a file named <code>response.httpres</code></p>

      </section><section class="slide" id="slide-9-4">
        <h2 id="httpsconnection">HTTP(S)Connection</h2>
<p>low level HTTP interface</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> http.client <span class="hljs-keyword">import</span> HTTPSConnection

connection = HTTPSConnection(<span class="hljs-string">"www.google.com"</span>)
connection.request(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/"</span>)
answer = connection.getresponse()
content = answer.read()
connection.close()
print(content)</code></pre>

      </section><section class="slide" id="slide-9-5">
        <h2 id="urllib">urllib</h2>
<p>part of the standard library</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> urllib

content: bytes = urllib.request.urlopen(
                    <span class="hljs-string">"https://www.google.com"</span>).read()</code></pre>

      </section><section class="slide" id="slide-9-6">
        <h2 id="requests">requests</h2>
<p>external package that may be installed via <em>pip</em>:</p>
<pre><code class="language-bash">pip install requests</code></pre>
<pre><code class="language-py"><span class="hljs-keyword">import</span> requests

content: str = requests.get(<span class="hljs-string">"https://www.google.com"</span>).text</code></pre>

      </section><section class="slide" id="slide-9-7">
        <h2 id="exercises">Exercises</h2>
<ul>
<li>web scraping: number of Google search results</li>
<li>APIs: weather data
<a href="https://automatetheboringstuff.com/chapter14/">https://automatetheboringstuff.com/chapter14/</a></li>
<li>web scraping: xkcd downloader
<a href="https://automatetheboringstuff.com/chapter11/">https://automatetheboringstuff.com/chapter11/</a></li>
</ul>

      </section><section class="slide" id="slide-9-8">
        <h2 id="selenium">Selenium</h2>
<p>Installation:</p>
<pre><code class="language-bash">pip install selenium</code></pre>
<p>geckodriver / chromedriver / ...</p>
<p>download geckodriver from:</p>
<p><a href="https://github.com/mozilla/geckodriver/releases/tag/v0.23.0">https://github.com/mozilla/geckodriver/releases/tag/v0.23.0</a></p>
<p>Download and save in a folder in Python&#39;s <code>sys.path</code> - or in the project directory</p>

      </section></section><section class="section" id="section-10"><section class="slide" id="slide-10-1">
        <h1 id="http">HTTP</h1>

      </section><section class="slide" id="slide-10-2">
        <h2 id="http">HTTP</h2>
<p>Hypertext Transfer Protocol</p>
<p>= protocol for requesting and transferring resources over a network</p>

      </section><section class="slide" id="slide-10-3">
        <h2 id="http">HTTP</h2>
<p>Pair: Request - Response</p>
<p>Request: from the browser (mostly)</p>
<p>Response: from the server</p>
<p>HTTP requests and responses are transferred via a <em>lower-level</em> protocol, most commonly <em>TCP</em></p>

      </section><section class="slide" id="slide-10-4">
        <h2 id="experimenting-with-http">Experimenting with HTTP</h2>
<p>via:</p>
<ul>
<li>Firefox tools under <em>network</em></li>
<li>VS Code Plugin <em>HTTP Client</em></li>
</ul>

      </section><section class="slide" id="slide-10-5">
        <h2 id="http-example-wikipedia">HTTP example: Wikipedia</h2>
<p>Request:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/wiki/Main_Page</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>Response:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Date</span>: Wed, 24 Apr 2019 07:50:41 GMT
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">...</span></span></span></code></pre>

      </section><section class="slide" id="slide-10-6">
        <h2 id="http-example-wikipedia-search-1">HTTP example: Wikipedia search (1)</h2>
<p>request:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/w/index.php?search=test&amp;title=Special:Search&amp;go=Go</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>response:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">302</span> Found
<span class="hljs-attribute">Location</span>: https://en.wikipedia.org/wiki/Test
<span class="hljs-attribute">Content-Length</span>: 0</code></pre>

      </section><section class="slide" id="slide-10-7">
        <h2 id="http-example-wikipedia-search-2">HTTP example: Wikipedia search (2)</h2>
<p>request:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/wiki/Test</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>response:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">...</span></span></span></code></pre>

      </section><section class="slide" id="slide-10-8">
        <h2 id="http-example-post-request">HTTP example: POST request</h2>
<p>request:</p>
<pre><code class="language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/submit-posting</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: example.com
<span class="hljs-attribute">Connection</span>: keep-alive
<span class="hljs-attribute">Content-Type</span>: text/plain; encoding=UTF-8
<span class="hljs-attribute">Content-Length</span>: 33

<span class="ada">This <span class="hljs-keyword">is</span> the post content (<span class="hljs-keyword">body</span>)</span></code></pre>
<p>response:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="clean">...</span></code></pre>

      </section><section class="slide" id="slide-10-9">
        <h2 id="http-example-api">HTTP example: API</h2>
<pre><code class="language-http">GET /todos/12
Host: jsonplaceholder.typicode.com
Connection: keep-alive</code></pre>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: application/json; charset=utf-8
<span class="hljs-attribute">Etag</span>: W/"5c-cn8o...

<span class="json">{
  <span class="hljs-attr">"userId"</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-number">12</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"ipsa repellendus fugit nisi"</span>,
  <span class="hljs-attr">"completed"</span>: <span class="hljs-literal">true</span>
}</span></code></pre>

      </section><section class="slide" id="slide-10-10">
        <h2 id="important-request-header-fields">Important request header fields</h2>
<ul>
<li><em><code>Host</code></em></li>
<li><em><code>Connection</code></em></li>
<li><code>Origin</code></li>
<li><code>Accept</code></li>
<li><code>Accept-Encoding</code></li>
<li><code>Cookie</code></li>
<li><code>Cache-Control</code></li>
<li><code>Dnt</code></li>
</ul>

      </section><section class="slide" id="slide-10-11">
        <h2 id="important-http-status-codes">Important HTTP status codes</h2>
<ul>
<li><code>200 OK</code></li>
</ul>
<!-- list separator -->

<ul>
<li><code>301 Moved Permanently</code></li>
<li><code>307 Temporary Redirect</code> (Redirect to other address)</li>
<li><code>303 See Other</code> (Redirect to other address, HTTP method changes is set to <code>GET</code>)</li>
<li><code>308 Permanent Redirect</code></li>
<li><code>304 Not Modified</code> (Resource did not change since last query)</li>
</ul>

      </section><section class="slide" id="slide-10-12">
        <h2 id="important-http-status-codes">Important HTTP status codes</h2>
<ul>
<li><code>400 Bad Request</code></li>
<li><code>401 Unauthorized</code></li>
<li><code>403 Forbidden</code></li>
<li><code>404 Not Found</code></li>
</ul>
<!-- list separator -->

<ul>
<li><code>500 Internal Server Error</code></li>
</ul>
<p>see also: <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">https://en.wikipedia.org/wiki/List_of_HTTP_status_codes</a></p>

      </section><section class="slide" id="slide-10-13">
        <h2 id="important-response-header-fields">Important response header fields</h2>
<ul>
<li><code>Content-Length</code></li>
<li><code>Content-Type</code></li>
<li><code>Set-Cookie</code></li>
<li><code>Location</code></li>
<li><code>Cache-Control</code></li>
</ul>

      </section><section class="slide" id="slide-10-14">
        <h2 id="header-field-content-type">Header field &quot;Content-Type&quot;</h2>
<p>possible values:</p>
<ul>
<li><code>text/plain; charset=utf-8</code></li>
<li><code>text/html; charset=utf-8</code></li>
<li><code>application/json</code></li>
<li><code>application/javascript</code></li>
<li><code>application/ecmascript</code></li>
<li><code>image/jpeg</code></li>
<li><code>image/png</code></li>
<li>...</li>
</ul>

      </section><section class="slide" id="slide-10-15">
        <h2 id="header-field-set-cookie">Header field &quot;Set-Cookie&quot;</h2>
<p>example:</p>
<pre><code class="language-http">GET /
Host: www.google.com

Set-Cookie: 1P_JAR=2019-04-24-08; expires=...; path=/; domain=.google.com
Set-Cookie: IDCC=AN0-TYtU7...fo; expires=...; path=/; domain=.google.com</code></pre>

      </section></section><section class="section" id="section-11"><section class="slide" id="slide-11-1">
        <h1 id="server-side-http">Server-side HTTP</h1>

      </section><section class="slide" id="slide-11-2">
        <h2 id="operating-a-local-file-server-with-python">Operating a local file server with Python</h2>
<pre><code class="language-bash">python -m http.server</code></pre>

      </section><section class="slide" id="slide-11-3">
        <h2 id="overview">Overview</h2>
<p><a href="https://docs.python.org/2/howto/webservers.html">https://docs.python.org/2/howto/webservers.html</a></p>
<p>(info is somewhat dated)</p>

      </section><section class="slide" id="slide-11-4">
        <h2 id="cgi">CGI</h2>
<p>CGI = <em>Common Gateway Interface</em></p>
<p>Standard for letting a program on a server reply to an HTTP request</p>
<p>Interface between server software (e.g. Apache) and web application (written in any programming language)</p>
<p>Interface relies on <em>stdin</em>, <em>stdout</em> and environment variables</p>
<p>Drawback: a new Process has to be started for every request (which is slow)</p>

      </section><section class="slide" id="slide-11-5">
        <h2 id="wsgi">WSGI</h2>
<p>WSGI = Web Server Gateway Interface</p>
<p>Standard for letting a Python program on a server reply to an HTTP request</p>
<p>Inspired by CGI; advantage: <em>one</em> running Process can handle multiple request one after another</p>

      </section><section class="slide" id="slide-11-6">
        <h2 id="python-web-frameworks">Python web frameworks</h2>
<ul>
<li>Werkzeug (Python WSGI utility library)</li>
<li>Flask (fully fledged, modular framework based on Werkzeug)</li>
<li>Django (full framework)</li>
</ul>

      </section><section class="slide" id="slide-11-7">
        <h2 id="wsgi-interface">WSGI interface</h2>
<p>The entry point is a Python function:</p>
<p>The function will receive two parameters: <code>environ</code> and <code>start_response</code></p>
<p>The request parameters are available via <code>environ</code> (e.g. URL, HTTP headers, form data, ...)</p>
<p>The second parameter is a function which we usually name <code>start_response</code>.</p>

      </section><section class="slide" id="slide-11-8">
        <h2 id="wsgi">WSGI</h2>
<p>In order to start a response we call <code>start_response(status, response_headers)</code>, e.g.:</p>
<pre><code class="language-py">start_response(
    <span class="hljs-string">"200 OK"</span>,
    [(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain; charset=utf-8"</span>)]
)</code></pre>
<p>The response body is an iterable (e.g. a list) of bytestrings.</p>

      </section><section class="slide" id="slide-11-9">
        <h2 id="wsgi-server-software">WSGI server software</h2>
<p>server software:</p>
<ul>
<li>gunicorn</li>
<li>uWSGI</li>
<li>mod_wsgi</li>
</ul>

      </section><section class="slide" id="slide-11-10">
        <h2 id="custom-wsgi-server-in-python">Custom WSGI server in Python</h2>
<pre><code class="language-py"><span class="hljs-keyword">from</span> wsgiref.simple_server <span class="hljs-keyword">import</span> make_server

<span class="hljs-keyword">from</span> app <span class="hljs-keyword">import</span> application

server = make_server(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">8000</span>, application)
server.serve_forever()</code></pre>
<p>This part will usually be handled by libraries like <em>guinicorn</em></p>

      </section><section class="slide" id="slide-11-11">
        <h2 id="wsgi-application">WSGI application</h2>
<pre><code class="language-py"><span class="hljs-comment"># app.py</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">application</span><span class="hljs-params">(environ, start_response)</span>:</span>
    response_status = <span class="hljs-string">"200 OK"</span>
    response_body_text = <span class="hljs-string">"hello"</span>
    response_body = response_body_text.encode(<span class="hljs-string">"utf-8"</span>)
    response_headers = [
        (<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain; charset=utf-8"</span>),
        (<span class="hljs-string">"Content-Length"</span>, str(len(response_body))),
    ]
    start_response(response_status, response_headers)
    <span class="hljs-keyword">return</span> [response_body]</code></pre>

      </section><section class="slide" id="slide-11-12">
        <h2 id="the-environ-dictionary">The environ dictionary</h2>
<p>We can view it in the debugger, e.g.:</p>
<pre><code class="language-py">{
    <span class="hljs-string">"CONTENT_LENGTH"</span>: <span class="hljs-string">"12"</span>
    <span class="hljs-string">"HTTP_USER_AGENT"</span>: <span class="hljs-string">'Mozilla/5.0 (Win...'</span>,
    <span class="hljs-string">"HTTP_COOKIE"</span>:
    <span class="hljs-string">"PATH_INFO"</span>: <span class="hljs-string">"/todos/new"</span>,
    <span class="hljs-string">"REQUEST_METHOD"</span>: <span class="hljs-string">"GET"</span>,
    <span class="hljs-string">"wsgi.input"</span>: ...
}</code></pre>
<p><a href="https://www.python.org/dev/peps/pep-0333/#environ-variables">https://www.python.org/dev/peps/pep-0333/#environ-variables</a></p>

      </section><section class="slide" id="slide-11-13">
        <h2 id="path_info">PATH_INFO</h2>
<p>PATH_INFO in the environ dictionary: requested path on the server</p>
<p>task: show different pages at different addresses</p>

      </section><section class="slide" id="slide-11-14">
        <h2 id="redirects-with-http">Redirects with HTTP</h2>
<pre><code class="language-py">response_headers = [
    (<span class="hljs-string">"Location"</span>, <span class="hljs-string">"/login"</span>),
    (<span class="hljs-string">"Content-Length"</span>, <span class="hljs-string">"0"</span>)
]
start_response(<span class="hljs-string">"307 Temporary Redirect"</span>, response_headers)
<span class="hljs-keyword">return</span> [<span class="hljs-string">b''</span>]</code></pre>
<p>Task: Make some pages redirect, e.g. make <code>/now</code> redirect to <code>/time</code></p>

      </section><section class="slide" id="slide-11-15">
        <h2 id="cookies">Cookies</h2>
<p>Cookies = small sets of data which may be placed in the Browser by a website</p>
<p>Cookies may be used to recognize a previous visitor, e.g. for:</p>
<ul>
<li>staying logged in</li>
<li>tracking user activities</li>
<li>displaying custom ads</li>
</ul>

      </section><section class="slide" id="slide-11-16">
        <h2 id="cookies">Cookies</h2>
<p>setting cookies:</p>
<pre><code class="language-py">response_headers.append((
    <span class="hljs-string">"Set-Cookie"</span>, <span class="hljs-string">"mycookie123=abcd; Max-Age=30"</span>
))</code></pre>

      </section><section class="slide" id="slide-11-17">
        <h2 id="cookies">Cookies</h2>
<p>reading cookies:</p>
<pre><code class="language-py"><span class="hljs-keyword">try</span>:
    current_cookies_str = environ[<span class="hljs-string">"HTTP_COOKIE"</span>]
<span class="hljs-keyword">except</span> KeyError:
    ...</code></pre>
<p>result may be: <code>&quot;cookie1=one; cookie2=two&quot;</code></p>

      </section><section class="slide" id="slide-11-18">
        <h2 id="cookies">Cookies</h2>
<p>parsing cookies</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> http <span class="hljs-keyword">import</span> cookies

...

mycookies = cookies.SimpleCookie()
mycookies.load(current_cookies_str)
mycookies[<span class="hljs-string">"cookie1"</span>].value</code></pre>

      </section><section class="slide" id="slide-11-19">
        <h2 id="cookies">Cookies</h2>
<p>deleting cookies (by setting an expired cookie):</p>
<pre><code class="language-py">response_headers.append((
    <span class="hljs-string">"Set-Cookie"</span>,
    <span class="hljs-string">"mycookie123=; expires=Thu, 01 Jan 1970 00:00:00 GMT"</span>
))</code></pre>

      </section><section class="slide" id="slide-11-20">
        <h2 id="cookies">Cookies</h2>
<p>Task: Create a website which only lets the user visit content 5 times before requiring them to log in</p>

      </section><section class="slide" id="slide-11-21">
        <h2 id="forms-and-post-requests">Forms and POST requests</h2>
<p>This is how we read parameters from forms:</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> parse_qs

request_body_size = int(environ.get(<span class="hljs-string">'CONTENT_LENGTH'</span>, <span class="hljs-string">'0'</span>))
<span class="hljs-comment"># environ["wsgi.input"] is a file-like object</span>
request_body = (environ[<span class="hljs-string">"wsgi.input"</span>]
                .read(request_body_size)
                .decode(<span class="hljs-string">"utf-8"</span>))

parameters = parse_qs(request_body)
first_name = parameters.get(<span class="hljs-string">"first-name"</span>)[<span class="hljs-number">0</span>]</code></pre>

      </section><section class="slide" id="slide-11-22">
        <h2 id="exercises">Exercises</h2>
<ul>
<li>online voting</li>
<li>guest book</li>
<li>chat</li>
<li>todo application</li>
</ul>

      </section><section class="slide" id="slide-11-23">
        <h2 id="beware-javascript-injection">Beware: JavaScript injection</h2>

      </section><section class="slide" id="slide-11-24">
        <h2 id="deployment-on-pythonanywherecom">Deployment on pythonanywhere.com</h2>
<ul>
<li>new user account on <a href="https://pythonanywhere.com">https://pythonanywhere.com</a></li>
<li>add new web app</li>
<li>manual configuration</li>
</ul>

      </section><section class="slide" id="slide-11-25">
        <h2 id="deployment-on-pythonanywherecom">Deployment on pythonanywhere.com</h2>
<p>WSGI configuration file</p>
<pre><code class="language-py"><span class="hljs-comment"># /var/www/username_pythonanywhere_com_wsgi.py</span>
<span class="hljs-keyword">import</span> sys

path = <span class="hljs-string">"/home/username/"</span>
<span class="hljs-keyword">if</span> path <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> sys.path:
    sys.path.append(path)

<span class="hljs-keyword">from</span> app <span class="hljs-keyword">import</span> application</code></pre>

      </section></section><section class="section" id="section-12"><section class="slide" id="slide-12-1">
        <h1 id="databases">Databases</h1>
<p>For basics see presentation <em>databases and data store</em></p>

      </section></section><section class="section" id="section-13"><section class="slide" id="slide-13-1">
        <h1 id="sql-with-python">SQL with Python</h1>

      </section><section class="slide" id="slide-13-2">
        <h2 id="python-interfaces-for-sql-databases">Python interfaces for SQL databases</h2>
<p>Database API specification: standard which is implemented by various Python database bindings; standardized in PEP 249</p>
<p>bindings for:</p>
<ul>
<li>sqlite (Python package <em>sqlite3</em>)</li>
<li>Postgresql (PIP package <em>psycopg2</em>)</li>
<li>MySQL / mariadb (PIP package <em>PyMySQL</em></li>
<li>Oracle (PIP package <em>cx_oracle</em>)</li>
</ul>

      </section><section class="slide" id="slide-13-3">
        <h2 id="sqlite-and-python">SQLite and Python</h2>
<p>SQLite uses one file to store a database</p>
<p>comes with Python (module <code>sqlite3</code>)</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> sqlite3

connection = sqlite3.connect(<span class="hljs-string">'contacts.db'</span>)</code></pre>

      </section><section class="slide" id="slide-13-4">
        <h2 id="mysql-and-python">MySQL and Python</h2>
<p>PIP package <em>PyMySQL</em></p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pymysql.cursors

connection = pymysql.connect(host=<span class="hljs-string">'localhost'</span>,
                             user=<span class="hljs-string">'user'</span>,
                             password=<span class="hljs-string">'passwd'</span>,
                             db=<span class="hljs-string">'db'</span>,
                             charset=<span class="hljs-string">'utf8mb4'</span>)</code></pre>

      </section><section class="slide" id="slide-13-5">
        <h2 id="python-and-oracle-database">Python and Oracle Database</h2>
<p>Python package <em>cx_Oracle</em></p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> cx_Oracle

connection = cx_Oracle.connect(user=<span class="hljs-string">"user"</span>,
                               password=<span class="hljs-string">"password"</span>,
                               dsn=<span class="hljs-string">"localhost/oraclepdb"</span>)</code></pre>

      </section><section class="slide" id="slide-13-6">
        <h2 id="pyodbc">pyodbc</h2>
<p>ODBC = open database connectivity: Standard for database interfaces (independent of Python)</p>
<p>pyodbc = implementation for Python - this enables access to any ODBC database</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pyodbc

connection = pyodbc.connect(
  <span class="hljs-string">"Driver=SQLite3 ODBC Driver;Database=contacts.db"</span>)</code></pre>

      </section><section class="slide" id="slide-13-7">
        <h2 id="common-interface-pep-249">Common interface (PEP 249)</h2>
<pre><code class="language-py">connection = ...
...
cursor = connection.cursor()
cursor.execute(<span class="hljs-string">"SELECT ..."</span>)
print(cursor.fetchall())
...
cursor = connection.cursor()
cursor.execute(<span class="hljs-string">"INSERT INTO ..."</span>)
cursor.execute(<span class="hljs-string">"INSERT INTO ..."</span>)
connection.commit()
...
connection.close()</code></pre>

      </section><section class="slide" id="slide-13-8">
        <h2 id="pep-249">PEP 249</h2>
<p><a href="https://www.python.org/dev/peps/pep-0249">https://www.python.org/dev/peps/pep-0249</a></p>

      </section><section class="slide" id="slide-13-9">
        <h2 id="pep-249-types">PEP 249: types</h2>
<ul>
<li><code>Date</code></li>
<li><code>Time</code></li>
<li><code>Timestamp</code></li>
<li><code>Binary</code></li>
<li><code>STRING</code></li>
<li><code>NUMBER</code></li>
</ul>

      </section><section class="slide" id="slide-13-10">
        <h2 id="queries-with-parameters">Queries with parameters</h2>
<p>dangerous:</p>
<pre><code class="language-py">search_name = input()
res = cursor.execute(
  <span class="hljs-string">f"""SELECT tel FROM person WHERE name = '<span class="hljs-subst">{search_name}</span>'"""</span>
)</code></pre>

      </section><section class="slide" id="slide-13-11">
        <h2 id="queries-with-parameters">Queries with parameters</h2>
<p>safe method (with SQL escaping):</p>
<pre><code class="language-py">search_name = input()
res = cursor.execute(
  <span class="hljs-string">"""SELECT tel FROM person WHERE name = ?;"""</span>,
  (search_name, )
)</code></pre>

      </section><section class="slide" id="slide-13-12">
        <h2 id="queries-with-parameters">Queries with parameters</h2>
<p><a href="https://www.python.org/dev/peps/pep-0249/#paramstyle">https://www.python.org/dev/peps/pep-0249/#paramstyle</a></p>
<p>The attributes <code>sqlite3.paramstyle</code>, <code>pymysql.paramstyle</code> etc indicate the format for queries with parameters</p>
<ul>
<li>sqlite3: qmark</li>
<li>pymysql: pyformat</li>
<li>psycopg2: pyformat</li>
<li>cx_Oracle: named</li>
</ul>

      </section><section class="slide" id="slide-13-13">
        <h2 id="pep-249-the-cursor-object">PEP 249: the cursor object</h2>
<ul>
<li><code>cursor.execute(command, parameters)</code></li>
<li><code>cursor.rowcount</code>: number of result rows in the last query</li>
<li><code>cursor.fetchone()</code>: get a single row of the result (usually as a tuple)</li>
<li><code>cursor.fetchmany(10)</code></li>
<li><code>cursor.fetchall()</code></li>
</ul>

      </section><section class="slide" id="slide-13-14">
        <h2 id="exercises">Exercises</h2>
<ul>
<li>Forum with database binding (and admin script)</li>
<li>Todo application (with web interface)
(see courses-tutorials/python-todolist-wsgi-sqlite)</li>
</ul>

      </section></section><section class="section" id="section-14"><section class="slide" id="slide-14-1">
        <h1 id="sqlalchemy">SQLAlchemy</h1>
<!--
requirements: classes
-->


      </section><section class="slide" id="slide-14-2">
        <h2 id="sqlalchemy">SQLAlchemy</h2>
<p>SQLAlchemy = Object Relational Mapper</p>
<p>Object oriented access to arbitrary SQL databases</p>
<p>potential alternative: Django ORM</p>

      </section><section class="slide" id="slide-14-3">
        <h2 id="sqlalchemy">SQLAlchemy</h2>
<p>Pip package <em>sqlalchemy</em></p>

      </section><section class="slide" id="slide-14-4">
        <h2 id="connecting-with-an-sqlite-database">Connecting with an SQLite database</h2>
<pre><code class="language-py"><span class="hljs-comment"># db_interface.py</span>
<span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine

engine = create_engine(<span class="hljs-string">"sqlite:///music.db"</span>, echo=<span class="hljs-keyword">True</span>)

engine.connect()</code></pre>

      </section><section class="slide" id="slide-14-5">
        <h2 id="defining-tables">Defining tables</h2>
<pre><code class="language-py"><span class="hljs-comment"># schema.py</span>
<span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base
<span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, Integer, String

Base = declarative_base()

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Artist</span><span class="hljs-params">(Base)</span>:</span>
    __tablename__ = <span class="hljs-string">"artist"</span>
    id = Column(Integer, primary_key=<span class="hljs-keyword">True</span>)
    name = Column(String(<span class="hljs-number">30</span>))
    country = Column(String(<span class="hljs-number">20</span>))</code></pre>
<pre><code class="language-py"><span class="hljs-comment"># db_interface.py</span>
Base.metadata.create_all(engine)</code></pre>

      </section><section class="slide" id="slide-14-6">
        <h2 id="working-with-sessions">Working with sessions</h2>
<pre><code class="language-py"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker

Session = sessionmaker(bind=engine)

session = Session()

...

session.commit()</code></pre>

      </section><section class="slide" id="slide-14-7">
        <h2 id="insert">Insert</h2>
<pre><code class="language-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> artist <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'The Beatles'</span>, <span class="hljs-string">'United Kingdom'</span>);</code></pre>
<p>becomes:</p>
<pre><code class="language-py">beatles = Artist(name=<span class="hljs-string">"The Beatles"</span>, country=<span class="hljs-string">"United Kingdom"</span>)
session.add(beatles)</code></pre>

      </section><section class="slide" id="slide-14-8">
        <h2 id="select">Select</h2>
<pre><code class="language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, country <span class="hljs-keyword">FROM</span> artist;</code></pre>
<p>becomes:</p>
<pre><code class="language-py"><span class="hljs-keyword">for</span> artist <span class="hljs-keyword">in</span> session.query(Artist):
    print(<span class="hljs-string">f"<span class="hljs-subst">{artist.name}</span> (<span class="hljs-subst">{artist.country}</span>)"</span>)</code></pre>
<p>or</p>
<pre><code class="language-py"><span class="hljs-keyword">for</span> name, country <span class="hljs-keyword">in</span> session.query(Artist.name, Artist.country):
    print(<span class="hljs-string">f"<span class="hljs-subst">{name}</span> (<span class="hljs-subst">{country}</span>)"</span>)</code></pre>

      </section><section class="slide" id="slide-14-9">
        <h2 id="order-by">Order by</h2>
<pre><code class="language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, country <span class="hljs-keyword">FROM</span> artist <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">name</span>;</code></pre>
<p>becomes:</p>
<pre><code class="language-py"><span class="hljs-keyword">for</span> name, country <span class="hljs-keyword">in</span> session.query(
        Artist.name, Artist.country).order_by(Artist.name):
    ...</code></pre>

      </section><section class="slide" id="slide-14-10">
        <h2 id="where">Where</h2>
<pre><code class="language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, country <span class="hljs-keyword">FROM</span> artist <span class="hljs-keyword">WHERE</span> artist.name=<span class="hljs-string">'The Beatles'</span></code></pre>
<p>becomes:</p>
<pre><code class="language-py">session.query(Artist).filter(Artist.name==<span class="hljs-string">"The Beatles"</span>).one()</code></pre>

      </section><section class="slide" id="slide-14-11">
        <h2 id="nicer-representation-of-entries">Nicer representation of entries</h2>
<p>currently:</p>
<pre><code class="language-txt">&amp;ltdb_schema.Song object at 0x00000175902A5FD0&gt;</code></pre>
<p>better:</p>
<pre><code class="language-txt">Help! - The Beatles</code></pre>
<p>We can achieve this via the methods <code>__repr__</code> / <code>__str__</code></p>

      </section><section class="slide" id="slide-14-12">
        <h2 id="update">Update</h2>
<pre><code class="language-sql"><span class="hljs-keyword">UPDATE</span> song
<span class="hljs-keyword">SET</span> title = <span class="hljs-string">'Help'</span>
<span class="hljs-keyword">WHERE</span> title = <span class="hljs-string">'Help!'</span>;</code></pre>
<p>becomes</p>
<pre><code class="language-py">entry = session.query(Song).filter(Song.title==<span class="hljs-string">"Help!"</span>).one()
entry.title = <span class="hljs-string">"Help"</span></code></pre>

      </section><section class="slide" id="slide-14-13">
        <h2 id="delete">Delete</h2>
<pre><code class="language-sql"><span class="hljs-keyword">DELETE</span>
<span class="hljs-keyword">FROM</span> song
<span class="hljs-keyword">WHERE</span> title = <span class="hljs-string">'Help!'</span>;</code></pre>
<p>becomes</p>
<pre><code class="language-py">session.query(Song).filter(Song.title==<span class="hljs-string">"Help!"</span>).delete()</code></pre>

      </section><section class="slide" id="slide-14-14">
        <h2 id="defining-a-foreign-key">Defining a foreign key</h2>
<pre><code class="language-py"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Song</span><span class="hljs-params">(Base)</span>:</span>
    __tablename__ = <span class="hljs-string">"song"</span>
    id = Column(Integer, primary_key=<span class="hljs-keyword">True</span>)
    title = Column(String(<span class="hljs-number">30</span>))
    artist_id = Column(Integer, ForeignKey(<span class="hljs-string">"artist.id"</span>))</code></pre>

      </section><section class="slide" id="slide-14-15">
        <h2 id="querying-a-related-table">Querying a related table</h2>
<pre><code class="language-py"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> relationship

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Artist</span><span class="hljs-params">(Base)</span>:</span>
    ...
    songs = relationship(<span class="hljs-string">"Song"</span>)

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Song</span><span class="hljs-params">(Base)</span>:</span>
    ...
    artist_id = Column(Integer, ForeignKey(<span class="hljs-string">"artist.id"</span>))

    artist = relationship(<span class="hljs-string">"Artist"</span>)</code></pre>

      </section><section class="slide" id="slide-14-16">
        <h2 id="querying-a-related-table">Querying a related table</h2>
<pre><code class="language-py">yesterday = Song(title=<span class="hljs-string">"Yesterday"</span>, artist=beatles)
help = Song(title=<span class="hljs-string">"Help!"</span>, artist_id=beatles.id)
session.add(...)

print(yesterday.artist)
print(beatles.songs)</code></pre>

      </section></section><section class="section" id="section-15"><section class="slide" id="slide-15-1">
        <h1 id="gui">GUI</h1>

      </section><section class="slide" id="slide-15-2">
        <h2 id="graphical-user-interface">Graphical User Interface</h2>

      </section><section class="slide" id="slide-15-3">
        <h2 id="gui-libraries-for-python">GUI-Libraries for Python</h2>
<ul>
<li>tk</li>
<li>Qt</li>
<li>Kivy</li>
</ul>

      </section><section class="slide" id="slide-15-4">
        <h2 id="tk">tk</h2>
<ul>
<li>Simple UI library</li>
<li>Python interface: tkinter</li>
<li>comes with Python</li>
</ul>

      </section><section class="slide" id="slide-15-5">
        <h2 id="qt">Qt</h2>
<ul>
<li>widely used UI library</li>
<li>Python interfaces: PyQt or PySide</li>
</ul>

      </section><section class="slide" id="slide-15-6">
        <h2 id="kivy">Kivy</h2>
<ul>
<li>specifically developed for Python</li>
</ul>

      </section></section><section class="section" id="section-16"><section class="slide" id="slide-16-1">
        <h1 id="tkinter">Tkinter</h1>

      </section><section class="slide" id="slide-16-2">
        <h2 id="example">Example</h2>
<pre><code class="language-py"><span class="hljs-comment"># simple.pyw</span>
<span class="hljs-keyword">import</span> tkinter

<span class="hljs-comment"># ein Objekt vom Typ "Tk" erstellen</span>
window = tkinter.Tk()
<span class="hljs-comment"># Programm (event loop) starten</span>
<span class="hljs-comment">#   (auf Benutzerinteraktion warten)</span>
window.mainloop()</code></pre>

      </section><section class="slide" id="slide-16-3">
        <h2 id="displaying-text">Displaying text</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> tkinter

window = tkinter.Tk()

hello_label = tkinter.Label(master=window, text=<span class="hljs-string">"Hello!"</span>)
hello_label.pack()

window.mainloop()</code></pre>

      </section><section class="slide" id="slide-16-4">
        <h2 id="modifying-elements">Modifying elements</h2>
<pre><code class="language-py">time_label = tkinter.Label(master=window, text=<span class="hljs-string">""</span>)
time_label.config(text=<span class="hljs-string">"Hello!"</span>)</code></pre>

      </section><section class="slide" id="slide-16-5">
        <h2 id="user-interactions">User interactions</h2>
<pre><code class="language-py">...

message_label = tkinter.Label(master=window, text=<span class="hljs-string">""</span>)
message_label.pack()

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">display_message</span><span class="hljs-params">()</span>:</span>
    message_label.config(text=<span class="hljs-string">"Hello!"</span>)

hello_button = tkinter.Button(master=window,
                              text=<span class="hljs-string">"Say Hello!"</span>,
                              command=display_message)
hello_button.pack()

...</code></pre>

      </section><section class="slide" id="slide-16-6">
        <h2 id="example-counter">Example: counter</h2>
<p>Implement a button that starts at 0 and counts the number of clicks</p>

      </section><section class="slide" id="slide-16-7">
        <h2 id="widget-configuration">Widget configuration</h2>
<p>config options:</p>
<ul>
<li><code>height</code></li>
<li><code>width</code></li>
<li><code>borderwidth</code></li>
<li><code>background</code> (background color)</li>
<li><code>foreground</code> (text color)</li>
<li><code>justify</code> (text alignments, values: <code>CENTER</code>, <code>LEFT</code>, <code>RIGHT</code>)</li>
<li><code>padx</code>, <code>pady</code> (distance between the border and the content)</li>
</ul>

      </section><section class="slide" id="slide-16-8">
        <h2 id="widgets">Widgets</h2>
<ul>
<li><code>Label</code></li>
<li><code>Button</code></li>
<li><code>Frame</code></li>
</ul>

      </section><section class="slide" id="slide-16-9">
        <h2 id="examples">Examples</h2>
<ul>
<li>Snellen chart</li>
</ul>

      </section></section><section class="section" id="section-17"><section class="slide" id="slide-17-1">
        <h1 id="smtp--imap">SMTP / IMAP</h1>

      </section><section class="slide" id="slide-17-2">
        <h2 id="smtp--imap">SMTP / IMAP</h2>
<p><a href="https://automatetheboringstuff.com/chapter16/">https://automatetheboringstuff.com/chapter16/</a></p>
<p>(for error corrections see next slide)</p>
<p>for hidden password entry: use module <em>getpass</em></p>

      </section><section class="slide" id="slide-17-3">
        <h2 id="smtp--imap">SMTP / IMAP</h2>
<p>Errors in the resource:</p>
<p>provide the query as two entries:</p>
<p><del><code>UIDs = imapObj.search([&#39;SINCE 05-Jul-2014&#39;])</code></del></p>
<p><code>UIDs = imapObj.search([&#39;SINCE&#39;, &#39;05-Jul-2014&#39;])</code></p>
<p>use newer version of <em>pyzmail</em>:</p>
<p><del><code>pyzmail</code></del> ‚Üí <code>pyzmail36</code></p>
<p>use bytes instead of a string:</p>
<p><del><code>&#39;BODY[]&#39;</code></del> ‚Üí <code>b&#39;BODY[]</code></p>

      </section></section>

    </div>
    <div id="navigation-arrows">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="navigation-arrows-svg"
        xml:space="preserve" width="100%" height="100%" viewBox="-110 -110 220 220">
        <path class="arrow right" d="M70,-30L100,0L70,30" />
        <path class="arrow down" d="M-30,70L0,100L30,70" />
        <path class="arrow left" d="M-70,-30L-100,0L-70,30" />
        <path class="arrow up" d="M-30,-70L0,-100L30,-70" />
      </svg>
    </div>
  </div>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      width: 100vw;
      height: 100vh;
      margin: 0px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgb(150, 150, 150);
      font-family: -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
      line-height: 1.5rem;
    }

    p, ul, pre {
      margin-top: 0;
    }

    ul {
      padding-left: 1.5rem;
    }

    h1, h2, h3 {
      margin-top: 0px;
      font-weight: 600;
    }

    h1 {
      margin-top: 5vh;
      text-align: center;
      font-size: 2rem;
    }

    h2 {
      margin-bottom: 1.5em;
    }

    svg {
      width: 100%;
      height: auto;
    }

    .section {
      height: 100%;
      display: none;
    }

    .section.active {
      display: block;
    }

    .slide {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .slide.inactive {
      display: none;
    }

    #canvas {
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.3);
      background-color: #f8f8f8;
      position: relative;
      display: flex;
    }

    #canvas-content {
      width: 100%;
      height: 100%;
    }

    #canvas-content .note {
      display: none;
    }

    #canvas-content img {
      margin: 0px auto;
      display: block;
    }

    @media (min-aspect-ratio: 8/5) {

      html {
        font-size: 3.5vh;
      }

      /* wide screen */
      #canvas {
        width: calc(100vh / 5 * 8);
        height: 100vh;
        padding: 10vh;
        padding-top: 5vh;
      }
    }

    @media (max-aspect-ratio: 8/5) {

      html {
        font-size: calc(3.5vw * 5 / 8);
      }

      /* narrow screen */
      #canvas {
        width: 100vw;
        height: calc(100vw * 5 / 8);
        padding: calc(10vh * 5 / 8);
        padding-top: calc(5vh * 5 / 8);
      }
    }

    pre {
      background-color: rgb(224, 233, 240);
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.2);
      padding: 0.5em 1em;
      line-height: 1.2em;
      overflow: auto;
    }

    #navigation-arrows {
      position: absolute;
      right: 2rem;
      top: 2rem;
      height: 3rem;
      width: 3rem;
    }

    #navigation-arrows .arrow {
      stroke: lightblue;
      /*stroke-width: 0.8em; Chrome behaves differently with ems here */
      stroke-width: 16px;
      stroke-linecap: round;
      fill: none;
      cursor: pointer;
    }

    td,
    th {
      padding: 0.2em 0.8em;
    }

    th {
      text-align: start;
    }
  </style>
  <script>
    let presenterWindow;
    let activeSlide;
    let slideCount;

    const arrowUp = document.querySelector('.arrow.up');
    const arrowDown = document.querySelector('.arrow.down');
    const arrowRight = document.querySelector('.arrow.right');
    const arrowLeft = document.querySelector('.arrow.left');
    arrowUp.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] - 1);}
    );
    arrowDown.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] + 1);}
    );
    arrowLeft.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] - 1, 1);}
    );
    arrowRight.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] + 1, 1);}
    )
    const init = () => {
      slideCount = countSlides();
      activateSlideSafe(1, 1);
      addKeyControls();
      addSwipeControls();
    }

    // count slides
    const countSlides = () => {
      const counts = [];
      return [...document.querySelectorAll('.section')].map(section => section.childNodes.length);
    }

    const updateVisible = () => {
      for (let section of document.querySelectorAll('.section')) {
        if (section.id === `section-${activeSlide[0]}`) {
          section.className = 'section active';
        } else {
          section.className = 'section inactive';
        }
      }
      for (let slide of document.querySelectorAll('.slide')) {
        if (slide.id === `slide-${activeSlide[0]}-${activeSlide[1]}`) {
          slide.className = 'slide active';
        } else {
          slide.className = 'slide inactive';
        }
      }
    }

    const updatePageArrows = () => {
      if (slideCount.length === 1) {
        arrowLeft.style.opacity = "0";
        arrowRight.style.opacity = "0";
      } else {
        const progressSections = (activeSlide[0] - 1) / (slideCount.length - 1);
        arrowLeft.style.opacity = progressSections.toString();
        arrowRight.style.opacity = (1 - progressSections).toString();
      }
      const slidesInActiveSection = slideCount[activeSlide[0] - 1]
      if (slidesInActiveSection === 1) {
        arrowUp.style.opacity = "0";
        arrowDown.style.opacity = "0";
      } else {
        const progressSlides = (activeSlide[1] - 1) / (slidesInActiveSection - 1);
        arrowUp.style.opacity = progressSlides.toString();
        arrowDown.style.opacity = (1 - progressSlides).toString();
      }
    }

    /**
     * Activate a slide if it exists, else do nothing
    */
    const activateSlideSafe = (sectionIndex, slideIndex) => {
      if (1 <= sectionIndex && sectionIndex <= slideCount.length && 1 <= slideIndex && slideIndex <= slideCount[sectionIndex - 1]) {
        activeSlide = [sectionIndex, slideIndex];
        updateVisible();
        updatePageArrows();
        scrolltoActiveSlide();
      }
    }

    const activateSlideNextSafe = () => {
      if (activeSlide[1] === slideCount[activeSlide[0] - 1]) {
        activateSlideSafe(activeSlide[0] + 1, 1);
      } else {
        activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
      }
    }

    const activateSlideRightSafe = () => {
      activateSlideSafe(activeSlide[0] + 1, 1);
    }

    const activateSlideLeftSafe = () => {
      activateSlideSafe(activeSlide[0] - 1, 1);
    }

    const activateSlideDownSafe = () => {
      activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
    }

    const activateSlideUpSafe = () => {
      activateSlideSafe(activeSlide[0], activeSlide[1] - 1);
    }

    const scrolltoActiveSlide = () => {
      const slideId = `#slide-${activeSlide[0]}-${activeSlide[1]}`;
      if (presenterWindow) {
        const activeSlide = presenterWindow.document.querySelector(slideId);
        if (activeSlide) {
          activeSlide.scrollIntoView();
        }
      }
    }

    const addKeyControls = () => {
      document.querySelector('body').addEventListener('keydown', event => {
        if (event.key === 'p') {
          const canvasContent = document.querySelector('#canvas-content').innerHTML;
          presenterWindow = window.open(document.URL, '_blank');
          presenterWindow.onload = () => {
            presenterWindow.document.querySelector('body').innerHTML = canvasContent;
          }
        }
        if (event.key === 'ArrowRight') {
          activateSlideRightSafe();
        } else if (event.key === 'ArrowLeft') {
          activateSlideLeftSafe();
        } else if (event.key === 'ArrowDown') {
          activateSlideDownSafe();
        } else if (event.key === 'ArrowUp') {
          activateSlideUpSafe();
        } else if (event.key === 'Enter') {
          activateSlideNextSafe();
        }
      });
    }

    const addSwipeControls = () => {

      const distance = 100;

      let startPos;
      let handled;

      document.addEventListener('touchstart', event => {
        startPos = event.touches[0];
        handled = false;
      });

      document.addEventListener('touchmove', event => {
        if (!handled) {
          let currentPos = event.touches[0];
          const xDiff = currentPos.clientX - startPos.clientX;
          const yDiff = currentPos.clientY - startPos.clientY;
          if (Math.abs(xDiff) > 2*Math.abs(yDiff) ||
              Math.abs(yDiff) > 2*Math.abs(xDiff)) {
            if (xDiff > distance) {
              activateSlideLeftSafe();
              handled = true;
            } else if (xDiff < -distance) {
              activateSlideRightSafe();
              handled = true;
            } else if (yDiff > distance) {
              activateSlideUpSafe();
              handled = true;
            } else if (yDiff < -distance) {
              activateSlideDownSafe();
              handled = true;
            }
          }
        }
      });
    }

    init();

  </script>
</body>

</html>