<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Python Intermediate</title>
  <style>/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0;
}


/* Base color: saturation 0; */

.hljs,
.hljs-subst {
  color: #444;
}

.hljs-comment {
  color: #888888;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold;
}


/* User color: hue: 0 */

.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060;
}


/* Language color: hue: 90; */

.hljs-literal {
  color: #78A960;
}

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300;
}


/* Meta color: hue: 200 */

.hljs-meta {
  color: #1f7199;
}

.hljs-meta-string {
  color: #4d99bf;
}


/* Misc effects */

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style>
</head>

<body>
  <div id="canvas">
    <div id="canvas-content">

      <section class="section" id="section-1"><section class="slide" id="slide-1-1">
        <h1 id="working-with-files">Working with files</h1>

      </section><section class="slide" id="slide-1-2">
        <h2 id="working-with-files">Working with files</h2>
<p>file = a sequence of bytes on a storage device</p>

      </section><section class="slide" id="slide-1-3">
        <h2 id="the-function-open">the function &quot;open()&quot;</h2>
<pre><code class="language-py">file_obj = open(<span class="hljs-string">"todos.txt"</span>)
content = file_obj.read()
file_obj.close()
print(content)</code></pre>
<p>Open erstellt eine Instanz einer Unterklasse von IOBase</p>

      </section><section class="slide" id="slide-1-4">
        <h2 id="file-modes">file modes</h2>
<pre><code class="language-py"><span class="hljs-comment"># mode: text, append</span>
open(<span class="hljs-string">"todos.txt"</span>, mode=<span class="hljs-string">"ta"</span>)</code></pre>

      </section><section class="slide" id="slide-1-5">
        <h2 id="file-modes">file modes</h2>
<ul>
<li><p><code>t</code>: text mode (standard)</p>
</li>
<li><p><code>b</code>: binary</p>
</li>
<li><p><code>r</code>: reading (standard)</p>
</li>
<li><p><code>w</code>: (over)writing</p>
</li>
<li><p><code>a</code>: appending</p>
</li>
</ul>

      </section><section class="slide" id="slide-1-6">
        <h2 id="reading-and-writing">reading and writing</h2>
<pre><code class="language-py">t = open(<span class="hljs-string">"loremipsum.txt"</span>)
print(t.read())
t.close()</code></pre>

      </section><section class="slide" id="slide-1-7">
        <h2 id="reading-and-writing">reading and writing</h2>
<pre><code class="language-py">t = open(<span class="hljs-string">"todos.txt"</span>, mode=<span class="hljs-string">"a"</span>, encoding=<span class="hljs-string">"utf-8"</span>)
t.write(<span class="hljs-string">"Learn Python"</span>)
t.close()</code></pre>
<pre><code class="language-py">coins = open(<span class="hljs-string">"coins.b"</span>, mode=<span class="hljs-string">"ba"</span>)
coins.write(bytes([<span class="hljs-number">0b01001110</span>, <span class="hljs-number">0b11100100</span>]))
coins.close()</code></pre>

      </section><section class="slide" id="slide-1-8">
        <h2 id="open-and-the-with-statement">open and the with statement</h2>
<pre><code class="language-py"><span class="hljs-keyword">with</span> open(<span class="hljs-string">"todos.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> file_obj:
    content = file_obj.read()</code></pre>
<p>In this example using the with statement relieves us from explicitly closing the file object. The file will be automatically closed when the program leaves the indented block.</p>

      </section><section class="slide" id="slide-1-9">
        <h2 id="character-encoding">character encoding</h2>
<p>Text files may be encoded in various ways:</p>
<ul>
<li>ASCII</li>
<li>CP-1252 / western european / latin1</li>
<li>UTF-8</li>
</ul>
<p>Recommendation: <em>always</em> use utf-8 as the encoding for text files (best support for special characters)</p>

      </section><section class="slide" id="slide-1-10">
        <h2 id="character-encoding">character encoding</h2>
<p>The default character encoding for text files depends on the operating system:</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> locale
locale.getpreferredencoding()</code></pre>

      </section><section class="slide" id="slide-1-11">
        <h2 id="character-encoding">character encoding</h2>
<p>Explicitly stating the character encoding:</p>
<pre><code class="language-py">open(<span class="hljs-string">"file.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>)</code></pre>

      </section><section class="slide" id="slide-1-12">
        <h2 id="file-like-objects">File-like objects</h2>
<p>Objects that support using <code>.read()</code> or <code>.write()</code> etc:</p>
<ul>
<li>files (zB via <code>open()</code>)</li>
<li><code>sys.stdout</code>, <code>sys.stdin</code><ul>
<li>example: <code>sys.stdin.readline()</code></li>
</ul>
</li>
<li>Network replies, e.g. via <code>urllib.request.urlopen(&#39;https://google.com&#39;)</code></li>
</ul>

      </section><section class="slide" id="slide-1-13">
        <h2 id="file-like-objects">File-like objects</h2>
<pre><code class="language-py"><span class="hljs-keyword">with</span> file <span class="hljs-keyword">as</span> open(<span class="hljs-string">'myfile.txt'</span>, encoding=<span class="hljs-string">"utf-8"</span>):
    <span class="hljs-comment"># read individual lines</span>
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:
        print(line)
    <span class="hljs-comment"># read entire file</span>
    print(file.read())</code></pre>

      </section><section class="slide" id="slide-1-14">
        <h2 id="file-like-objects">File-like objects</h2>
<p>Methods:</p>
<ul>
<li><code>.close()</code></li>
<li><code>.mode</code></li>
<li><code>.read()</code> (read the entire file)</li>
<li><code>.read(10)</code> (read the next 10 bytes)</li>
<li><code>.readline()</code> (read the next line)</li>
</ul>

      </section></section><section class="section" id="section-2"><section class="slide" id="slide-2-1">
        <h1 id="working-with-various-file-formats">Working with various file formats</h1>

      </section><section class="slide" id="slide-2-2">
        <h2 id="working-with-file-formats">Working with file formats</h2>
<p>possibilities:</p>
<ul>
<li>text files</li>
<li>JSON</li>
<li>XML</li>
<li>Python object files (via pickle and shelve)</li>
<li>binary files</li>
</ul>

      </section><section class="slide" id="slide-2-3">
        <h2 id="json">JSON</h2>

      </section><section class="slide" id="slide-2-4">
        <h2 id="saving-json">saving JSON</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> json

data = [<span class="hljs-string">"one"</span>, <span class="hljs-string">"two"</span>, <span class="hljs-string">"three"</span>]
jsonstring = json.dumps(data)

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"numbers.json"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> jsonfile:
    jsonfile.write(jsonstring)</code></pre>

      </section><section class="slide" id="slide-2-5">
        <h2 id="reading-json">reading JSON</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> json

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"numbers.json"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> jsonfile:
    jsonstring = jsonfile.read()
data = json.loads(jsonstring)</code></pre>

      </section><section class="slide" id="slide-2-6">
        <h2 id="xml">XML</h2>
<p>two packages in the standard library:</p>
<ul>
<li><code>xml.etree.ElementTree</code></li>
<li><code>xml.dom.minidom</code></li>
</ul>
<p>external library (extension of ElementTree):</p>
<ul>
<li><code>lxml</code></li>
</ul>

      </section><section class="slide" id="slide-2-7">
        <h2 id="xml-with-elementtree-creating-a-document">XML with ElementTree: creating a document</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> et

person = et.Element(<span class="hljs-string">'person'</span>)
name = et.SubElement(person, <span class="hljs-string">'name'</span>)
name.text = <span class="hljs-string">'Adam'</span>
age = et.SubElement(person, <span class="hljs-string">'age'</span>)
age.text = <span class="hljs-string">'40'</span>
age.set(<span class="hljs-string">"unit"</span>, <span class="hljs-string">"years"</span>)</code></pre>

      </section><section class="slide" id="slide-2-8">
        <h2 id="xml-with-elementtree-saving">XML with ElementTree: saving</h2>
<pre><code class="language-py">xmlbytestring: bytes = et.tostring(person, encoding=<span class="hljs-string">'utf-8'</span>)
<span class="hljs-keyword">with</span> open(<span class="hljs-string">"myfile.xml"</span>, mode=<span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> file:
    file.write(xmlbytestring)

<span class="hljs-comment"># oder</span>
xmlstring: str = et.tostring(person, encoding=<span class="hljs-string">'unicode'</span>)
<span class="hljs-keyword">with</span> open(<span class="hljs-string">"myfile.xml"</span>, encoding=<span class="hljs-string">"utf-8"</span>, mode=<span class="hljs-string">"w"</span>) <span class="hljs-keyword">as</span> file:
    file.write(xmlstring)

<span class="hljs-comment"># oder</span>
tree = et.ElementTree(person)
tree.write(<span class="hljs-string">"myfile.xml"</span>, encoding=<span class="hljs-string">"utf-8"</span>)</code></pre>

      </section><section class="slide" id="slide-2-9">
        <h2 id="xml-mit-elementtree-reading">XML mit ElementTree: reading</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> et

person = et.fromstring(xmlstring)
<span class="hljs-keyword">for</span> childnode <span class="hljs-keyword">in</span> person:
    print(childnode.tag)
    print(childnode.text)
    print(childnode.attrib)</code></pre>

      </section><section class="slide" id="slide-2-10">
        <h2 id="pickle">Pickle</h2>
<p>File format that can be used to save various types of Python objects</p>

      </section><section class="slide" id="slide-2-11">
        <h2 id="pickle">Pickle</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pickle
<span class="hljs-keyword">import</span> datetime

now = datetime.datetime.now()

serialized = pickle.dumps()

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"datetime.pickle"</span>, mode=<span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> picklefile:
    picklefile.write(serialized)</code></pre>

      </section><section class="slide" id="slide-2-12">
        <h2 id="pickle">Pickle</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pickle

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"datetime.pickle"</span>, mode=<span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> picklefile:
    serialized = picklefile.read()
earlier = pickle.reads(serialized)</code></pre>

      </section><section class="slide" id="slide-2-13">
        <h2 id="exercise">exercise</h2>
<ul>
<li>saving / loading of a tic-tac-toe board in various formats</li>
</ul>
<p>Python data structure:</p>
<pre><code class="language-py">field = [
  [<span class="hljs-string">'X'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-keyword">None</span>],
  [<span class="hljs-string">'X'</span>, <span class="hljs-string">'X'</span>, <span class="hljs-string">'O'</span>],
  [<span class="hljs-string">'O'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'X'</span>]
]</code></pre>

      </section></section><section class="section" id="section-3"><section class="slide" id="slide-3-1">
        <h1 id="modules-and-packages">Modules and Packages</h1>

      </section><section class="slide" id="slide-3-2">
        <h2 id="modules-and-packages">Modules and Packages</h2>
<ul>
<li>Module = Python file from which objects can be imported</li>
<li>Package = directory that includes Python modules</li>
</ul>

      </section><section class="slide" id="slide-3-3">
        <h2 id="example-imports">example imports</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> module1
<span class="hljs-keyword">import</span> package1.module2

<span class="hljs-keyword">from</span> package1 <span class="hljs-keyword">import</span> module2
<span class="hljs-keyword">from</span> package1.module2 <span class="hljs-keyword">import</span> myobject

<span class="hljs-keyword">from</span> package1.module2 <span class="hljs-keyword">import</span> *</code></pre>

      </section><section class="slide" id="slide-3-4">
        <h2 id="example-imports-urllib">example imports: urllib</h2>
<ul>
<li><code>urllib</code> = package</li>
<li><code>urllib.request</code> = modules</li>
<li><code>urllib.request.urlopen</code> = function</li>
</ul>

      </section><section class="slide" id="slide-3-5">
        <h2 id="compilation-of-modules">compilation of modules</h2>
<p>Imported modules will be saved in a compiled form, making subsequent loading of the modules faster.</p>
<p>Compiled versions will be saved in the folder <code>__pycache__</code></p>

      </section><section class="slide" id="slide-3-6">
        <h2 id="be-careful-avoid-circular-imports">be careful: avoid circular imports</h2>

      </section></section><section class="section" id="section-4"><section class="slide" id="slide-4-1">
        <h1 id="object-oriented-programming-and-classes">Object-oriented programming and classes</h1>

      </section><section class="slide" id="slide-4-2">
        <h2 id="object-orientation-in-python-everything-is-an-object">object orientation in Python &quot;Everything is an object&quot;</h2>
<pre><code class="language-py">a = <span class="hljs-number">20</span>

a.to_bytes(<span class="hljs-number">1</span>, <span class="hljs-string">"big"</span>)

<span class="hljs-string">"hello"</span>.upper()</code></pre>

      </section><section class="slide" id="slide-4-3">
        <h2 id="types-and-instances">types and instances</h2>
<pre><code class="language-py">message = <span class="hljs-string">"hello"</span>

type(message)

isinstance(message, str)</code></pre>

      </section><section class="slide" id="slide-4-4">
        <h2 id="classes">classes</h2>
<p>Classes may represent <em>various</em> things, e.g.:</p>
<ul>
<li>a Message inside an e-mail program</li>
<li>a user of a website</li>
<li>a car in a racing game</li>
<li>a shopping basket in an online shop</li>
<li>a bank account</li>
<li>...</li>
</ul>

      </section><section class="slide" id="slide-4-5">
        <h2 id="classes">classes</h2>
<p>The definition of a class usually encompasses:</p>
<ul>
<li>a &quot;data structure&quot; (attributes)</li>
<li>a &quot;behaviour&quot; (methods)</li>
</ul>

      </section><section class="slide" id="slide-4-6">
        <h2 id="classes">classes</h2>
<p>example: class <code>BankAccount</code></p>
<ul>
<li>&quot;data structure&quot; (attributes)</li>
<li>&quot;behaviour&quot; (methods)</li>
</ul>

      </section><section class="slide" id="slide-4-7">
        <h2 id="defining-classes">defining classes</h2>
<pre><code class="language-py"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span><span class="hljs-params">()</span>:</span>

    <span class="hljs-comment"># the method __init__ initializes the object</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-comment"># inside any method, self will refer</span>
        <span class="hljs-comment"># to the current instance of the class</span>
        self.message = <span class="hljs-string">"hello"</span>

instance = MyClass()
instance.message <span class="hljs-comment"># "hello"</span></code></pre>

      </section><section class="slide" id="slide-4-8">
        <h2 id="inheritance">Inheritance</h2>
<pre><code class="language-py"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span><span class="hljs-params">()</span>:</span>
    ...

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Admin</span><span class="hljs-params">(Person)</span>:</span>
    ...</code></pre>

      </section><section class="slide" id="slide-4-9">
        <h2 id="example-class-money">Example: class &quot;Money&quot;</h2>
<pre><code class="language-py">a = Money(<span class="hljs-string">'EUR'</span>, <span class="hljs-number">10</span>)
b = Money(<span class="hljs-string">'USD'</span>, <span class="hljs-number">10</span>)

a.currency

a.amount</code></pre>

      </section><section class="slide" id="slide-4-10">
        <h2 id="exercise-classes-todolist-and-todo">Exercise: classes &quot;TodoList&quot; and &quot;Todo&quot;</h2>
<pre><code class="language-py">tdl = TodoList(<span class="hljs-string">"groceries"</span>)

tdl.add(<span class="hljs-string">"milk"</span>)
tdl.add(<span class="hljs-string">"bread"</span>)

print(tdl.todos)
tdl.todos[<span class="hljs-number">0</span>].toggle()

tdl.stats() <span class="hljs-comment"># {open: 1, completed: 1}</span></code></pre>

      </section></section>

    </div>
    <div id="navigation-arrows">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="navigation-arrows-svg"
        xml:space="preserve" width="100%" height="100%" viewBox="-110 -110 220 220">
        <path class="arrow right" d="M70,-30L100,0L70,30" />
        <path class="arrow down" d="M-30,70L0,100L30,70" />
        <path class="arrow left" d="M-70,-30L-100,0L-70,30" />
        <path class="arrow up" d="M-30,-70L0,-100L30,-70" />
      </svg>
    </div>
  </div>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      width: 100vw;
      height: 100vh;
      margin: 0px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgb(150, 150, 150);
      font-family: -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
      line-height: 1.5rem;
    }

    p, ul, pre {
      margin-top: 0;
    }

    ul {
      padding-left: 1.5rem;
    }

    h1, h2, h3 {
      font-weight: 600;
    }

    h1 {
      margin-top: 5vh;
      text-align: center;
      font-size: 2rem;
    }

    h2 {
      margin-bottom: 1.5em;
    }

    svg {
      width: 100%;
      height: auto;
    }

    .section {
      height: 100%;
      display: none;
    }

    .section.active {
      display: block;
    }

    .slide {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .slide.inactive {
      display: none;
    }

    #canvas {
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.3);
      background-color: #f8f8f8;
      position: relative;
      display: flex;
    }

    #canvas-content {
      width: 100%;
      height: 100%;
    }

    #canvas-content .note {
      display: none;
    }

    #canvas-content img {
      margin: 0px auto;
      display: block;
    }

    @media (min-aspect-ratio: 8/5) {

      html {
        font-size: 3.5vh;
      }

      /* wide screen */
      #canvas {
        width: calc(100vh / 5 * 8);
        height: 100vh;
        padding: 10vh;
        padding-top: 5vh;
      }
    }

    @media (max-aspect-ratio: 8/5) {

      html {
        font-size: calc(3.5vw * 5 / 8);
      }

      /* narrow screen */
      #canvas {
        width: 100vw;
        height: calc(100vw * 5 / 8);
        padding: calc(10vh * 5 / 8);
        padding-top: calc(5vh * 5 / 8);
      }
    }

    pre {
      background-color: rgb(224, 233, 240);
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.2);
      padding: 0.5em 1em;
      line-height: 1.2em;
      overflow: auto;
    }

    #navigation-arrows {
      position: absolute;
      right: 2rem;
      top: 2rem;
      height: 3rem;
      width: 3rem;
    }

    .arrow {
      stroke: lightblue;
      /*stroke-width: 0.8em; Chrome behaves differently with ems here */
      stroke-width: 16px;
      stroke-linecap: round;
      fill: none;
      cursor: pointer;
    }

    td,
    th {
      padding: 0.2em 0.8em;
    }

    th {
      text-align: start;
    }
  </style>
  <script>
    let presenterWindow;
    let activeSlide;
    let slideCount;

    const arrowUp = document.querySelector('.arrow.up');
    const arrowDown = document.querySelector('.arrow.down');
    const arrowRight = document.querySelector('.arrow.right');
    const arrowLeft = document.querySelector('.arrow.left');
    arrowUp.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] - 1);}
    );
    arrowDown.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] + 1);}
    );
    arrowLeft.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] - 1, 1);}
    );
    arrowRight.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] + 1, 1);}
    )
    const init = () => {
      slideCount = countSlides();
      activateSlideSafe(1, 1);
    }

    // count slides
    const countSlides = () => {
      const counts = [];
      return [...document.querySelectorAll('.section')].map(section => section.childNodes.length);
    }

    const updateVisible = () => {
      for (let section of document.querySelectorAll('.section')) {
        if (section.id === `section-${activeSlide[0]}`) {
          section.className = 'section active';
        } else {
          section.className = 'section inactive';
        }
      }
      for (let slide of document.querySelectorAll('.slide')) {
        if (slide.id === `slide-${activeSlide[0]}-${activeSlide[1]}`) {
          slide.className = 'slide active';
        } else {
          slide.className = 'slide inactive';
        }
      }
    }

    const updatePageArrows = () => {
      if (slideCount.length === 1) {
        arrowLeft.style.opacity = "0";
        arrowRight.style.opacity = "0";
      } else {
        const progressSections = (activeSlide[0] - 1) / (slideCount.length - 1);
        arrowLeft.style.opacity = progressSections.toString();
        arrowRight.style.opacity = (1 - progressSections).toString();
      }
      const slidesInActiveSection = slideCount[activeSlide[0] - 1]
      if (slidesInActiveSection === 1) {
        arrowUp.style.opacity = "0";
        arrowDown.style.opacity = "0";
      } else {
        const progressSlides = (activeSlide[1] - 1) / (slidesInActiveSection - 1);
        arrowUp.style.opacity = progressSlides.toString();
        arrowDown.style.opacity = (1 - progressSlides).toString();
      }
    }

    /**
     * Activate a slide if it exists, else do nothing
    */
    const activateSlideSafe = (sectionIndex, slideIndex) => {
      if (1 <= sectionIndex && sectionIndex <= slideCount.length && 1 <= slideIndex && slideIndex <= slideCount[sectionIndex - 1]) {
        activeSlide = [sectionIndex, slideIndex];
        updateVisible();
        updatePageArrows();
        scrolltoActiveSlide();
      }
    }

    const activateNextSlide = () => {
      if (activeSlide[1] === slideCount[activeSlide[0] - 1]) {
        activateSlideSafe(activeSlide[0] + 1, 1);
      } else {
        activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
      }
    }

    const scrolltoActiveSlide = () => {
      const slideId = `#slide-${activeSlide[0]}-${activeSlide[1]}`;
      if (presenterWindow) {
        const activeSlide = presenterWindow.document.querySelector(slideId);
        if (activeSlide) {
          activeSlide.scrollIntoView();
        }
      }
    }

    document.querySelector('body').addEventListener('keydown', event => {
      if (event.key === 'p') {
        const canvasContent = document.querySelector('#canvas-content').innerHTML;
        presenterWindow = window.open(document.URL, '_blank');
        presenterWindow.onload = () => {
          presenterWindow.document.querySelector('body').innerHTML = canvasContent;
        }
      }
      if (event.key === 'ArrowRight') {
        activateSlideSafe(activeSlide[0] + 1, 1);
      } else if (event.key === 'ArrowLeft') {
        activateSlideSafe(activeSlide[0] - 1, 1);
      } else if (event.key === 'ArrowDown') {
        activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
      } else if (event.key === 'ArrowUp') {
        activateSlideSafe(activeSlide[0], activeSlide[1] - 1);
      } else if (event.key === 'Enter') {
        activateNextSlide();
      } else {
        console.log(event.key)
      }
    });

    init();

  </script>
</body>

</html>