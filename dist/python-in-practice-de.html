<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Python in der Praxis</title>
  <style>/*

Original highlight.js style (c) Ivan Sagalaev <maniac@softwaremaniacs.org>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #F0F0F0;
}


/* Base color: saturation 0; */

.hljs,
.hljs-subst {
  color: #444;
}

.hljs-comment {
  color: #888888;
}

.hljs-keyword,
.hljs-attribute,
.hljs-selector-tag,
.hljs-meta-keyword,
.hljs-doctag,
.hljs-name {
  font-weight: bold;
}


/* User color: hue: 0 */

.hljs-type,
.hljs-string,
.hljs-number,
.hljs-selector-id,
.hljs-selector-class,
.hljs-quote,
.hljs-template-tag,
.hljs-deletion {
  color: #880000;
}

.hljs-title,
.hljs-section {
  color: #880000;
  font-weight: bold;
}

.hljs-regexp,
.hljs-symbol,
.hljs-variable,
.hljs-template-variable,
.hljs-link,
.hljs-selector-attr,
.hljs-selector-pseudo {
  color: #BC6060;
}


/* Language color: hue: 90; */

.hljs-literal {
  color: #78A960;
}

.hljs-built_in,
.hljs-bullet,
.hljs-code,
.hljs-addition {
  color: #397300;
}


/* Meta color: hue: 200 */

.hljs-meta {
  color: #1f7199;
}

.hljs-meta-string {
  color: #4d99bf;
}


/* Misc effects */

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style>
</head>

<body>
  <div id="canvas">
    <div id="no-script">
      Could not execute modern JavaScript code. Please switch to a modern browser,
      e.g. the most recent version of Firefox, Chrome or Edge and enable JavaScript.
    </div>
    <div id="canvas-content">

      <section class="section" id="section-1"><section class="slide" id="slide-1-1">
        <h1 id="title">Python in der Praxis</h1>

      </section><section class="slide" id="slide-1-2">
        <h2 id="präsentation-und-code">Präsentation und Code</h2>
<p>Präsentationen verfügbar unter: <a href="https://karuga.eu/courses-presentations">https://karuga.eu/courses-presentations</a></p>
<p>Code verfügbar unter: <a href="https://github.com/marko-knoebl/courses-code">https://github.com/marko-knoebl/courses-code</a></p>

      </section><section class="slide" id="slide-1-3">
        <h2 id="ihr-trainer">Ihr Trainer</h2>
<p>Marko Knöbl</p>
<ul>
<li>Frontend Web-Entwicklung<ul>
<li>JavaScript</li>
<li>React, Angular</li>
</ul>
</li>
<li>Programmierung<ul>
<li>Python, JavaScript</li>
</ul>
</li>
</ul>

      </section><section class="slide" id="slide-1-4">
        <h2 id="vorstellung-der-teilnehmer">Vorstellung der Teilnehmer</h2>
<ul>
<li>Name</li>
<li>Firma</li>
<li>Aktuelle Projekte</li>
<li>Grund der Schulung</li>
<li>Vorkenntnisse</li>
<li>Erwartungen / Wünsche</li>
</ul>

      </section><section class="slide" id="slide-1-5">
        <h2 id="organisatorisches">Organisatorisches</h2>
<ul>
<li>Kursdauer</li>
<li>Pausen</li>
<li>Mittagessen</li>
<li>Unterlagen</li>
<li>Fragen, Feedback? - Jederzeit erwünscht</li>
</ul>

      </section></section><section class="section" id="section-2"><section class="slide" id="slide-2-1">
        <h1 id="themen">Themen</h1>
<ul>
<li>Arbeiten mit Dateien und Ordnern</li>
<li>Reguläre Ausdrücke</li>
<li>Zeit und Datum</li>
<li>sys</li>
<li>HTTP Client</li>
<li>Webentwicklung</li>
<li>Datenbanken</li>
<li>GUI</li>
<li>e-mail</li>
</ul>

      </section></section><section class="section" id="section-3"><section class="slide" id="slide-3-1">
        <h1 id="arbeiten-mit-dateien">Arbeiten mit Dateien</h1>

      </section><section class="slide" id="slide-3-2">
        <h2 id="arbeiten-mit-dateien">Arbeiten mit Dateien</h2>
<p>Datei = Abfolge von Bytes auf einem Speichermedium</p>

      </section><section class="slide" id="slide-3-3">
        <h2 id="die-funktion-open">Die Funktion &quot;open&quot;</h2>
<pre><code class="language-py">file_obj = open(<span class="hljs-string">"todos.txt"</span>)
content = file_obj.read()
file_obj.close()
print(content)</code></pre>
<p>Open erstellt eine Instanz einer Unterklasse von IOBase</p>

      </section><section class="slide" id="slide-3-4">
        <h2 id="dateimodi">Dateimodi</h2>
<pre><code class="language-py"><span class="hljs-comment"># mode: text, append</span>
open(<span class="hljs-string">"todos.txt"</span>, mode=<span class="hljs-string">"ta"</span>)</code></pre>

      </section><section class="slide" id="slide-3-5">
        <h2 id="dateimodi">Dateimodi</h2>
<ul>
<li><code>t</code>: Textmodus (standard)</li>
<li><code>b</code>: Binär</li>
</ul>
<!-- list-separator -->

<ul>
<li><code>r</code>: Lesen (standard)</li>
<li><code>w</code>: (Über)schreiben</li>
<li><code>a</code>: Anhängen</li>
</ul>

      </section><section class="slide" id="slide-3-6">
        <h2 id="lesen-und-schreiben">Lesen und Schreiben</h2>
<pre><code class="language-py">t = open(<span class="hljs-string">"loremipsum.txt"</span>)
print(t.read())
t.close()</code></pre>

      </section><section class="slide" id="slide-3-7">
        <h2 id="lesen-und-schreiben">Lesen und Schreiben</h2>
<pre><code class="language-py">t = open(<span class="hljs-string">"todos.txt"</span>, mode=<span class="hljs-string">"a"</span>, encoding=<span class="hljs-string">"utf-8"</span>)
t.write(<span class="hljs-string">"Learn Python"</span>)
t.close()</code></pre>
<pre><code class="language-py">coins = open(<span class="hljs-string">"coins.b"</span>, mode=<span class="hljs-string">"ba"</span>)
coins.write(bytes([<span class="hljs-number">0b01001110</span>, <span class="hljs-number">0b11100100</span>]))
coins.close()</code></pre>

      </section><section class="slide" id="slide-3-8">
        <h2 id="open-und-das-with-statement">Open und das with-Statement</h2>
<pre><code class="language-py"><span class="hljs-keyword">with</span> open(<span class="hljs-string">"todos.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> file_obj:
    content = file_obj.read()</code></pre>
<p>Kein explizites Schließen des Dateiobjekts mehr notwendig. Datei wird automatisch geschlossen, wenn der eingerückte Abschnitt verlassen wird.</p>

      </section><section class="slide" id="slide-3-9">
        <h2 id="zeichencodierung">Zeichencodierung</h2>
<p>Textdateien können unterschiedlich codiert sein:</p>
<ul>
<li>ASCII</li>
<li>CP-1252 / western european / latin1</li>
<li>UTF-8</li>
</ul>
<p>Praxistipp: Immer UTF-8 verwenden</p>

      </section><section class="slide" id="slide-3-10">
        <h2 id="zeichencodierung">Zeichencodierung</h2>
<p>Die Standard-Zeichencodierung für Textdateien hängt vom Betriebssystem ab:</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> locale
locale.getpreferredencoding()</code></pre>

      </section><section class="slide" id="slide-3-11">
        <h2 id="zeichencodierung">Zeichencodierung</h2>
<p>Explizites angeben der Textcodierung:</p>
<pre><code class="language-py">open(<span class="hljs-string">"file.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>)</code></pre>

      </section><section class="slide" id="slide-3-12">
        <h2 id="file-like-objects">File-like objects</h2>
<p>Objekte, die z.B. <code>.read()</code> oder <code>.write()</code> unterstützen:</p>
<ul>
<li>Dateien (z.B. via <code>open()</code>)</li>
<li><code>sys.stdout</code>, <code>sys.stdin</code><ul>
<li>z.B. <code>sys.stdin.readline()</code></li>
</ul>
</li>
<li>Antworten aus dem Netzwerk, z.B. via <code>urllib.request.urlopen(&#39;https://google.com&#39;)</code></li>
</ul>

      </section><section class="slide" id="slide-3-13">
        <h2 id="file-like-objects">File-like objects</h2>
<p>Zeile für Zeile einlesen (geringer Speicherbedarf):</p>
<pre><code class="language-py"><span class="hljs-keyword">with</span> open(<span class="hljs-string">"myfile.txt"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> file:
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file:
        print(line)</code></pre>

      </section><section class="slide" id="slide-3-14">
        <h2 id="file-like-objects">File-like objects</h2>
<p>Methoden / Attribute:</p>
<ul>
<li><code>.close()</code></li>
<li><code>.mode</code></li>
<li><code>.read()</code> (lies die ganze Datei ein)</li>
<li><code>.read(10)</code> (lies die nächsten 10 Bytes)</li>
<li><code>.readline()</code> (lies die nächste Zeile)</li>
</ul>

      </section></section><section class="section" id="section-4"><section class="slide" id="slide-4-1">
        <h1 id="speichern-verschiedener-dateiformate">Speichern verschiedener Dateiformate</h1>

      </section><section class="slide" id="slide-4-2">
        <h2 id="speichern-verschiedener-dateiformate">Speichern verschiedener Dateiformate</h2>
<p>Möglichkeiten:</p>
<ul>
<li>Speichern in Text-Datei</li>
<li>Speichern als JSON</li>
<li>Speichern als CSV</li>
<li>Speichern von Python-Objekten mittels pickle (und shelve)</li>
<li>Speichern als XML</li>
<li>Speichern von Binärdaten in eigenem Format</li>
</ul>

      </section><section class="slide" id="slide-4-3">
        <h2 id="csv">CSV</h2>

      </section><section class="slide" id="slide-4-4">
        <h2 id="csv-schreiben">CSV schreiben</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> csv

data = [
    [<span class="hljs-string">'code'</span>, <span class="hljs-string">'area'</span>, <span class="hljs-string">'population'</span>],
    [<span class="hljs-string">'CN'</span>, <span class="hljs-number">9.6</span>, <span class="hljs-number">1386</span>],
    [<span class="hljs-string">'RU'</span>, <span class="hljs-number">17</span>, <span class="hljs-number">144</span>],
    [<span class="hljs-string">'US'</span>, <span class="hljs-number">9.8</span>, <span class="hljs-number">327</span>]
]

<span class="hljs-keyword">with</span> open(<span class="hljs-string">'data.csv'</span>, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'utf-8'</span>, newline=<span class="hljs-string">''</span>) <span class="hljs-keyword">as</span> f:
    writer = csv.writer(f)
    writer.writerows(data)</code></pre>

      </section><section class="slide" id="slide-4-5">
        <h2 id="csv-lesen">CSV lesen</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> csv

<span class="hljs-keyword">with</span> open(<span class="hljs-string">'countries.csv'</span>, encoding=<span class="hljs-string">'utf-8'</span>, newline=<span class="hljs-string">''</span>) <span class="hljs-keyword">as</span> csv_file:
    reader = csv.reader(csv_file)
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> reader:
        print(row)</code></pre>

      </section><section class="slide" id="slide-4-6">
        <h2 id="json">JSON</h2>

      </section><section class="slide" id="slide-4-7">
        <h2 id="json-speichern">JSON speichern</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> json

data = [<span class="hljs-string">"one"</span>, <span class="hljs-string">"two"</span>, <span class="hljs-string">"three"</span>]
jsonstring = json.dumps(data)

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"numbers.json"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> jsonfile:
    jsonfile.write(jsonstring)</code></pre>

      </section><section class="slide" id="slide-4-8">
        <h2 id="json-lesen">JSON lesen</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> json

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"numbers.json"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> jsonfile:
    jsonstring = jsonfile.read()
data = json.loads(jsonstring)</code></pre>

      </section><section class="slide" id="slide-4-9">
        <h2 id="xml">XML</h2>
<p>zwei Pakete in der Python-Standardlibrary:</p>
<ul>
<li><code>xml.etree.ElementTree</code></li>
<li><code>xml.dom.minidom</code></li>
</ul>
<p>externe Library (Erweiterung von ElementTree):</p>
<ul>
<li><code>lxml</code></li>
</ul>

      </section><section class="slide" id="slide-4-10">
        <h2 id="xml-mit-elementtree-erstellen">XML mit ElementTree: erstellen</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> et

person = et.Element(<span class="hljs-string">'person'</span>)
name = et.SubElement(person, <span class="hljs-string">'name'</span>)
name.text = <span class="hljs-string">'Adam'</span>
age = et.SubElement(person, <span class="hljs-string">'age'</span>)
age.text = <span class="hljs-string">'40'</span>
age.set(<span class="hljs-string">"unit"</span>, <span class="hljs-string">"years"</span>)</code></pre>

      </section><section class="slide" id="slide-4-11">
        <h2 id="xml-mit-elementtree-speichern">XML mit ElementTree: speichern</h2>
<p>Beim Speichern von XML immer ein Encoding angeben!</p>
<pre><code class="language-py">xmlbytestring: bytes = et.tostring(person, encoding=<span class="hljs-string">'utf-8'</span>)
<span class="hljs-keyword">with</span> open(<span class="hljs-string">"myfile.xml"</span>, mode=<span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> file:
    file.write(xmlbytestring)

<span class="hljs-comment"># or</span>
xmlstring: str = et.tostring(person, encoding=<span class="hljs-string">'unicode'</span>)
<span class="hljs-keyword">with</span> open(<span class="hljs-string">"myfile.xml"</span>, encoding=<span class="hljs-string">"utf-8"</span>, mode=<span class="hljs-string">"w"</span>) <span class="hljs-keyword">as</span> file:
    file.write(xmlstring)

<span class="hljs-comment"># or</span>
tree = et.ElementTree(person)
tree.write(<span class="hljs-string">"myfile.xml"</span>, encoding=<span class="hljs-string">"utf-8"</span>)</code></pre>

      </section><section class="slide" id="slide-4-12">
        <h2 id="xml-mit-elementtree-lesen">XML mit ElementTree: lesen</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> et

person = et.fromstring(xmlstring)
<span class="hljs-keyword">for</span> childnode <span class="hljs-keyword">in</span> person:
    print(childnode.tag)
    print(childnode.text)
    print(childnode.attrib)</code></pre>

      </section><section class="slide" id="slide-4-13">
        <h2 id="pickle">Pickle</h2>
<p>Eigenes Dateiformat, in dem verschiedene Python-Dateitypen gespeichert werden können</p>
<p>Achtung:</p>
<ul>
<li>Pickle-Dateien können nur von Python gelesen werden</li>
<li>Pickle-Dateien können bösartigen Code enthalten</li>
</ul>

      </section><section class="slide" id="slide-4-14">
        <h2 id="pickle">Pickle</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pickle
<span class="hljs-keyword">import</span> datetime

now = datetime.datetime.now()

serialized = pickle.dumps()

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"datetime.pickle"</span>, mode=<span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> picklefile:
    picklefile.write(serialized)</code></pre>

      </section><section class="slide" id="slide-4-15">
        <h2 id="pickle">Pickle</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pickle

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"datetime.pickle"</span>, mode=<span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> picklefile:
    serialized = picklefile.read()
earlier = pickle.reads(serialized)</code></pre>

      </section><section class="slide" id="slide-4-16">
        <h2 id="übung">Übung</h2>
<p>Speichern und Lesen eines Tic-Tac-Toe-Feldes in verschiedenen Formaten</p>
<p>Python-Datenstruktur:</p>
<pre><code class="language-py">field = [
  [<span class="hljs-string">'X'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-keyword">None</span>],
  [<span class="hljs-string">'X'</span>, <span class="hljs-string">'X'</span>, <span class="hljs-string">'O'</span>],
  [<span class="hljs-string">'O'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'X'</span>]
]</code></pre>

      </section></section><section class="section" id="section-5"><section class="slide" id="slide-5-1">
        <h1 id="arbeiten-mit-dateien-und-ordnern">Arbeiten mit Dateien und Ordnern</h1>

      </section><section class="slide" id="slide-5-2">
        <h2 id="arbeiten-mit-dateien-und-ordnern">Arbeiten mit Dateien und Ordnern</h2>
<p>zwei wichtige Pakete:</p>
<ul>
<li><em>os</em></li>
<li><em>shutil</em></li>
</ul>

      </section><section class="slide" id="slide-5-3">
        <h2 id="os">os</h2>
<ul>
<li><code>os.getcwd()</code> (aktueller Pfad)</li>
<li><code>os.chdir()</code></li>
<li><code>os.chmod()</code></li>
<li><code>os.listdir()</code></li>
<li><code>os.mkdir(&#39;foo&#39;)</code></li>
<li><code>os.rename(&#39;foo&#39;, &#39;bar&#39;)</code></li>
<li><code>os.mkdir(&#39;foo/bar/baz&#39;)</code></li>
<li><code>os.remove(&#39;foo/bar/baz/qux.txt&#39;)</code></li>
<li><code>os.rmdir(&#39;foo/bar/baz&#39;)</code></li>
<li><code>os.walk()</code></li>
</ul>

      </section><section class="slide" id="slide-5-4">
        <h2 id="shutil">shutil</h2>
<ul>
<li><code>shutil.copy(&#39;origin&#39;, &#39;destination&#39;)</code> (Datei kopieren)</li>
<li><code>shutil.copytree()</code> (Ordner kopieren)</li>
<li><code>shutil.rmtree()</code> (Ordner löschen)</li>
<li><code>shutil.move()</code> (Datei oder Ordner verschieben)</li>
</ul>

      </section><section class="slide" id="slide-5-5">
        <h2 id="übung">Übung</h2>
<p>Programm, das alle Textdateien in einem Ordner nach einem Begriff durchsucht und die Anzahlen angibt</p>

      </section></section><section class="section" id="section-6"><section class="slide" id="slide-6-1">
        <h1 id="reguläre-ausdrücke">Reguläre Ausdrücke</h1>
<p>Reguläre Ausdrücke werden verwendet, um einen Teil eines Strings, der einem bestimmten Muster entspricht, zu finden</p>
<p>In Python können reguläre Ausdrücke mittels des Pakets <code>re</code> behandelt werden, insbesondere:</p>
<ul>
<li><code>re.search</code></li>
<li><code>re.finditer</code></li>
</ul>

      </section><section class="slide" id="slide-6-2">
        <h2 id="reguläre-ausdrücke">Reguläre Ausdrücke</h2>
<p>Beispiel:</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> re

match = re.search(<span class="hljs-string">r"[a-z][A-Z]"</span>, <span class="hljs-string">"abCdE"</span>)

<span class="hljs-keyword">if</span> match:
    print(<span class="hljs-string">"match"</span>)
    print(match[<span class="hljs-number">0</span>]) <span class="hljs-comment"># bC</span>
<span class="hljs-keyword">else</span>:
    print(<span class="hljs-string">"no match"</span>)</code></pre>

      </section><section class="slide" id="slide-6-3">
        <h2 id="mehrfach-finden">Mehrfach finden</h2>
<p>Beispiel:</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> re

match_iter = re.finditer(<span class="hljs-string">r"https?://.+?\.com"</span>, website_content)

<span class="hljs-keyword">for</span> match <span class="hljs-keyword">in</span> match_iter:
    print(match[<span class="hljs-number">0</span>])</code></pre>

      </section><section class="slide" id="slide-6-4">
        <h2 id="mehrfach-finden">Mehrfach finden</h2>
<p>Aufgabe: finde alle URLs in einem HTML-Dokument auf der Festplatte</p>
<p>(Beispieldokument: z.B. Seite <a href="https://news.ycombinator.com">https://news.ycombinator.com</a> auf Festplatte speichern)</p>

      </section><section class="slide" id="slide-6-5">
        <h2 id="einen-ausdruck-und-unterausdrücke-finden">Einen Ausdruck und Unterausdrücke finden</h2>
<pre><code class="language-py">times = re.finditer(
    <span class="hljs-string">r'(\d?\d):(\d\d)'</span>,
    <span class="hljs-string">'The course times are 9:30 - 16:30'</span>
)

<span class="hljs-keyword">for</span> time <span class="hljs-keyword">in</span> times:
    print(<span class="hljs-string">f"hour: <span class="hljs-subst">{time[<span class="hljs-number">1</span>]}</span>"</span>)
    print(<span class="hljs-string">f"minute: <span class="hljs-subst">{time[<span class="hljs-number">2</span>]}</span>"</span>)</code></pre>

      </section><section class="slide" id="slide-6-6">
        <h2 id="beispiele">Beispiele</h2>
<ul>
<li>Alle Funktionsdefinitionen in einer Python-Datei finden und deren Namen auslesen</li>
<li>Geldbeträge finden und parsen</li>
<li>Gleichungen erkennen und auslesen</li>
</ul>

      </section></section><section class="section" id="section-7"><section class="slide" id="slide-7-1">
        <h1 id="datum-und-zeit">Datum und Zeit</h1>

      </section><section class="slide" id="slide-7-2">
        <h2 id="datum-und-zeit">Datum und Zeit</h2>
<p>Python-Pakete:</p>
<h3 id="datetime">datetime</h3>
<p>Arbeiten mit Zeiten und Datumsangaben</p>
<h3 id="time">time</h3>
<p>Arbeiten mit Unix-Timestamps, sleep</p>

      </section><section class="slide" id="slide-7-3">
        <h2 id="datetime">datetime</h2>
<ul>
<li><code>datetime.date</code></li>
<li><code>datetime.time</code></li>
<li><code>datetime.datetime</code></li>
</ul>

      </section><section class="slide" id="slide-7-4">
        <h2 id="datetime">datetime</h2>
<pre><code class="language-py">a = datetime.time(hour, minute, second, microsecond)</code></pre>
<pre><code class="language-py">b = datetime.datetime(<span class="hljs-number">2018</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>)
c = datetime.datetime(<span class="hljs-number">2018</span>, <span class="hljs-number">3</span>, <span class="hljs-number">26</span>, <span class="hljs-number">12</span>, <span class="hljs-number">30</span>)

c - b</code></pre>

      </section><section class="slide" id="slide-7-5">
        <h2 id="timesleep">time.sleep</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> time
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):
    print(i)
    time.sleep(<span class="hljs-number">1</span>)</code></pre>

      </section><section class="slide" id="slide-7-6">
        <h2 id="timetime">time.time</h2>
<p>aktuelle Unix-Zeit (Sekunden seit 1970-01-01 00:00:00 UTC)</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> time
time.time()</code></pre>

      </section></section><section class="section" id="section-8"><section class="slide" id="slide-8-1">
        <h1 id="sys">sys</h1>

      </section><section class="slide" id="slide-8-2">
        <h2 id="sys">sys</h2>
<p>Funktionen zur Python-Umgebung</p>
<p>Beispiele:</p>
<ul>
<li><code>argv</code></li>
<li><code>stdout.write</code></li>
<li><code>getrefcount</code></li>
<li><code>path</code></li>
<li><code>version</code></li>
<li><code>version_info</code></li>
</ul>

      </section><section class="slide" id="slide-8-3">
        <h2 id="kommandozeilenparameter">Kommandozeilenparameter</h2>
<p>Auslesbar über <code>sys.argv</code></p>

      </section><section class="slide" id="slide-8-4">
        <h2 id="überschreiben-von-stdoutwrite">Überschreiben von stdout.write</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> sys

old_stdout = sys.stdout

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoudStdout</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">write</span><span class="hljs-params">(self, text)</span>:</span>
        old_stdout.write(text.upper())

loudstdout = LoudStdout()

sys.stdout = loudstdout</code></pre>

      </section></section><section class="section" id="section-9"><section class="slide" id="slide-9-1">
        <h1 id="http-mit-python">HTTP mit Python</h1>

      </section><section class="slide" id="slide-9-2">
        <h2 id="http-mit-python">HTTP mit Python</h2>
<ul>
<li>http.client.HTTP(S)Connection</li>
<li>urllib</li>
<li>requests</li>
</ul>

      </section><section class="slide" id="slide-9-3">
        <h2 id="http-via-tcp">HTTP via TCP</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> socket

client = socket.socket()
client.connect((<span class="hljs-string">"google.com"</span>, <span class="hljs-number">80</span>))
client.send(<span class="hljs-string">b"GET / HTTP/1.1\r\nHost: www.google.com\r\n\r\n"</span>)

response = client.recv(<span class="hljs-number">4096</span>)
print(response)</code></pre>
<p>Übung: Skript, das die eine Datei <code>request.httpreq</code> einliest und verarbeitet und eine Datei <code>response.httpres</code> generiert</p>

      </section><section class="slide" id="slide-9-4">
        <h2 id="httpsconnection">HTTP(S)Connection</h2>
<p>low-level Interface</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> http.client <span class="hljs-keyword">import</span> HTTPSConnection

connection = HTTPSConnection(<span class="hljs-string">"www.google.com"</span>)
connection.request(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/"</span>)
answer = connection.getresponse()
content = answer.read()
connection.close()
print(content)</code></pre>

      </section><section class="slide" id="slide-9-5">
        <h2 id="urllib">urllib</h2>
<p>in Standardlibrary</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> request

content: bytes = request.urlopen(
                    <span class="hljs-string">"https://www.google.com"</span>).read()</code></pre>

      </section><section class="slide" id="slide-9-6">
        <h2 id="requests">requests</h2>
<p>Externes Paket, installierbar via <em>pip</em>:</p>
<pre><code class="language-bash">pip install requests</code></pre>
<pre><code class="language-py"><span class="hljs-keyword">import</span> requests

content: str = requests.get(<span class="hljs-string">"https://www.google.com"</span>).text</code></pre>

      </section><section class="slide" id="slide-9-7">
        <h2 id="übungen">Übungen</h2>
<ul>
<li>web scraping: Anzahl der Google-Suchergebnisse</li>
<li>web scraping: Überschriften (Headings) in einem Wikipedia Artikel</li>
<li>APIs: Wetterdaten
<a href="https://automatetheboringstuff.com/chapter14/">https://automatetheboringstuff.com/chapter14/</a></li>
<li>Web Scraping: xkcd Downloader
<a href="https://automatetheboringstuff.com/chapter11/">https://automatetheboringstuff.com/chapter11/</a></li>
</ul>

      </section><section class="slide" id="slide-9-8">
        <h2 id="selenium">Selenium</h2>
<p>Installation:</p>
<pre><code class="language-bash">pip install selenium</code></pre>
<p>geckodriver / chromedriver / ...</p>
<p>geckodriver Download von:</p>
<p><a href="https://github.com/mozilla/geckodriver/releases/tag/v0.23.0">https://github.com/mozilla/geckodriver/releases/tag/v0.23.0</a></p>
<p>Herunterladen und in einem Pfad in Pythons <code>sys.path</code> ablegen - oder im Projektverzeichnis</p>

      </section></section><section class="section" id="section-10"><section class="slide" id="slide-10-1">
        <h1 id="http">HTTP</h1>

      </section><section class="slide" id="slide-10-2">
        <h2 id="http">HTTP</h2>
<p>Hypertext Transfer Protocol</p>
<p>= Protokoll, auf dessen Basis Resourcen über das Netzwerk angefragt und übertragen werden können</p>

      </section><section class="slide" id="slide-10-3">
        <h2 id="http">HTTP</h2>
<p>Paar: Anfrage - Antwort</p>
<p>Anfrage: meist aus dem Browser</p>
<p>Antwort: kommt vom Server</p>
<p>HTTP Anfragen und Antworten werden wiederum über ein &quot;niedrigeres&quot; Protokoll übertragen, üblicherweise <em>TCP</em>.</p>

      </section><section class="slide" id="slide-10-4">
        <h2 id="experimentieren-mit-http">Experimentieren mit HTTP</h2>
<p>Möglichkeiten:</p>
<ul>
<li>Browser-Tools unter &quot;Netzwerkanalyse&quot;</li>
<li>VS Code Plugin <em>HTTP Client</em></li>
</ul>

      </section><section class="slide" id="slide-10-5">
        <h2 id="http-beispiel-wikipedia">HTTP: Beispiel Wikipedia</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/wiki/Main_Page</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Date</span>: Wed, 24 Apr 2019 07:50:41 GMT
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">...</span></span></span></code></pre>

      </section><section class="slide" id="slide-10-6">
        <h2 id="http-beispiel-wikipedia-suche-1">HTTP: Beispiel Wikipedia Suche (1)</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/w/index.php?search=test&amp;title=Special:Search&amp;go=Go</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">302</span> Found
<span class="hljs-attribute">Location</span>: https://en.wikipedia.org/wiki/Test
<span class="hljs-attribute">Content-Length</span>: 0</code></pre>

      </section><section class="slide" id="slide-10-7">
        <h2 id="http-beispiel-wikipedia-suche-2">HTTP: Beispiel Wikipedia Suche (2)</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/wiki/Test</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: en.wikipedia.org
<span class="hljs-attribute">Connection</span>: keep-alive</code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">...</span></span></span></code></pre>

      </section><section class="slide" id="slide-10-8">
        <h2 id="http-beispiel-post-request">HTTP: Beispiel POST-Request</h2>
<p>Anfrage:</p>
<pre><code class="language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/submit-posting</span> HTTP/2.0
<span class="hljs-attribute">Host</span>: example.com
<span class="hljs-attribute">Connection</span>: keep-alive
<span class="hljs-attribute">Content-Type</span>: text/plain; encoding=UTF-8
<span class="hljs-attribute">Content-Length</span>: 33

<span class="ada">This <span class="hljs-keyword">is</span> the post content (<span class="hljs-keyword">body</span>)</span></code></pre>
<p>Antwort:</p>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: text/html; charset=UTF-8

<span class="clean">...</span></code></pre>

      </section><section class="slide" id="slide-10-9">
        <h2 id="http-beispiel-api">HTTP: Beispiel API</h2>
<pre><code class="language-http">GET /todos/12
Host: jsonplaceholder.typicode.com
Connection: keep-alive</code></pre>
<pre><code class="language-http">HTTP/2.0 <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span>: application/json; charset=utf-8
<span class="hljs-attribute">Etag</span>: W/"5c-cn8o...

<span class="json">{
  <span class="hljs-attr">"userId"</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">"id"</span>: <span class="hljs-number">12</span>,
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"ipsa repellendus fugit nisi"</span>,
  <span class="hljs-attr">"completed"</span>: <span class="hljs-literal">true</span>
}</span></code></pre>

      </section><section class="slide" id="slide-10-10">
        <h2 id="wichtige-anfrage-headerfelder">wichtige Anfrage-Headerfelder</h2>
<ul>
<li><em><code>Host</code></em></li>
<li><em><code>Connection</code></em></li>
<li><code>Origin</code></li>
<li><code>Accept</code></li>
<li><code>Accept-Encoding</code></li>
<li><code>Cookie</code></li>
<li><code>Cache-Control</code></li>
<li><code>Dnt</code></li>
</ul>

      </section><section class="slide" id="slide-10-11">
        <h2 id="wichtige-http-statuscodes">Wichtige HTTP-Statuscodes</h2>
<ul>
<li><code>200 OK</code></li>
</ul>
<!-- list separator -->

<ul>
<li><code>301 Moved Permanently</code></li>
<li><code>307 Temporary Redirect</code> (Weiterleitung auf eine andere Adresse)</li>
<li><code>303 See Other</code> (Weiterleitung auf eine andere Adresse, Methode ändert sich zu <code>GET</code>)</li>
<li><code>308 Permanent Redirect</code></li>
<li><code>304 Not Modified</code> (Resource hat sich seit letzter Anfrage nicht geändert)</li>
</ul>

      </section><section class="slide" id="slide-10-12">
        <h2 id="wichtige-http-statuscodes">Wichtige HTTP-Statuscodes</h2>
<ul>
<li><code>400 Bad Request</code></li>
<li><code>401 Unauthorized</code></li>
<li><code>403 Forbidden</code></li>
<li><code>404 Not Found</code></li>
</ul>
<!-- list separator -->

<ul>
<li><code>500 Internal Server Error</code></li>
</ul>
<p>siehe auch: <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">https://en.wikipedia.org/wiki/List_of_HTTP_status_codes</a></p>

      </section><section class="slide" id="slide-10-13">
        <h2 id="wichtige-antwort-headerfelder">wichtige Antwort-Headerfelder</h2>
<ul>
<li><code>Content-Length</code></li>
<li><code>Content-Type</code></li>
<li><code>Set-Cookie</code></li>
<li><code>Location</code></li>
<li><code>Cache-Control</code></li>
</ul>

      </section><section class="slide" id="slide-10-14">
        <h2 id="content-type-headerfeld">Content-Type-Headerfeld</h2>
<p>Mögliche Werte:</p>
<ul>
<li><code>text/plain; charset=utf-8</code></li>
<li><code>text/html; charset=utf-8</code></li>
<li><code>application/json</code></li>
<li><code>application/javascript</code></li>
<li><code>application/ecmascript</code></li>
<li><code>image/jpeg</code></li>
<li><code>image/png</code></li>
<li>...</li>
</ul>

      </section><section class="slide" id="slide-10-15">
        <h2 id="set-cookie-headerfeld">Set-Cookie-Headerfeld</h2>
<p>Beispiel:</p>
<pre><code class="language-http">GET /
Host: www.google.com

Set-Cookie: 1P_JAR=2019-04-24-08; expires=...; path=/; domain=.google.com
Set-Cookie: IDCC=AN0-TYtU7...fo; expires=...; path=/; domain=.google.com</code></pre>

      </section></section><section class="section" id="section-11"><section class="slide" id="slide-11-1">
        <h1 id="serverseitiges-http">Serverseitiges HTTP</h1>

      </section><section class="slide" id="slide-11-2">
        <h2 id="exkurs-lokalen-dateiserver-mit-python-betreiben">Exkurs: Lokalen Dateiserver mit Python betreiben</h2>
<pre><code class="language-bash">python -m http.server</code></pre>

      </section><section class="slide" id="slide-11-3">
        <h2 id="python-am-server---überblick">Python am Server - Überblick</h2>
<p><a href="https://docs.python.org/2/howto/webservers.html">https://docs.python.org/2/howto/webservers.html</a></p>
<p>(etwas veraltet)</p>

      </section><section class="slide" id="slide-11-4">
        <h2 id="cgi">CGI</h2>
<p>CGI = <em>Common Gateway Interface</em></p>
<p>Standard, um ein Programm am Server auf eine HTTP-Anfrage antworten zu lassen</p>
<p>Interface zwischen Serversoftware (z.B. Apache) und Webanwendung (geschrieben in beliebiger Programmiersprache)</p>
<p>Interface beruht auf <em>stdin</em>, <em>stdout</em> und Umgebungsvariablen</p>
<p>Nachteil: für jede Anfrage muss ein neuer Prozess gestartet werden (langsam)</p>

      </section><section class="slide" id="slide-11-5">
        <h2 id="wsgi">WSGI</h2>
<p>WSGI = Web Server Gateway Interface</p>
<p>Standard, um ein Python-Programm am Server auf HTTP-Anfragen antworten zu lassen</p>
<p>Inspiriert von CGI; wichtiger Vorteil: <em>ein</em> laufender Prozess kann der Reihe nach mehrere Anfragen beantworten</p>

      </section><section class="slide" id="slide-11-6">
        <h2 id="python-web-frameworks">Python Web-Frameworks</h2>
<ul>
<li>Werkzeug (Python WSGI Utility Library)</li>
<li>Flask (vollwertiges, modulares Framework basierend auf Werkzeug)</li>
<li>Django (vollwertiges Framework)</li>
</ul>

      </section><section class="slide" id="slide-11-7">
        <h2 id="wsgi-interface">WSGI-Interface</h2>
<p>Einstiegspunkt ist eine Python-Funktion</p>
<p>Die Funktion bekommt zwei Parameter übergeben: <code>environ</code> und <code>start_response</code></p>
<p>Die Anfrageparameter sind über <code>environ</code> abzufragen (z.B. URL, HTTP Header, Formulardaten, ...)</p>
<p>Der zweite Parameter ist eine Funktion, üblicherweise <code>start_response</code> genannt.</p>

      </section><section class="slide" id="slide-11-8">
        <h2 id="wsgi">WSGI</h2>
<p>Zum starten der Antwort rufen wir <code>start_response(status, response_headers)</code> auf, z.B.:</p>
<pre><code class="language-py">start_response(
    <span class="hljs-string">"200 OK"</span>,
    [(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain; charset=utf-8"</span>)]
)</code></pre>
<p>Der Antwortkörper wird als ein Iterable von Bytestrings zurückgegeben, z.B. als Liste von Bytestrings.</p>

      </section><section class="slide" id="slide-11-9">
        <h2 id="wsgi-server-software">WSGI-Server-Software</h2>
<p>server-software:</p>
<ul>
<li>gunicorn</li>
<li>uWSGI</li>
<li>mod_wsgi</li>
</ul>

      </section><section class="slide" id="slide-11-10">
        <h2 id="eigener-wsgi-server-in-python">Eigener WSGI-Server in Python</h2>
<pre><code class="language-py"><span class="hljs-keyword">from</span> wsgiref.simple_server <span class="hljs-keyword">import</span> make_server

<span class="hljs-keyword">from</span> app <span class="hljs-keyword">import</span> application

server = make_server(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">8000</span>, application)
server.serve_forever()</code></pre>
<p>Dieser Teil wird üblicherweise von Libraries wie gunicorn übernommen</p>

      </section><section class="slide" id="slide-11-11">
        <h2 id="eigene-wsgi-anwendung-in-python">Eigene WSGI-Anwendung in Python</h2>
<pre><code class="language-py"><span class="hljs-comment"># app.py</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">application</span><span class="hljs-params">(environ, start_response)</span>:</span>
    response_status = <span class="hljs-string">"200 OK"</span>
    response_body_text = <span class="hljs-string">"hello"</span>
    response_body = response_body_text.encode(<span class="hljs-string">"utf-8"</span>)
    response_headers = [
        (<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/plain; charset=utf-8"</span>),
        (<span class="hljs-string">"Content-Length"</span>, str(len(response_body))),
    ]
    start_response(response_status, response_headers)
    <span class="hljs-keyword">return</span> [response_body]</code></pre>

      </section><section class="slide" id="slide-11-12">
        <h2 id="das-environ-dictionary">Das environ-dictionary</h2>
<p>Wir können es im debugger begutachten, z.B.:</p>
<pre><code class="language-py">{
    <span class="hljs-string">"CONTENT_LENGTH"</span>: <span class="hljs-string">"12"</span>
    <span class="hljs-string">"HTTP_USER_AGENT"</span>: <span class="hljs-string">'Mozilla/5.0 (Win...'</span>,
    <span class="hljs-string">"HTTP_COOKIE"</span>:
    <span class="hljs-string">"PATH_INFO"</span>: <span class="hljs-string">"/todos/new"</span>,
    <span class="hljs-string">"REQUEST_METHOD"</span>: <span class="hljs-string">"GET"</span>,
    <span class="hljs-string">"wsgi.input"</span>: ...
}</code></pre>
<p><a href="https://www.python.org/dev/peps/pep-0333/#environ-variables">https://www.python.org/dev/peps/pep-0333/#environ-variables</a></p>

      </section><section class="slide" id="slide-11-13">
        <h2 id="path_info">PATH_INFO</h2>
<p>PATH_INFO im environ-dictionary: angefragter Pfad am Server</p>

      </section><section class="slide" id="slide-11-14">
        <h2 id="path_info">PATH_INFO</h2>
<p>Aufgabe: Anzeige verschiedener Seiten unter verschiedenen Adressen</p>

      </section><section class="slide" id="slide-11-15">
        <h2 id="redirects-mit-http">Redirects mit HTTP</h2>
<pre><code class="language-py">response_headers = [
    (<span class="hljs-string">"Location"</span>, <span class="hljs-string">"/login"</span>),
    (<span class="hljs-string">"Content-Length"</span>, <span class="hljs-string">"0"</span>)
]
start_response(<span class="hljs-string">"307 Temporary Redirect"</span>, response_headers)
<span class="hljs-keyword">return</span> [<span class="hljs-string">b''</span>]</code></pre>

      </section><section class="slide" id="slide-11-16">
        <h2 id="redirects-mit-http">Redirects mit HTTP</h2>
<p>Aufgabe: Weiterleitung einiger Seiten, z.B. <code>/now</code> leitet weiter auf <code>/time</code></p>

      </section><section class="slide" id="slide-11-17">
        <h2 id="cookies">Cookies</h2>
<p>Cookies = kleine Datenmengen, die von einer Website im Browser abgelegt werden können</p>
<p>Cookies dienen insbesondere dazu, einen früheren Besucher wiederzuerkennen, z.B. für:</p>
<ul>
<li>Eingeloggt bleiben auf Websites</li>
<li>Personenbezogene Werbung</li>
<li>Tracking der Useraktivitäten</li>
</ul>

      </section><section class="slide" id="slide-11-18">
        <h2 id="cookies-setzen">Cookies setzen</h2>
<pre><code class="language-py">response_headers.append((
    <span class="hljs-string">"Set-Cookie"</span>, <span class="hljs-string">"mycookie123=abcd; Max-Age=30"</span>
))</code></pre>

      </section><section class="slide" id="slide-11-19">
        <h2 id="cookies-lesen">Cookies lesen</h2>
<pre><code class="language-py"><span class="hljs-keyword">try</span>:
    current_cookies_str = environ[<span class="hljs-string">"HTTP_COOKIE"</span>]
<span class="hljs-keyword">except</span> KeyError:
    ...</code></pre>
<p>Resultat z.B.: <code>&quot;cookie1=one; cookie2=two&quot;</code></p>

      </section><section class="slide" id="slide-11-20">
        <h2 id="cookies-parsen">Cookies parsen</h2>
<pre><code class="language-py"><span class="hljs-keyword">from</span> http <span class="hljs-keyword">import</span> cookies

...

mycookies = cookies.SimpleCookie()
mycookies.load(current_cookies_str)
mycookies[<span class="hljs-string">"cookie1"</span>].value</code></pre>

      </section><section class="slide" id="slide-11-21">
        <h2 id="cookies-löschen">Cookies löschen</h2>
<p>indem ein neues Cookie gesetzt wird, dessen &quot;Ablaufsdatum&quot; in der Vergangenheit liegt:</p>
<pre><code class="language-py">response_headers.append((
    <span class="hljs-string">"Set-Cookie"</span>,
    <span class="hljs-string">"mycookie123=; expires=Thu, 01 Jan 1970 00:00:00 GMT"</span>
))</code></pre>

      </section><section class="slide" id="slide-11-22">
        <h2 id="cookies">Cookies</h2>
<p>Aufgabe: Website, die einen Benutzer nur 5x eine Seite aufrufen lässt und ihn dann auffordert, sich zu registrieren, um die Seite weiter zu verwenden</p>

      </section><section class="slide" id="slide-11-23">
        <h2 id="formular-und-post-request">Formular und post-request</h2>
<p>So lesen wir Parameter aus Formularen aus:</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> parse_qs

request_body_size = int(environ.get(<span class="hljs-string">'CONTENT_LENGTH'</span>, <span class="hljs-string">'0'</span>))
<span class="hljs-comment"># environ["wsgi.input"] is a file-like object</span>
request_body = (environ[<span class="hljs-string">"wsgi.input"</span>]
                .read(request_body_size)
                .decode(<span class="hljs-string">"utf-8"</span>))

parameters = parse_qs(request_body)
first_name = parameters.get(<span class="hljs-string">"first-name"</span>)[<span class="hljs-number">0</span>]</code></pre>

      </section><section class="slide" id="slide-11-24">
        <h2 id="wsgi-beispiele">wsgi-Beispiele</h2>
<ul>
<li>Online-Abstimmung</li>
<li>Gästebuch</li>
<li>Chat-System</li>
<li>Todo-Anwendung</li>
</ul>

      </section><section class="slide" id="slide-11-25">
        <h2 id="achtung-javascript-injection">Achtung: JavaScript-Injection</h2>

      </section><section class="slide" id="slide-11-26">
        <h2 id="deployment-auf-pythonanywherecom">Deployment auf pythonanywhere.com</h2>
<ul>
<li>neues Benutzerkonto auf <a href="https://pythonanywhere.com">https://pythonanywhere.com</a></li>
<li>add new web app</li>
<li>manual configuration</li>
</ul>

      </section><section class="slide" id="slide-11-27">
        <h2 id="deployment-auf-pythonanywherecom">Deployment auf pythonanywhere.com</h2>
<p>WSGI Konfigurationsdatei</p>
<pre><code class="language-py"><span class="hljs-comment"># /var/www/username_pythonanywhere_com_wsgi.py</span>
<span class="hljs-keyword">import</span> sys

path = <span class="hljs-string">"/home/username/"</span>
<span class="hljs-keyword">if</span> path <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> sys.path:
    sys.path.append(path)

<span class="hljs-keyword">from</span> app <span class="hljs-keyword">import</span> application</code></pre>

      </section></section><section class="section" id="section-12"><section class="slide" id="slide-12-1">
        <h1 id="datenbanken">Datenbanken</h1>
<p>Zu Grundlagen siehe Präsentation <em>Datenbanken und Datenspeicherung</em></p>

      </section></section><section class="section" id="section-13"><section class="slide" id="slide-13-1">
        <h1 id="zodb">ZODB</h1>

      </section><section class="slide" id="slide-13-2">
        <h2 id="zodb">ZODB</h2>
<p>Zope Object Database = Einfache Objektbank speziell für Python</p>

      </section><section class="slide" id="slide-13-3">
        <h2 id="zodb">ZODB</h2>
<p>Öffnen einer Datenbank:</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> ZODB <span class="hljs-keyword">import</span> DB, FileStorage
<span class="hljs-keyword">import</span> transaction

db = DB(FileStorage.FileStorage(<span class="hljs-string">"dbfile.fs"</span>))
connection = db.open()
root = connection.root()

print(root) <span class="hljs-comment"># {}</span></code></pre>

      </section><section class="slide" id="slide-13-4">
        <h2 id="zodb">ZODB</h2>
<p>Befüllen einer Datenbank:</p>
<pre><code class="language-py">root[<span class="hljs-string">"user"</span>] = {<span class="hljs-string">"first_name"</span>: <span class="hljs-string">"Jane"</span>, <span class="hljs-string">"last_name"</span>: <span class="hljs-string">"Doe"</span>}
root[<span class="hljs-string">"todos"</span>] = [<span class="hljs-string">"laundry"</span>, <span class="hljs-string">"shopping"</span>]
transaction.commit()</code></pre>

      </section><section class="slide" id="slide-13-5">
        <h2 id="zodb">ZODB</h2>
<p>Abändern von Einträgen:</p>
<p>Folgendes klappt nicht (ZODB bemerkt die Änderung der Elemente nicht):</p>
<pre><code class="language-py">root[<span class="hljs-string">"user"</span>][<span class="hljs-string">"first_name"</span>] = <span class="hljs-string">"John"</span>
root[<span class="hljs-string">"todos"</span>].append(<span class="hljs-string">"learn zodb"</span>)
transaction.commit()</code></pre>

      </section><section class="slide" id="slide-13-6">
        <h2 id="zodb">ZODB</h2>
<p>Möglichkeiten, um Änderungen an Elementen an ZODB signalisieren:</p>
<ul>
<li>Eintrag neu setzen (z.B.: <code>root[&quot;user&quot;] = root[&quot;user&quot;]</code>)</li>
<li>Verwendung der Typen <code>PersistentList</code>, <code>PersistentMapping</code> und <code>BTree</code> anstelle von Listen und Dictionaries</li>
<li>Verwendung persistenter Klassen (z.B.: <code>class User(Persistent):</code>)</li>
</ul>

      </section><section class="slide" id="slide-13-7">
        <h2 id="zodb">ZODB</h2>
<p>Eintrag neu setzen:</p>
<pre><code class="language-py">root[<span class="hljs-string">"user"</span>][<span class="hljs-string">"first_name"</span>] = <span class="hljs-string">"Jane"</span>
root[<span class="hljs-string">"todos"</span>] = root[<span class="hljs-string">"user"</span>]
transaction.commit()</code></pre>

      </section><section class="slide" id="slide-13-8">
        <h2 id="zodb">ZODB</h2>
<p>Verwendung der Typen <code>PersistentList</code>, <code>PersistentMapping</code> und <code>BTree</code> anstelle von Listen und Dictionaries:</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> persistent.list <span class="hljs-keyword">import</span> PersistentList
<span class="hljs-keyword">from</span> persistent.mapping <span class="hljs-keyword">import</span> PersistentMapping
<span class="hljs-keyword">from</span> BTrees <span class="hljs-keyword">import</span> IOBTree

root[<span class="hljs-string">"todos"</span>] = PersistentList([<span class="hljs-string">"laundry"</span>, <span class="hljs-string">"shopping"</span>])
root[<span class="hljs-string">"todos"</span>].append(<span class="hljs-string">"learn zodb"</span>)

root[<span class="hljs-string">"user"</span>] = PersistentMapping({<span class="hljs-string">"first_name"</span>: <span class="hljs-string">"Jane"</span>, <span class="hljs-string">"last_name"</span>: <span class="hljs-string">"Doe"</span>})
root[<span class="hljs-string">"user"</span>][<span class="hljs-string">"first_name"</span>] = <span class="hljs-string">"John"</span>
transaction.commit()</code></pre>

      </section><section class="slide" id="slide-13-9">
        <h2 id="zodb">ZODB</h2>
<p>Verwendung persistenter Klassen:</p>
<pre><code class="language-py"><span class="hljs-keyword">from</span> persistent <span class="hljs-keyword">import</span> Persistent

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span><span class="hljs-params">(Persistent)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, first_name, last_name)</span>:</span>
        self.first_name = first_name
        self.last_name = last_name</code></pre>

      </section></section><section class="section" id="section-14"><section class="slide" id="slide-14-1">
        <h1 id="sql-mit-python">SQL mit Python</h1>

      </section><section class="slide" id="slide-14-2">
        <h2 id="python-anbindung-von-sql-datenbanken">Python-Anbindung von SQL-Datenbanken</h2>
<p>Database API Specification: Standard, der von verschiedenen Python-Datenbankanbindungen umgesetzt wird; standardisiert in PEP 249</p>
<p>Anbindungen für:</p>
<ul>
<li>sqlite (Python-Paket <em>sqlite3</em>)</li>
<li>Postgresql (PIP-Paket <em>psycopg2</em>)</li>
<li>MySQL / mariadb (PIP-Paket <em>PyMySQL</em></li>
<li>Oracle (PIP-Paket <em>cx_oracle</em>)</li>
</ul>

      </section><section class="slide" id="slide-14-3">
        <h2 id="sqlite-und-python">SQLite und Python</h2>
<p>SQLite: Datenbank, die nur eine einzelne Datenbankdatei verwendet</p>
<p>Ist in Python integriert (Modul <code>sqlite3</code>)</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-comment"># database stored in a file</span>
connection = sqlite3.connect(<span class="hljs-string">'contacts.db'</span>)

<span class="hljs-comment"># in-memory database</span>
connection = sqlite3.connect(<span class="hljs-string">':memory:'</span>)</code></pre>

      </section><section class="slide" id="slide-14-4">
        <h2 id="mysql-und-python">MySQL und Python</h2>
<p>PIP-Paket <em>PyMySQL</em></p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pymysql.cursors

connection = pymysql.connect(host=<span class="hljs-string">'localhost'</span>,
                             user=<span class="hljs-string">'user'</span>,
                             password=<span class="hljs-string">'passwd'</span>,
                             db=<span class="hljs-string">'db'</span>,
                             charset=<span class="hljs-string">'utf8mb4'</span>)</code></pre>

      </section><section class="slide" id="slide-14-5">
        <h2 id="python-und-oracle-database">Python und Oracle Database</h2>
<p>Python-Paket <em>cx_Oracle</em></p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> cx_Oracle

connection = cx_Oracle.connect(user=<span class="hljs-string">"user"</span>,
                               password=<span class="hljs-string">"password"</span>,
                               dsn=<span class="hljs-string">"localhost/oraclepdb"</span>)</code></pre>

      </section><section class="slide" id="slide-14-6">
        <h2 id="pyodbc">pyodbc</h2>
<p>ODBC = open database connectivity: Standard zur Anbindung an Datenbanken (unabhängig von Python)</p>
<p>pyodbc = Implementierung für Python, damit können beliebige ODBC-Datenbanken angebunden werden</p>
<pre><code class="language-py"><span class="hljs-keyword">import</span> pyodbc

connection = pyodbc.connect(
  <span class="hljs-string">"Driver=SQLite3 ODBC Driver;Database=contacts.db"</span>)</code></pre>

      </section><section class="slide" id="slide-14-7">
        <h2 id="gemeinsames-interface-pep-249">Gemeinsames Interface (PEP 249)</h2>
<pre><code class="language-py">connection = ...
...
cursor = connection.cursor()
cursor.execute(<span class="hljs-string">"SELECT ..."</span>)
print(cursor.fetchall())
...
cursor = connection.cursor()
cursor.execute(<span class="hljs-string">"INSERT INTO ..."</span>)
cursor.execute(<span class="hljs-string">"INSERT INTO ..."</span>)
connection.commit()
...
connection.close()</code></pre>

      </section><section class="slide" id="slide-14-8">
        <h2 id="pep-249">PEP 249</h2>
<p><a href="https://www.python.org/dev/peps/pep-0249">https://www.python.org/dev/peps/pep-0249</a></p>

      </section><section class="slide" id="slide-14-9">
        <h2 id="sql-statements-mit-parametern">SQL Statements mit Parametern</h2>
<p>gefährlich:</p>
<pre><code class="language-py">search_name = input()
res = cursor.execute(
  <span class="hljs-string">f"""SELECT tel FROM person WHERE name = '<span class="hljs-subst">{search_name}</span>'"""</span>
)</code></pre>

      </section><section class="slide" id="slide-14-10">
        <h2 id="sql-statements-mit-parametern">SQL Statements mit Parametern</h2>
<p>sichere Methode (mit SQL-Escaping):</p>
<pre><code class="language-py">search_name = input()
res = cursor.execute(
  <span class="hljs-string">"""SELECT tel FROM person WHERE name = ?;"""</span>,
  (search_name, )
)</code></pre>

      </section><section class="slide" id="slide-14-11">
        <h2 id="sql-statements-mit-parametern">SQL Statements mit Parametern</h2>
<p><a href="https://www.python.org/dev/peps/pep-0249/#paramstyle">https://www.python.org/dev/peps/pep-0249/#paramstyle</a></p>
<p>Die Attribute <code>sqlite3.paramstyle</code>, <code>pymysql.paramstyle</code> etc. geben das Format für Abfragen mit Parametern an</p>
<ul>
<li>sqlite3: qmark</li>
<li>pymysql: pyformat</li>
<li>psycopg2: pyformat</li>
<li>cx_Oracle: named</li>
</ul>

      </section><section class="slide" id="slide-14-12">
        <h2 id="pep-249-das-cursor-objekt">PEP 249: das cursor Objekt</h2>
<ul>
<li><code>cursor.execute(command, parameters)</code></li>
<li><code>cursor.rowcount</code>: Anzahl der letzten Ergebnisse</li>
<li><code>cursor.fetchone()</code>: Eine Zeile des Resultats auslesen (üblicherweise als Tupel)</li>
<li><code>cursor.fetchmany(10)</code></li>
<li><code>cursor.fetchall()</code></li>
</ul>

      </section><section class="slide" id="slide-14-13">
        <h2 id="beispiel-forum-mit-datenbankanbindung">Beispiel: Forum mit Datenbankanbindung</h2>
<ul>
<li>Authentifizierung (MD5)</li>
<li>Admin-Skript</li>
</ul>

      </section><section class="slide" id="slide-14-14">
        <h2 id="beispiel-todo-anwendung">Beispiel: Todo-Anwendung</h2>

      </section><section class="slide" id="slide-14-15">
        <h2 id="beispiel-todo-anwendung">Beispiel: Todo-Anwendung</h2>
<ul>
<li>run_server.py und (minimale) app.py</li>
<li>init_db.py</li>
<li>db_interface.get_all_todos</li>
</ul>
<p>siehe courses-tutorials/python-todolist-wsgi-sqlite</p>

      </section></section><section class="section" id="section-15"><section class="slide" id="slide-15-1">
        <h1 id="sqlite-mit-python">SQLite mit Python</h1>

      </section><section class="slide" id="slide-15-2">
        <h2 id="erweiterte-typen-konvertieren">Erweiterte Typen konvertieren</h2>
<p>SQLite unterstützt nur eine eingeschränkte Anzahl an Typen. Es unterstützt nativ nicht Typen wie <code>DATE</code> oder <code>TIMESTAMP</code> - diese müssten als Strings gespeichert werden.</p>
<p>Wir können in Python automatisch die Konvertierung in / von Strings vornehmen lassen, indem wir den parameter <code>detect_types=sqlit3.PARSE_DECLTYPES</code> an <code>sqlite3.connect</code> übergeben.</p>

      </section><section class="slide" id="slide-15-3">
        <h2 id="erweiterte-typen-konvertieren">Erweiterte Typen konvertieren</h2>
<p>Übung: Erstelle eine Kontaktdatenbank die automatisch SQL Strings die das Geburtsdatum beschreiben als <code>date</code>-Objekte ausliest.</p>

      </section><section class="slide" id="slide-15-4">
        <h2 id="adapter-und-converter">Adapter und Converter</h2>
<p>Wir können weitere Typen speichern, indem wir sogenannte <em>Adapter</em>- und <em>Converer</em>- Funktionen schreiben. Diese zusätzlichen Typen werden üblicherweise als Bytesequenzen in der Datanbank abgelegt.</p>
<p>Ein <em>Adapter</em> ist eine Funktion, die ein Python Objekt in einen SQL Wert umwandelt.
Ein <em>Converter</em> ist eine Funktion, dien einen SQL Wert in ein Python Objekt umwandelt.</p>
<p>Siehe:</p>
<p><a href="https://docs.python.org/3/library/sqlite3.html#using-adapters-to-store-additional-python-types-in-sqlite-databases">https://docs.python.org/3/library/sqlite3.html#using-adapters-to-store-additional-python-types-in-sqlite-databases</a></p>

      </section><section class="slide" id="slide-15-5">
        <h2 id="adapter-und-converter">Adapter und Converter</h2>
<p>Übungen:</p>
<ul>
<li>Schreibe Adapter und Converter, um direkt Instanzen von Pythons <code>ipadress.IPv4Address</code> zu speichern bzw zu lesen - in SQL würden diese als kodierter Bytestring gespeichert werden</li>
</ul>

      </section></section><section class="section" id="section-16"><section class="slide" id="slide-16-1">
        <h1 id="sqlalchemy">SQLAlchemy</h1>
<!--
requirements: classes
-->


      </section><section class="slide" id="slide-16-2">
        <h2 id="sqlalchemy">SQLAlchemy</h2>
<p>SQLAlchemy = Object Relational Mapper</p>
<p>Objektorientierter Zugriff auf beliebige SQL-Datenbanken</p>
<p>Alternative: Django ORM</p>

      </section><section class="slide" id="slide-16-3">
        <h2 id="sqlalchemy">SQLAlchemy</h2>
<p>Pip-Paket <em>sqlalchemy</em></p>

      </section><section class="slide" id="slide-16-4">
        <h2 id="verbinden-mit-sqlite-datenbank">Verbinden mit SQLite-Datenbank</h2>
<pre><code class="language-py"><span class="hljs-comment"># db_interface.py</span>
<span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> create_engine

engine = create_engine(<span class="hljs-string">"sqlite:///music.db"</span>, echo=<span class="hljs-keyword">True</span>)

engine.connect()</code></pre>

      </section><section class="slide" id="slide-16-5">
        <h2 id="tabellen-definieren">Tabellen definieren</h2>
<pre><code class="language-py"><span class="hljs-comment"># schema.py</span>
<span class="hljs-keyword">from</span> sqlalchemy.ext.declarative <span class="hljs-keyword">import</span> declarative_base
<span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, Integer, String

Base = declarative_base()

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Artist</span><span class="hljs-params">(Base)</span>:</span>
    __tablename__ = <span class="hljs-string">"artist"</span>
    id = Column(Integer, primary_key=<span class="hljs-keyword">True</span>)
    name = Column(String(<span class="hljs-number">30</span>))
    country = Column(String(<span class="hljs-number">20</span>))</code></pre>
<pre><code class="language-py"><span class="hljs-comment"># db_interface.py</span>
Base.metadata.create_all(engine)</code></pre>

      </section><section class="slide" id="slide-16-6">
        <h2 id="mit-sessions-arbeiten">Mit Sessions arbeiten</h2>
<pre><code class="language-py"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker

Session = sessionmaker(bind=engine)

session = Session()

...

session.commit()</code></pre>

      </section><section class="slide" id="slide-16-7">
        <h2 id="insert">Insert</h2>
<pre><code class="language-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> artist <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'The Beatles'</span>, <span class="hljs-string">'United Kingdom'</span>);</code></pre>
<p>wird zu:</p>
<pre><code class="language-py">beatles = Artist(name=<span class="hljs-string">"The Beatles"</span>, country=<span class="hljs-string">"United Kingdom"</span>)
session.add(beatles)</code></pre>

      </section><section class="slide" id="slide-16-8">
        <h2 id="select">Select</h2>
<pre><code class="language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, country <span class="hljs-keyword">FROM</span> artist;</code></pre>
<p>wird zu:</p>
<pre><code class="language-py"><span class="hljs-keyword">for</span> artist <span class="hljs-keyword">in</span> session.query(Artist):
    print(<span class="hljs-string">f"<span class="hljs-subst">{artist.name}</span> (<span class="hljs-subst">{artist.country}</span>)"</span>)</code></pre>
<p>oder</p>
<pre><code class="language-py"><span class="hljs-keyword">for</span> name, country <span class="hljs-keyword">in</span> session.query(Artist.name, Artist.country):
    print(<span class="hljs-string">f"<span class="hljs-subst">{name}</span> (<span class="hljs-subst">{country}</span>)"</span>)</code></pre>

      </section><section class="slide" id="slide-16-9">
        <h2 id="order-by">Order by</h2>
<pre><code class="language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, country <span class="hljs-keyword">FROM</span> artist <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">name</span>;</code></pre>
<p>wird zu:</p>
<pre><code class="language-py"><span class="hljs-keyword">for</span> name, country <span class="hljs-keyword">in</span> session.query(
        Artist.name, Artist.country).order_by(Artist.name):
    ...</code></pre>

      </section><section class="slide" id="slide-16-10">
        <h2 id="where">Where</h2>
<pre><code class="language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, country <span class="hljs-keyword">FROM</span> artist <span class="hljs-keyword">WHERE</span> artist.name=<span class="hljs-string">'The Beatles'</span></code></pre>
<p>wird zu:</p>
<pre><code class="language-py">session.query(Artist).filter(Artist.name==<span class="hljs-string">"The Beatles"</span>).one()</code></pre>

      </section><section class="slide" id="slide-16-11">
        <h2 id="sprechende-ausgabe-von-einträgen">Sprechende Ausgabe von Einträgen</h2>
<p>aktuell:</p>
<pre><code class="language-txt">&amp;ltdb_schema.Song object at 0x00000175902A5FD0&gt;</code></pre>
<p>besser:</p>
<pre><code class="language-txt">Help! - The Beatles</code></pre>
<p>umsetzbar mittels <code>__repr__</code> / <code>__str__</code></p>

      </section><section class="slide" id="slide-16-12">
        <h2 id="update">Update</h2>
<pre><code class="language-sql"><span class="hljs-keyword">UPDATE</span> song
<span class="hljs-keyword">SET</span> title = <span class="hljs-string">'Help'</span>
<span class="hljs-keyword">WHERE</span> title = <span class="hljs-string">'Help!'</span>;</code></pre>
<p>wird zu</p>
<pre><code class="language-py">entry = session.query(Song).filter(Song.title==<span class="hljs-string">"Help!"</span>).one()
entry.title = <span class="hljs-string">"Help"</span></code></pre>

      </section><section class="slide" id="slide-16-13">
        <h2 id="delete">Delete</h2>
<pre><code class="language-sql"><span class="hljs-keyword">DELETE</span>
<span class="hljs-keyword">FROM</span> song
<span class="hljs-keyword">WHERE</span> title = <span class="hljs-string">'Help!'</span>;</code></pre>
<p>wird zu</p>
<pre><code class="language-py">session.query(Song).filter(Song.title==<span class="hljs-string">"Help!"</span>).delete()</code></pre>

      </section><section class="slide" id="slide-16-14">
        <h2 id="definition-eines-fremdschlüssels">Definition eines Fremdschlüssels</h2>
<pre><code class="language-py"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Song</span><span class="hljs-params">(Base)</span>:</span>
    __tablename__ = <span class="hljs-string">"song"</span>
    id = Column(Integer, primary_key=<span class="hljs-keyword">True</span>)
    title = Column(String(<span class="hljs-number">30</span>))
    artist_id = Column(Integer, ForeignKey(<span class="hljs-string">"artist.id"</span>))</code></pre>

      </section><section class="slide" id="slide-16-15">
        <h2 id="einfaches-abfragen-einer-verknüpften-tabelle">Einfaches Abfragen einer verknüpften Tabelle</h2>
<pre><code class="language-py"><span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> relationship

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Artist</span><span class="hljs-params">(Base)</span>:</span>
    ...
    songs = relationship(<span class="hljs-string">"Song"</span>)

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Song</span><span class="hljs-params">(Base)</span>:</span>
    ...
    artist_id = Column(Integer, ForeignKey(<span class="hljs-string">"artist.id"</span>))

    artist = relationship(<span class="hljs-string">"Artist"</span>)</code></pre>

      </section><section class="slide" id="slide-16-16">
        <h2 id="einfaches-abfragen-einer-verknüpften-tabelle">Einfaches Abfragen einer verknüpften Tabelle</h2>
<pre><code class="language-py">yesterday = Song(title=<span class="hljs-string">"Yesterday"</span>, artist=beatles)
help = Song(title=<span class="hljs-string">"Help!"</span>, artist_id=beatles.id)
session.add(...)

print(yesterday.artist)
print(beatles.songs)</code></pre>

      </section></section><section class="section" id="section-17"><section class="slide" id="slide-17-1">
        <h1 id="gui">GUI</h1>

      </section><section class="slide" id="slide-17-2">
        <h2 id="graphical-user-interface">Graphical User Interface</h2>

      </section><section class="slide" id="slide-17-3">
        <h2 id="gui-libraries-für-python">GUI-Libraries für Python</h2>
<ul>
<li>tk</li>
<li>Qt</li>
<li>Kivy</li>
</ul>

      </section><section class="slide" id="slide-17-4">
        <h2 id="tk">tk</h2>
<ul>
<li>Einfache UI-Library</li>
<li>Anbindung an Python: tkinter</li>
<li>unter Windows mit Python vorinstalliert</li>
</ul>

      </section><section class="slide" id="slide-17-5">
        <h2 id="qt">Qt</h2>
<ul>
<li>Weit verbreitete UI-Library</li>
<li>Anbindungen an Python: PyQt oder PySide</li>
</ul>

      </section><section class="slide" id="slide-17-6">
        <h2 id="kivy">Kivy</h2>
<ul>
<li>speziell für Python entwickelt</li>
</ul>

      </section></section><section class="section" id="section-18"><section class="slide" id="slide-18-1">
        <h1 id="tkinter">Tkinter</h1>

      </section><section class="slide" id="slide-18-2">
        <h2 id="tkinter">Tkinter</h2>
<p><a href="https://tkdocs.com/">https://tkdocs.com/</a></p>

      </section><section class="slide" id="slide-18-3">
        <h2 id="tkinter---ein-fenster-anzeigen">Tkinter - Ein Fenster anzeigen</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> tkinter

window = tkinter.Tk()

window.mainloop()</code></pre>
<p>Ein Fenster wird als <code>Tk</code>-Objekt erstellt</p>
<p>Mit <code>mainloop()</code> starten wir das Programm (und warten auf Benutzerinteraktion)</p>

      </section><section class="slide" id="slide-18-4">
        <h2 id="tkinter---text-anzeigen">Tkinter - Text anzeigen</h2>
<pre><code class="language-py"><span class="hljs-keyword">import</span> tkinter

window = tkinter.Tk()

hello_label = tkinter.Label(master=window, text=<span class="hljs-string">"Hello!"</span>)
hello_label.pack()

window.mainloop()</code></pre>

      </section><section class="slide" id="slide-18-5">
        <h2 id="tkinter---pack-und-grid">Tkinter - pack und grid</h2>
<p>Mit <code>pack</code>: Einfache Zeilen- oder Spaltenlayouts</p>
<pre><code class="language-py">hello_label.pack()</code></pre>
<p>Mit <code>grid</code>: Komplexere Ausrichtungen an einem Raster sind möglich</p>
<pre><code class="language-py">hello_label.grid(column=<span class="hljs-number">0</span>, row=<span class="hljs-number">0</span>)</code></pre>

      </section><section class="slide" id="slide-18-6">
        <h2 id="tkinter---elemente-nachträglich-ändern">Tkinter - Elemente nachträglich ändern</h2>
<pre><code class="language-py">hello_label = tkinter.Label(master=window, text=<span class="hljs-string">"Hello!"</span>)
hello_label.config(text=<span class="hljs-string">"Hi!"</span>)</code></pre>

      </section><section class="slide" id="slide-18-7">
        <h2 id="tkinter---benutzerinteraktion">Tkinter - Benutzerinteraktion</h2>
<pre><code class="language-py">...

message_label = tkinter.Label(master=window, text=<span class="hljs-string">""</span>)
message_label.pack()

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">display_message</span><span class="hljs-params">()</span>:</span>
    message_label.config(text=<span class="hljs-string">"Hello!"</span>)

hello_button = tkinter.Button(master=window,
                              text=<span class="hljs-string">"Say Hello!"</span>,
                              command=display_message)
hello_button.pack()

...</code></pre>

      </section><section class="slide" id="slide-18-8">
        <h2 id="beispiel-counter">Beispiel: Counter</h2>
<p>Button, der bei 0 startet und die Klickanzahl mitzählt und anzeigt</p>

      </section><section class="slide" id="slide-18-9">
        <h2 id="tkinter---widget-konfiguration">Tkinter - Widget-Konfiguration</h2>
<p>Möglichkeiten:</p>
<ul>
<li><code>height</code> (in Pixeln oder relativ zur Schriftgröße)</li>
<li><code>width</code></li>
<li><code>borderwidth</code></li>
<li><code>background</code> (Hintergrundfarbe)</li>
<li><code>foreground</code> (Textfarbe)</li>
<li><code>justify</code> (Textausrichtung, Werte: <code>tkinter.CENTER</code>, <code>tkinter.LEFT</code>, <code>tkinter.RIGHT</code>)</li>
<li><code>padx</code>, <code>pady</code> (Abstand Rahmen zu Inhalt)</li>
</ul>

      </section><section class="slide" id="slide-18-10">
        <h2 id="tkinter---widgets">Tkinter - Widgets</h2>
<ul>
<li><code>Label</code></li>
<li><code>Button</code></li>
<li><code>Frame</code></li>
<li><code>Entry</code></li>
</ul>

      </section><section class="slide" id="slide-18-11">
        <h2 id="tkinter---beispiele">Tkinter - Beispiele</h2>
<ul>
<li>zufälliger Sehtest (Snellen Chart)</li>
<li>Tic-Tac-Toe</li>
</ul>

      </section></section><section class="section" id="section-19"><section class="slide" id="slide-19-1">
        <h1 id="pyinstaller">PyInstaller</h1>

      </section><section class="slide" id="slide-19-2">
        <h2 id="pyinstaller">PyInstaller</h2>
<p>Ermöglicht das erstellen von <em>.exe</em>-Dateien aus Python-Projekten</p>
<p>Insbesondere für GUI-Anwendungen sinnvoll</p>

      </section><section class="slide" id="slide-19-3">
        <h2 id="pyinstaller---verwendung">PyInstaller - Verwendung</h2>
<p>Installation:</p>
<pre><code class="language-bash">pip install pyinstaller</code></pre>

      </section><section class="slide" id="slide-19-4">
        <h2 id="pyinstaller---verwendung">PyInstaller - Verwendung</h2>
<p>Erstellen einer ausführbaren Anwendung:</p>
<pre><code class="language-bash">pyinstaller app.pyw --onefile --windowed</code></pre>
<p>Resultat: Datei <em>dist/app.exe</em></p>

      </section></section><section class="section" id="section-20"><section class="slide" id="slide-20-1">
        <h1 id="smtp--imap">SMTP / IMAP</h1>

      </section><section class="slide" id="slide-20-2">
        <h2 id="smtp--imap">SMTP / IMAP</h2>
<p><a href="https://automatetheboringstuff.com/chapter16/">https://automatetheboringstuff.com/chapter16/</a></p>
<p>(für Fehler und Korrekturen siehe nächste Folie)</p>
<p>zur verdeckten Passworteingabe: Modul &quot;getpass&quot;</p>

      </section><section class="slide" id="slide-20-3">
        <h2 id="smtp--imap">SMTP / IMAP</h2>
<p>Fehler in der resouce:</p>
<p>Die query besteht aus zwei Einträgen:</p>
<p><del><code>UIDs = imapObj.search([&#39;SINCE 05-Jul-2014&#39;])</code></del></p>
<p><code>UIDs = imapObj.search([&#39;SINCE&#39;, &#39;05-Jul-2014&#39;])</code></p>
<p>Neuere Version von <em>pyzmail</em> verwenden:</p>
<p><del><code>pyzmail</code></del> → <code>pyzmail36</code></p>
<p><em>bytes</em> statt <em>string</em> verwenden:</p>
<p><del><code>&#39;BODY[]&#39;</code></del> → <code>b&#39;BODY[]</code></p>

      </section></section>

    </div>
    <div id="navigation-arrows">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="navigation-arrows-svg"
        xml:space="preserve" width="100%" height="100%" viewBox="-110 -110 220 220">
        <path class="arrow right" d="M70,-30L100,0L70,30" />
        <path class="arrow down" d="M-30,70L0,100L30,70" />
        <path class="arrow left" d="M-70,-30L-100,0L-70,30" />
        <path class="arrow up" d="M-30,-70L0,-100L30,-70" />
      </svg>
    </div>
  </div>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      width: 100vw;
      height: 100vh;
      margin: 0px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgb(150, 150, 150);
      font-family: -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
      line-height: 1.5rem;
    }

    p, ul, pre {
      margin-top: 0;
    }

    ul {
      padding-left: 1.5rem;
    }

    h1, h2, h3 {
      margin-top: 0px;
      font-weight: 600;
    }

    h1 {
      margin-top: 5vh;
      text-align: center;
      font-size: 2rem;
    }

    h2 {
      margin-bottom: 1.5em;
    }

    svg {
      width: 100%;
      height: auto;
    }

    .section {
      height: 100%;
      display: none;
    }

    .section.active {
      display: block;
    }

    .slide {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .slide.inactive {
      display: none;
    }

    #canvas {
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.3);
      background-color: #f8f8f8;
      position: relative;
      display: flex;
    }

    #canvas-content {
      width: 100%;
      height: 100%;
    }

    #canvas-content .note {
      display: none;
    }

    #canvas-content img {
      margin: 0px auto;
      display: block;
    }

    @media (min-aspect-ratio: 8/5) {

      html {
        font-size: 3.5vh;
      }

      /* wide screen */
      #canvas {
        width: calc(100vh / 5 * 8);
        height: 100vh;
        padding: 10vh;
        padding-top: 5vh;
      }
    }

    @media (max-aspect-ratio: 8/5) {

      html {
        font-size: calc(3.5vw * 5 / 8);
      }

      /* narrow screen */
      #canvas {
        width: 100vw;
        height: calc(100vw * 5 / 8);
        padding: calc(10vh * 5 / 8);
        padding-top: calc(5vh * 5 / 8);
      }
    }

    pre {
      background-color: rgb(224, 233, 240);
      box-shadow: 0 0.5vh 1vh rgba(0, 0, 0, 0.2);
      padding: 0.5em 1em;
      line-height: 1.2em;
      overflow: auto;
    }

    #navigation-arrows {
      position: absolute;
      right: 2rem;
      top: 2rem;
      height: 3rem;
      width: 3rem;
    }

    #navigation-arrows .arrow {
      stroke: lightblue;
      /*stroke-width: 0.8em; Chrome behaves differently with ems here */
      stroke-width: 16px;
      stroke-linecap: round;
      fill: none;
      cursor: pointer;
    }

    td,
    th {
      padding: 0.2em 0.8em;
    }

    th {
      text-align: start;
    }
  </style>
  <script>
    let presenterWindow;
    let activeSlide;
    let slideCount;

    const arrowUp = document.querySelector('.arrow.up');
    const arrowDown = document.querySelector('.arrow.down');
    const arrowRight = document.querySelector('.arrow.right');
    const arrowLeft = document.querySelector('.arrow.left');
    arrowUp.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] - 1);}
    );
    arrowDown.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0], activeSlide[1] + 1);}
    );
    arrowLeft.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] - 1, 1);}
    );
    arrowRight.addEventListener('click',
      () => {activateSlideSafe(activeSlide[0] + 1, 1);}
    )
    const init = () => {
      slideCount = countSlides();
      activateSlideSafe(1, 1);
      addKeyControls();
      addSwipeControls();
      hideNoScriptMessage();
    }

    // count slides
    const countSlides = () => {
      const counts = [];
      return [...document.querySelectorAll('.section')].map(section => section.childNodes.length);
    }

    const updateVisible = () => {
      for (let section of document.querySelectorAll('.section')) {
        if (section.id === `section-${activeSlide[0]}`) {
          section.className = 'section active';
        } else {
          section.className = 'section inactive';
        }
      }
      for (let slide of document.querySelectorAll('.slide')) {
        if (slide.id === `slide-${activeSlide[0]}-${activeSlide[1]}`) {
          slide.className = 'slide active';
        } else {
          slide.className = 'slide inactive';
        }
      }
    }

    const updatePageArrows = () => {
      if (slideCount.length === 1) {
        arrowLeft.style.opacity = "0";
        arrowRight.style.opacity = "0";
      } else {
        const progressSections = (activeSlide[0] - 1) / (slideCount.length - 1);
        arrowLeft.style.opacity = progressSections.toString();
        arrowRight.style.opacity = (1 - progressSections).toString();
      }
      const slidesInActiveSection = slideCount[activeSlide[0] - 1]
      if (slidesInActiveSection === 1) {
        arrowUp.style.opacity = "0";
        arrowDown.style.opacity = "0";
      } else {
        const progressSlides = (activeSlide[1] - 1) / (slidesInActiveSection - 1);
        arrowUp.style.opacity = progressSlides.toString();
        arrowDown.style.opacity = (1 - progressSlides).toString();
      }
    }

    /**
     * Activate a slide if it exists, else do nothing
    */
    const activateSlideSafe = (sectionIndex, slideIndex) => {
      if (1 <= sectionIndex && sectionIndex <= slideCount.length && 1 <= slideIndex && slideIndex <= slideCount[sectionIndex - 1]) {
        activeSlide = [sectionIndex, slideIndex];
        updateVisible();
        updatePageArrows();
        scrolltoActiveSlide();
      }
    }

    const activateSlideNextSafe = () => {
      if (activeSlide[1] === slideCount[activeSlide[0] - 1]) {
        activateSlideSafe(activeSlide[0] + 1, 1);
      } else {
        activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
      }
    }

    const activateSlideRightSafe = () => {
      activateSlideSafe(activeSlide[0] + 1, 1);
    }

    const activateSlideLeftSafe = () => {
      activateSlideSafe(activeSlide[0] - 1, 1);
    }

    const activateSlideDownSafe = () => {
      activateSlideSafe(activeSlide[0], activeSlide[1] + 1);
    }

    const activateSlideUpSafe = () => {
      activateSlideSafe(activeSlide[0], activeSlide[1] - 1);
    }

    const scrolltoActiveSlide = () => {
      const slideId = `#slide-${activeSlide[0]}-${activeSlide[1]}`;
      if (presenterWindow) {
        const activeSlide = presenterWindow.document.querySelector(slideId);
        if (activeSlide) {
          activeSlide.scrollIntoView();
        }
      }
    }

    const addKeyControls = () => {
      document.querySelector('body').addEventListener('keydown', event => {
        if (event.key === 'p') {
          const canvasContent = document.querySelector('#canvas-content').innerHTML;
          presenterWindow = window.open(document.URL, '_blank');
          presenterWindow.onload = () => {
            presenterWindow.document.querySelector('body').innerHTML = canvasContent;
          }
        }
        if (event.key === 'ArrowRight') {
          activateSlideRightSafe();
        } else if (event.key === 'ArrowLeft') {
          activateSlideLeftSafe();
        } else if (event.key === 'ArrowDown') {
          activateSlideDownSafe();
        } else if (event.key === 'ArrowUp') {
          activateSlideUpSafe();
        } else if (event.key === 'Enter') {
          activateSlideNextSafe();
        }
      });
    }

    const addSwipeControls = () => {

      const distance = 100;

      let startPos;
      let handled;

      document.addEventListener('touchstart', event => {
        startPos = event.touches[0];
        handled = false;
      });

      document.addEventListener('touchmove', event => {
        if (!handled) {
          let currentPos = event.touches[0];
          const xDiff = currentPos.clientX - startPos.clientX;
          const yDiff = currentPos.clientY - startPos.clientY;
          if (Math.abs(xDiff) > 2*Math.abs(yDiff) ||
              Math.abs(yDiff) > 2*Math.abs(xDiff)) {
            if (xDiff > distance) {
              activateSlideLeftSafe();
              handled = true;
            } else if (xDiff < -distance) {
              activateSlideRightSafe();
              handled = true;
            } else if (yDiff > distance) {
              activateSlideUpSafe();
              handled = true;
            } else if (yDiff < -distance) {
              activateSlideDownSafe();
              handled = true;
            }
          }
        }
      });
    }

    const hideNoScriptMessage = () => {
      document.querySelector("#no-script").innerHTML = "";
    }

    init();

  </script>
</body>

</html>